(window.webpackJsonp=window.webpackJsonp||[]).push([["form"],{"0203":function(t,n,e){"use strict";e.r(n);var r=e("cebc"),o=e("75fc"),i=(e("7f7f"),e("28a5"),e("c5f6"),e("b775")),u={name:"UploadWall",data:function(){return{dialogImageUrl:"",dialogVisible:!1,base64Src:"",loading:!1}},props:{limitCount:{type:Number,default:2},fileList:{type:Array}},methods:{handleRemove:function(t,n){this.$emit("update:fileList",n)},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleexceed:function(){this.$message({message:"最多可以上传".concat(this.limitCount,"张图片"),type:"error",duration:5e3})},handleBefore:function(t){var n=this;return new Promise(function(e,r){var o=n;if(o.loading)r({err:"uploading"});else{var i=t.name.toLowerCase().split(".").splice(-1)[0];if("bmp"!==i&&"jpg"!==i&&"png"!==i&&"jpeg"!==i&&"gif"!==i&&"webp"!==i)return n.$message({showClose:!0,message:"只能上传bmp/png/jpg/jped/gif/webp文件",duration:2e3,type:"warning"}),void r(t);o.compressPic(t,t.size).then(function(t){o.base64Src=t,e(t)},function(t){n.$message({showClose:!0,message:"不能上传大小超过5M的图片",duration:2500,type:"warning"}),r(t)})}})},uploadPic:function(t){var n,e=this;this.loading=!0,Object(i.a)({url:"/system/upload",method:"post",data:n}).then(function(t){e.$emit("update:fileList",[].concat(Object(o.a)(e.fileList),[{name:t.url,url:t.url}]))}).finally(function(){e.loading=!1})},compressPic:function(t,n){return new Promise(function(e,r){n>5242880&&r(t);var o=new FileReader;o.readAsDataURL(t),o.onload=function(t){e(t.target.result)}})}}},a=(e("76f7"),e("2877")),c=Object(a.a)(u,function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"upload"},[e("el-upload",{class:t.fileList.length===t.limitCount?"upload-exceed":"",attrs:{action:"","file-list":t.fileList,"list-type":"picture-card","on-preview":t.handlePictureCardPreview,"before-upload":t.handleBefore,"on-exceed":t.handleexceed,"on-remove":t.handleRemove,"auto-upload":!0,"http-request":t.uploadPic,multiple:!0,limit:t.limitCount}},[e("i",{staticClass:"el-icon-plus"})]),e("el-dialog",{attrs:{visible:t.dialogVisible,"append-to-body":"",title:"图片明细",top:"5vh","custom-class":"custom-upload"},on:{"update:visible":function(n){t.dialogVisible=n}}},[e("img",{staticClass:"upload-dialog-pic",attrs:{src:t.dialogImageUrl,alt:""}})])],1)},[],!1,null,"32324d9e",null).exports,s=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],l=function(t){return-1!==s.indexOf(t)},f=function(t,n,e){var r=n.$props.value?n.$props.value:"",o=n.$props.initialValue?n.$props.initialValue:"";e.setContent(r||o),n.$listeners.input&&function(t,n){var e,r=t.$props.modelEvents?t.$props.modelEvents:null,o=Array.isArray(r)?r.join(" "):r;t.$watch("value",function(t,r){n&&"string"==typeof t&&t!==e&&t!==r&&(n.setContent(t),e=t)}),n.on(o||"change keyup undo redo",function(){e=n.getContent(),t.$emit("input",e)})}(n,e),function(t,n,e){Object.keys(n).filter(l).forEach(function(r){var o=n[r];"function"==typeof o&&("onInit"===r?o(t,e):e.on(r.substring(2),function(t){return o(t,e)}))})}(t,n.$listeners,e)},d=0,m=function(t){var n=Date.now();return t+"_"+Math.floor(1e9*Math.random())+ ++d+String(n)},g=function(t){return void 0===t||""===t?[]:Array.isArray(t)?t:t.split(" ")},p=e("1f38"),h={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean},v=function(){return(v=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},b={listeners:[],scriptId:m("tiny-script"),scriptLoaded:!1},y=function(t){return function(){var n,e,r,o=v({},t.$props.init,{readonly:t.$props.disabled,selector:"#"+t.elementId,plugins:(n=t.$props.init&&t.$props.init.plugins,e=t.$props.plugins,g(n).concat(g(e))),toolbar:t.$props.toolbar||t.$props.init&&t.$props.init.toolbar,inline:t.inlineEditor,setup:function(n){t.editor=n,n.on("init",function(e){return f(e,t,n)}),t.$props.init&&"function"==typeof t.$props.init.setup&&t.$props.init.setup(n)}});null!==(r=t.element)&&"textarea"===r.tagName.toLowerCase()&&(t.element.style.visibility=""),Object(p.a)().init(o)}},w={props:h,created:function(){this.elementId=this.$props.id||m("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(p.a)())y(this)();else if(this.element&&this.element.ownerDocument){var t=this.element.ownerDocument,n=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key";!function(t,n,e,r){t.scriptLoaded?r():(t.listeners.push(r),n.getElementById(t.scriptId)||function(t,n,e,r){var o=n.createElement("script");o.type="application/javascript",o.id=t,o.addEventListener("load",r),o.src=e,n.head&&n.head.appendChild(o)}(t.scriptId,n,e,function(){t.listeners.forEach(function(t){return t()}),t.scriptLoaded=!0}))}(b,t,"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+n+"/tinymce.min.js",y(this))}},beforeDestroy:function(){null!==Object(p.a)()&&Object(p.a)().remove(this.editor)},render:function(t){return this.inlineEditor?function(t,n,e){return t(e||"div",{attrs:{id:n}})}(t,this.elementId,this.$props.tagName):function(t,n){return t("textarea",{attrs:{id:n},style:{visibility:"hidden"}})}(t,this.elementId)}},x=e("d7d7"),S=e.n(x),C=(e("0d68"),e("4ea8"),e("4237"),e("64d8"),e("07d1"),e("84ec"),e("f557"),e("9434"),e("2d33"),e("34de"),{name:"RichTxt",data:function(){return{tinymceFlag:1,editorInit:{encoding:"XML",language_url:e("836f"),language:"zh_CN",skin_url:"./tinymce/skins/ui/oxide",height:300,browser_spellcheck:!0,plugins:"link lists image code table colorpicker textcolor contextmenu wordcount",toolbar:"bold italic underline strikethrough | fontselect | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist | outdent indent blockquote | undo redo | link unlink image code | removeformat",branding:!1,font_formats:"微软雅黑='微软雅黑';宋体='宋体';黑体='黑体';仿宋='仿宋';楷体='楷体';隶书='隶书';幼圆='幼圆';Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings",images_upload_handler:function(t,n,e){n("data:image/jpeg;base64,"+t.base64())}},fileList:[],showUploadDialog:!1,base64Src:"",editor:{},headers:{authorization:"authorization-text"}}},props:{tinymceHtml:{type:String,default:""}},computed:{richTxt:{get:function(){return this.tinymceHtml},set:function(t){return this.$emit("update:tinymceHtml",t)}}},watch:{richTxt:function(t){this.$emit("update:tinymceHtml",t)},tinymceHtml:function(t){t!==this.richTxt&&(this.richTxt=t)}},components:{Editor:w},mounted:function(){S.a.init({})},activated:function(){this.tinymceFlag++}}),O=(e("1733"),Object(a.a)(C,function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"rich-text"},[e("Editor",{key:t.tinymceFlag,attrs:{init:t.editorInit},model:{value:t.richTxt,callback:function(n){t.richTxt=n},expression:"richTxt"}})],1)},[],!1,null,null,null).exports),k=e("5880"),T={name:"FormSimple",data:function(){return{form:{user:"",region:"",fileList:[],richTxt:""},rules:{user:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:3,max:5,message:"长度在 3 到 5 个字符",trigger:"blur"}],region:[{required:!0,message:"请选择活动区域",trigger:"change"}],fileList:[{type:"array",required:!0,message:"请至少选择上传一张图片",trigger:"change"}],richTxt:[{required:!0,message:"请输入富文本",trigger:"change"}]},uploadShow:!0}},components:{Tinymce:O,UploadWall:c},methods:Object(r.a)({},Object(k.mapActions)(["CloseVisitedRoutes"]),{submit:function(){this.$refs.form.validate(function(t){if(!t)return!1;alert("submit!")})}}),beforeDestroy:function(){this.CloseVisitedRoutes({name:"FormSimple"})}},E=(e("ba2e"),Object(a.a)(T,function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("el-form",{ref:"form",attrs:{inline:!0,model:t.form,rules:t.rules}},[e("div",{staticClass:"detail-wrap"},[e("h3",{staticClass:"detail-wrap-title"},[t._v("选择产品信息")]),e("el-form-item",{attrs:{label:"审批人",prop:"user"}},[e("el-input",{attrs:{placeholder:"审批人",size:"small"},model:{value:t.form.user,callback:function(n){t.$set(t.form,"user",n)},expression:"form.user"}})],1),e("el-form-item",{attrs:{label:"活动区域",prop:"region"}},[e("el-select",{attrs:{placeholder:"活动区域",size:"small"},model:{value:t.form.region,callback:function(n){t.$set(t.form,"region",n)},expression:"form.region"}},[e("el-option",{attrs:{label:"区域一",value:"shanghai"}}),e("el-option",{attrs:{label:"区域二",value:"beijing"}})],1)],1)],1),e("div",{staticClass:"detail-wrap"},[e("h3",{staticClass:"detail-wrap-title"},[t._v("上传图片信息")]),e("el-form-item",{attrs:{prop:"fileList"}},[e("UploadWall",{attrs:{fileList:t.form.fileList},on:{"update:fileList":function(n){return t.$set(t.form,"fileList",n)},"update:file-list":function(n){return t.$set(t.form,"fileList",n)}}})],1)],1),e("div",{staticClass:"detail-wrap"},[e("h3",{staticClass:"detail-wrap-title"},[t._v("输入产品介绍文本")]),e("el-form-item",{attrs:{prop:"richTxt"}},[e("Tinymce",{attrs:{tinymceHtml:t.form.richTxt},on:{"update:tinymceHtml":function(n){return t.$set(t.form,"richTxt",n)},"update:tinymce-html":function(n){return t.$set(t.form,"richTxt",n)}}})],1)],1),e("div",{staticClass:"custom-footer-btn"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("sumbit")])],1)])},[],!1,null,"67f6384d",null));n.default=E.exports},"030f":function(t,n){!function(t){"use strict";var n=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},e=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t()}},r=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))}},o=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=n.concat(e);return t.apply(null,o)}}var a,c,s=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}},l=function(t){return function(){throw new Error(t)}},f=o(!1),d=o(!0),m=f,g=d,p=function(){return h},h=function(){var t=function(t){return t.isNone()},n=function(t){return t()},e=function(t){return t},r={fold:function(t,n){return t()},is:m,isSome:m,isNone:g,getOr:e,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:e,orThunk:n,map:p,ap:p,each:function(){},bind:p,flatten:p,exists:m,forall:g,filter:p,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(r),r}(),v=function(t){var n=function(){return t},e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:g,isNone:m,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return v(n(t))},ap:function(n){return n.fold(p,function(n){return v(n(t))})},each:function(n){n(t)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(t)?o:h},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(m,function(n){return e(t,n)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},b={some:v,none:p,from:function(t){return null==t?h:v(t)}},y=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(n)===t}},w=y("string"),x=y("object"),S=y("array"),C=(y("null"),y("boolean")),O=(y("undefined"),y("function")),k=y("number"),T=void 0===(a=Array.prototype.indexOf)?function(t,n){return V(t,n)}:function(t,n){return a.call(t,n)},E=function(t,n){var e=T(t,n);return-1===e?b.none():b.some(e)},D=function(t,n){return T(t,n)>-1},A=function(t,n){return H(t,n).isSome()},R=function(t,n){for(var e=[],r=0;r<t.length;r+=n){var o=t.slice(r,r+n);e.push(o)}return e},B=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o,t)}return r},N=function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e,t)},_=function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e],e,t)},I=function(t,n){for(var e=[],r=[],o=0,i=t.length;o<i;o++){var u=t[o];(n(u,o,t)?e:r).push(u)}return{pass:e,fail:r}},M=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r,t)&&e.push(i)}return e},F=function(t,n,e){return _(t,function(t){e=n(e,t)}),e},P=function(t,n,e){return N(t,function(t){e=n(e,t)}),e},L=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e,t))return b.some(o)}return b.none()},H=function(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e,t))return b.some(e);return b.none()},V=function(t,n){for(var e=0,r=t.length;e<r;++e)if(t[e]===n)return e;return-1},z=Array.prototype.push,j=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!Array.prototype.isPrototypeOf(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);z.apply(n,t[e])}return n},U=function(t,n){var e=B(t,n);return j(e)},W=function(t,n){for(var e=0,r=t.length;e<r;++e)if(!0!==n(t[e],e,t))return!1;return!0},G=Array.prototype.slice,q=function(t){var n=G.call(t,0);return n.reverse(),n},$=function(t,n){return M(t,function(t){return!D(n,t)})},X=function(t){return[t]},Y=function(t,n){var e=G.call(t,0);return e.sort(n),e},K=function(t){return 0===t.length?b.none():b.some(t[0])},J=function(t){return 0===t.length?b.none():b.some(t[t.length-1])},Z=O(Array.from)?Array.from:function(t){return G.call(t)},Q=Object.keys,tt=Object.hasOwnProperty,nt=function(t,n){for(var e=Q(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i,t)}},et=function(t,n){return rt(t,function(t,e,r){return{k:e,v:n(t,e,r)}})},rt=function(t,n){var e={};return nt(t,function(r,o){var i=n(r,o,t);e[i.k]=i.v}),e},ot=function(t,n){var e=[];return nt(t,function(t,r){e.push(n(t,r))}),e},it=function(t,n){for(var e=Q(t),r=0,o=e.length;r<o;r++){var i=e[r],u=t[i];if(n(u,i,t))return b.some(u)}return b.none()},ut=function(t){return ot(t,function(t){return t})},at=function(t,n){return ct(t,n)?b.from(t[n]):b.none()},ct=function(t,n){return tt.call(t,n)},st=function(t){return function(n){return ct(n,t)?b.from(n[t]):b.none()}},lt=function(t,n){return st(n)(t)},ft=function(t,n){var e={};return e[t]=n,e},dt=function(t){return{is:function(n){return t===n},isValue:d,isError:f,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:function(n){return dt(t)},orThunk:function(n){return dt(t)},fold:function(n,e){return e(t)},map:function(n){return dt(n(t))},mapError:function(n){return dt(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return b.some(t)}}},mt=function(t){return{is:f,isValue:f,isError:d,getOr:i,getOrThunk:function(t){return t()},getOrDie:function(){return l(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return mt(t)},mapError:function(n){return mt(n(t))},each:n,bind:function(n){return mt(t)},exists:f,forall:d,toOption:b.none}},gt={value:dt,error:mt},pt=function(n){if(!S(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],r={};return N(n,function(o,i){var u=Q(o);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=o[a];if(void 0!==r[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!S(c))throw new Error("case arguments must be an array");e.push(a),r[a]=function(){var r=arguments.length;if(r!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var n=Q(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!W(e,function(t){return D(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[a].apply(null,o)},log:function(n){t.console.log(n,{constructors:e,constructor:a,params:o})}}}}),r},ht=(pt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),Object.prototype.hasOwnProperty),vt=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<n.length;o++){var i=n[o];for(var u in i)ht.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},bt=vt(function(t,n){return x(t)&&x(n)?bt(t,n):n}),yt=vt(function(t,n){return n}),wt=function(t,n){return function(t,n){var e={};return nt(t,function(t,r){D(n,r)||(e[r]=t)}),e}(t,n)},xt=function(t){return st(t)},St=function(t,n){return function(t,n){return function(e){return ct(e,t)?e[t]:n}}(t,n)},Ct=function(t,n){return lt(t,n)},Ot=function(t,n){return ft(t,n)},kt=function(t){return function(t){var n={};return N(t,function(t){n[t.key]=t.value}),n}(t)},Tt=function(t,n){var e,o=function(t){var n=[],e=[];return N(t,function(t){t.fold(function(t){n.push(t)},function(t){e.push(t)})}),{errors:n,values:e}}(t);return o.errors.length>0?(e=o.errors,r(gt.error,j)(e)):function(t,n){return 0===t.length?gt.value(n):gt.value(bt(n,yt.apply(void 0,t)))}(o.values,n)},Et=function(t,n){return function(t,n){return ct(t,n)&&void 0!==t[n]&&null!==t[n]}(t,n)},Dt=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return Dt(e())}}},At=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},Rt=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return b.none()},Bt=function(t,n){for(var e=[],r=0;r<t.length;r++){var o=t[r];if(!o.isSome())return b.none();e.push(o.getOrDie())}return b.some(n.apply(null,e))},Nt=o("touchstart"),_t=o("touchmove"),It=o("touchend"),Mt=o("mousedown"),Ft=o("mousemove"),Pt=o("mouseout"),Lt=o("mouseup"),Ht=o("mouseover"),Vt=o("focusin"),zt=o("focusout"),jt=o("keydown"),Ut=o("keyup"),Wt=o("input"),Gt=o("change"),qt=o("click"),$t=o("transitionend"),Xt=o("selectstart"),Yt=function(t){var n,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,n=t.apply(null,r)),n}},Kt=function(){return Jt(0,0)},Jt=function(t,n){return{major:t,minor:n}},Zt={nu:Jt,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?Kt():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}}(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return Jt(r(1),r(2))}(t,e)},unknown:Kt},Qt=function(t,n){return function(){return n===t}},tn=function(t){var n=t.current;return{current:n,version:t.version,isEdge:Qt("Edge",n),isChrome:Qt("Chrome",n),isIE:Qt("IE",n),isOpera:Qt("Opera",n),isFirefox:Qt("Firefox",n),isSafari:Qt("Safari",n)}},nn={unknown:function(){return tn({current:void 0,version:Zt.unknown()})},nu:tn,edge:o("Edge"),chrome:o("Chrome"),ie:o("IE"),opera:o("Opera"),firefox:o("Firefox"),safari:o("Safari")},en=function(t,n){return function(){return n===t}},rn=function(t){var n=t.current;return{current:n,version:t.version,isWindows:en("Windows",n),isiOS:en("iOS",n),isAndroid:en("Android",n),isOSX:en("OSX",n),isLinux:en("Linux",n),isSolaris:en("Solaris",n),isFreeBSD:en("FreeBSD",n)}},on={unknown:function(){return rn({current:void 0,version:Zt.unknown()})},nu:rn,windows:o("Windows"),ios:o("iOS"),android:o("Android"),linux:o("Linux"),osx:o("OSX"),solaris:o("Solaris"),freebsd:o("FreeBSD")},un=function(t,n){var e=String(n).toLowerCase();return L(t,function(t){return t.search(e)})},an=function(t,n){return un(t,n).map(function(t){var e=Zt.detect(t.versionRegexes,n);return{current:t.name,version:e}})},cn=function(t,n){return un(t,n).map(function(t){var e=Zt.detect(t.versionRegexes,n);return{current:t.name,version:e}})},sn=function(t,n){return-1!==t.indexOf(n)},ln=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,fn=function(t){return function(n){return sn(n,t)}},dn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return sn(t,"edge/")&&sn(t,"chrome")&&sn(t,"safari")&&sn(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ln],search:function(t){return sn(t,"chrome")&&!sn(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return sn(t,"msie")||sn(t,"trident")}},{name:"Opera",versionRegexes:[ln,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:fn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:fn("firefox")},{name:"Safari",versionRegexes:[ln,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(sn(t,"safari")||sn(t,"mobile/"))&&sn(t,"applewebkit")}}],mn=[{name:"Windows",search:fn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return sn(t,"iphone")||sn(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:fn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:fn("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:fn("linux"),versionRegexes:[]},{name:"Solaris",search:fn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:fn("freebsd"),versionRegexes:[]}],gn={browsers:o(dn),oses:o(mn)},pn=function(t){var n=gn.browsers(),e=gn.oses(),r=an(n,t).fold(nn.unknown,nn.nu),i=cn(e,t).fold(on.unknown,on.nu),u=function(t,n,e){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,c=r||u||a&&!0===/mobile/i.test(e),s=t.isiOS()||t.isAndroid(),l=s&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e);return{isiPad:o(r),isiPhone:o(i),isTablet:o(c),isPhone:o(l),isTouch:o(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:o(f)}}(i,r,t);return{browser:r,os:i,deviceType:u}},hn={detect:Yt(function(){var n=t.navigator.userAgent;return pn(n)})},vn={tap:o("alloy.tap")},bn=o("alloy.focus"),yn=o("alloy.blur.post"),wn=o("alloy.paste.post"),xn=o("alloy.receive"),Sn=o("alloy.execute"),Cn=o("alloy.focus.item"),On=vn.tap,kn=hn.detect().deviceType.isTouch()?vn.tap:qt,Tn=o("alloy.longpress"),En=o("alloy.sandbox.close"),Dn=o("alloy.typeahead.cancel"),An=o("alloy.system.init"),Rn=o("alloy.system.scroll"),Bn=o("alloy.system.resize"),Nn=o("alloy.system.attached"),_n=o("alloy.system.detached"),In=o("alloy.system.dismissRequested"),Mn=o("alloy.focusmanager.shifted"),Fn=o("alloy.slotcontainer.visibility"),Pn=o("alloy.change.tab"),Ln=o("alloy.dismiss.tab"),Hn=o("alloy.highlight"),Vn=o("alloy.dehighlight"),zn=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},jn={fromHtml:function(n,e){var r=(e||t.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return zn(r.childNodes[0])},fromTag:function(n,e){var r=(e||t.document).createElement(n);return zn(r)},fromText:function(n,e){var r=(e||t.document).createTextNode(n);return zn(r)},fromDom:zn,fromPoint:function(t,n,e){var r=t.dom();return b.from(r.elementFromPoint(n,e)).map(zn)}},Un=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return N(t,function(t,e){r[t]=o(n[e])}),r}},Wn=function(t){return t.slice(0).sort()},Gn=function(t,n){if(!S(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");N(n,function(n){if(!w(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")})},qn=function(t,n){var e=t.concat(n);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return Gn("required",t),Gn("optional",n),function(t){var n=Wn(t);L(n,function(t,e){return e<n.length-1&&t===n[e+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+n.join(", ")+"].")})}(e),function(r){var i=Q(r);W(t,function(t){return D(i,t)})||function(t,n){throw new Error("All required keys ("+Wn(t).join(", ")+") were not specified. Specified keys were: "+Wn(n).join(", ")+".")}(t,i);var u=M(i,function(t){return!D(e,t)});u.length>0&&function(t){throw new Error("Unsupported keys for object: "+Wn(t).join(", "))}(u);var a={};return N(t,function(t){a[t]=o(r[t])}),N(n,function(t){a[t]=o(Object.prototype.hasOwnProperty.call(r,t)?b.some(r[t]):b.none())}),a}},$n=void 0!==t.window?t.window:Function("return this;")(),Xn=function(t,n){return function(t,n){for(var e=null!=n?n:$n,r=0;r<t.length&&null!=e;++r)e=e[t[r]];return e}(t.split("."),n)},Yn={getOrDie:function(t,n){var e=function(t,n){return Xn(t,n)}(t,n);if(null==e)throw t+" not available on this browser";return e}},Kn=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE,t.Node.DOCUMENT_NODE),Jn=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),Zn=t.Node.TEXT_NODE,Qn=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,Jn),te=Kn,ne=function(t,n){var e=t.dom();if(e.nodeType!==Qn)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},ee=function(t){return t.nodeType!==Qn&&t.nodeType!==te||0===t.childElementCount},re=function(n,e){var r=void 0===e?t.document:e.dom();return ee(r)?[]:B(r.querySelectorAll(n),jn.fromDom)},oe=function(n,e){var r=void 0===e?t.document:e.dom();return ee(r)?b.none():b.from(r.querySelector(n)).map(jn.fromDom)},ie=function(t,n){return t.dom()===n.dom()},ue=(hn.detect().browser.isIE(),function(t){return jn.fromDom(t.dom().ownerDocument)}),ae=function(t){var n=t.dom().ownerDocument.defaultView;return jn.fromDom(n)},ce=function(t){var n=t.dom();return b.from(n.parentNode).map(jn.fromDom)},se=function(t){var n=t.dom();return b.from(n.offsetParent).map(jn.fromDom)},le=function(t){var n=t.dom();return B(n.childNodes,jn.fromDom)},fe=function(t,n){var e=t.dom().childNodes;return b.from(e[n]).map(jn.fromDom)},de=(Un("element","offset"),function(t,n){ce(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})}),me=function(t,n){(function(t){var n=t.dom();return b.from(n.nextSibling).map(jn.fromDom)})(t).fold(function(){ce(t).each(function(t){pe(t,n)})},function(t){de(t,n)})},ge=function(t,n){(function(t){return fe(t,0)})(t).fold(function(){pe(t,n)},function(e){t.dom().insertBefore(n.dom(),e.dom())})},pe=function(t,n){t.dom().appendChild(n.dom())},he=function(t,n){N(n,function(n){pe(t,n)})},ve=function(t){t.dom().textContent="",N(le(t),function(t){be(t)})},be=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},ye=function(t){return t.dom().innerHTML},we=function(n,e){var r,o,i=ue(n).dom(),u=jn.fromDom(i.createDocumentFragment()),a=(r=e,(o=(i||t.document).createElement("div")).innerHTML=r,le(jn.fromDom(o)));he(u,a),ve(n),pe(n,u)},xe=function(t){return t.dom().nodeName.toLowerCase()},Se=function(t){return t.dom().nodeType},Ce=function(t){return function(n){return Se(n)===t}},Oe=Ce(Jn),ke=Ce(Zn),Te=Ce(Kn),Ee=function(n,e,r){if(!(w(r)||C(r)||k(r)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")},De=function(t,n,e){Ee(t.dom(),n,e)},Ae=function(t,n){var e=t.dom();nt(n,function(t,n){Ee(e,n,t)})},Re=function(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e},Be=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Ne=function(t,n){t.dom().removeAttribute(n)},_e=function(t){return function(t,n){return jn.fromDom(t.dom().cloneNode(n))}(t,!1)},Ie=function(t){return function(t){var n=jn.fromTag("div"),e=jn.fromDom(t.dom().cloneNode(!0));return pe(n,e),ye(n)}(_e(t))},Me=function(t){return Ie(t)},Fe="__CHROME_INSPECTOR_CONNECTION_TO_ALLOY__";!function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.LOGGING=2]="LOGGING"}(c||(c={}));var Pe=Dt({}),Le=function(n,e,r){switch(Ct(Pe.get(),n).orThunk(function(){var t=Q(Pe.get());return Rt(t,function(t){return n.indexOf(t)>-1?b.some(Pe.get()[t]):b.none()})}).getOr(c.NORMAL)){case c.NORMAL:return r(Ue());case c.LOGGING:var o=function(n,e){var r=[],o=(new Date).getTime();return{logEventCut:function(t,n,e){r.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){r.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){r.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){r.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){r.push({outcome:"response",purpose:e,target:n})},write:function(){var i=(new Date).getTime();D(["mousemove","mouseover","mouseout",An()],n)||t.console.log(n,{event:n,time:i-o,target:e.dom(),sequence:B(r,function(t){return D(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Me(t.target)+")":t.outcome})})}}}(n,e),i=r(o);return o.write(),i;case c.STOP:return!0}},He=["alloy/data/Fields","alloy/debugging/Debugging"],Ve=function(t,n,e){return Le(t,n,e)},ze=function(){if(void 0!==t.window[Fe])return t.window[Fe];var n=function(t,n){var e=Pe.get();e[t]=n,Pe.set(e)};return t.window[Fe]={systems:{},lookup:function(n){var e=t.window[Fe].systems,r=Q(e);return Rt(r,function(t){return e[t].getByUid(n).toOption().map(function(t){return Ot(Me(t.element()),function(t){var n=function(t){var e=t.spec();return{"(original.spec)":e,"(dom.ref)":t.element().dom(),"(element)":Me(t.element()),"(initComponents)":B(void 0!==e.components?e.components:[],n),"(components)":B(t.components(),n),"(bound.events)":ot(t.events(),function(t,n){return[n]}).join(", "),"(behaviours)":void 0!==e.behaviours?et(e.behaviours,function(n,e){return void 0===n?"--revoked--":{config:n.configAsRaw(),"original-config":n.initialConfig,state:t.readState(e)}}):"none"}};return n(t)}(t))})}).orThunk(function(){return b.some({error:"Systems ("+r.join(", ")+") did not contain uid: "+n})})},events:{setToNormal:function(t){n(t,c.NORMAL)},setToLogging:function(t){n(t,c.LOGGING)},setToStop:function(t){n(t,c.STOP)}}},t.window[Fe]},je=function(t,n){ze().systems[t]=n},Ue=o({logEventCut:n,logEventStopped:n,logNoParent:n,logEventNoHandlers:n,logEventResponse:n,write:n}),We=0,Ge=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++We+String(n)},qe=tinymce.util.Tools.resolve("tinymce.ThemeManager"),$e=function(){return($e=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function Xe(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&(e[r[o]]=t[r[o]])}return e}var Ye,Ke=pt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Je=function(t){return Ke.defaultedThunk(o(t))},Ze=function(t){return Ke.mergeWithThunk(o(t))},Qe=Ke.strict,tr=Ke.asOption,nr=Ke.defaultedThunk,er=Ke.mergeWithThunk;!function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"}(Ye||(Ye={}));var rr=function(t,n,e){return t.stype===Ye.Error?n(t.serror):e(t.svalue)},or=function(t){return{stype:Ye.Value,svalue:t}},ir=function(t){return{stype:Ye.Error,serror:t}},ur=function(t){return t.fold(ir,or)},ar=function(t){return rr(t,gt.error,gt.value)},cr=or,sr=function(t){var n=[],e=[];return N(t,function(t){rr(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},lr=ir,fr=function(t,n){return t.stype===Ye.Value?n(t.svalue):t},dr=function(t,n){return t.stype===Ye.Error?n(t.serror):t},mr=function(t,n){return t.stype===Ye.Value?{stype:Ye.Value,svalue:n(t.svalue)}:t},gr=function(t,n){return t.stype===Ye.Error?{stype:Ye.Error,serror:n(t.serror)}:t},pr=function(t){return r(lr,j)(t)},hr=function(t,n){var e=sr(t);return e.errors.length>0?pr(e.errors):function(t,n){return t.length>0?cr(bt(n,yt.apply(void 0,t))):cr(n)}(e.values,n)},vr=function(t){var n=sr(t);return n.errors.length>0?pr(n.errors):cr(n.values)},br=pt([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),yr=pt([{field:["name","presence","type"]},{state:["name"]}]),wr=function(){return Yn.getOrDie("JSON")},xr=function(t,n,e){return wr().stringify(t,n,e)},Sr=function(t){return x(t)&&Q(t).length>100?" removed due to size":xr(t,null,2)},Cr=function(t,n){return lr([{path:t,getErrorInfo:n}])},Or=pt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),kr=function(t,n,e){return lt(n,e).fold(function(){return function(t,n,e){return Cr(t,function(){return'Could not find valid *strict* value for "'+n+'" in '+Sr(e)})}(t,e,n)},cr)},Tr=function(t,n,e){var r=lt(t,n).fold(function(){return e(t)},i);return cr(r)},Er=function(t,n,e,r){return e.fold(function(e,i,u,a){var c=function(n){var o=a.extract(t.concat([e]),r,n);return mr(o,function(t){return ft(i,r(t))})},s=function(n){return n.fold(function(){var t=ft(i,r(b.none()));return cr(t)},function(n){var o=a.extract(t.concat([e]),r,n);return mr(o,function(t){return ft(i,r(b.some(t)))})})};return u.fold(function(){return fr(kr(t,n,e),c)},function(t){return fr(Tr(n,e,t),c)},function(){return fr(function(t,n){return cr(lt(t,n))}(n,e),s)},function(t){return fr(function(t,n,e){var r=lt(t,n).map(function(n){return!0===n?e(t):n});return cr(r)}(n,e,t),s)},function(t){var r=t(n),i=mr(Tr(n,e,o({})),function(t){return bt(r,t)});return fr(i,c)})},function(t,e){var o=e(n);return cr(ft(t,r(o)))})},Dr=function(t){return{extract:function(n,e,r){return dr(t(r,e),function(t){return function(t,n){return Cr(t,function(){return n})}(n,t)})},toString:function(){return"val"},toDsl:function(){return br.itemOf(t)}}},Ar=function(t){var n=Q(t);return M(n,function(n){return Et(t,n)})},Rr=function(t){var n=Br(t),e=F(t,function(t,n){return n.fold(function(n){return bt(t,Ot(n,!0))},o(t))},{});return{extract:function(t,r,o){var i=C(o)?[]:Ar(o),u=M(i,function(t){return!Et(e,t)});return 0===u.length?n.extract(t,r,o):function(t,n){return Cr(t,function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"})}(t,u)},toString:n.toString,toDsl:n.toDsl}},Br=function(t){return{extract:function(n,e,r){return function(t,n,e,r){var o=B(e,function(e){return Er(t,n,e,r)});return hr(o,{})}(n,r,t,e)},toString:function(){return"obj{\n"+B(t,function(t){return t.fold(function(t,n,e,r){return t+" -> "+r.toString()},function(t,n){return"state("+t+")"})}).join("\n")+"}"},toDsl:function(){return br.objOf(B(t,function(t){return t.fold(function(t,n,e,r){return yr.field(t,e,r)},function(t,n){return yr.state(t)})}))}}},Nr=function(t){return{extract:function(n,e,r){var o=B(r,function(r,o){return t.extract(n.concat(["["+o+"]"]),e,r)});return vr(o)},toString:function(){return"array("+t.toString()+")"},toDsl:function(){return br.arrOf(t)}}},_r=function(t,n){return{extract:function(e,r,o){var u=Q(o),a=function(n,e){return Nr(Dr(t)).extract(n,i,e)}(e,u);return fr(a,function(t){var i=B(t,function(t){return Or.field(t,t,Qe(),n)});return Br(i).extract(e,r,o)})},toString:function(){return"setOf("+n.toString()+")"},toDsl:function(){return br.setOf(t,n)}}},Ir=o(Dr(cr)),Mr=r(Nr,Br),Fr=Or.state,Pr=Or.field,Lr=function(t,n,e,r,o){return Ct(r,o).fold(function(){return function(t,n,e){return Cr(t,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Sr(n)})}(t,r,o)},function(r){return Br(r).extract(t.concat(["branch: "+o]),n,e)})},Hr=function(t,n){return{extract:function(e,r,o){return Ct(o,t).fold(function(){return function(t,n){return Cr(t,function(){return'Choice schema did not contain choice key: "'+n+'"'})}(e,t)},function(t){return Lr(e,r,o,n,t)})},toString:function(){return"chooseOn("+t+"). Possible values: "+Q(n)},toDsl:function(){return br.choiceOf(t,n)}}},Vr=Dr(cr),zr=function(t){return Mr(t)},jr=function(){return Nr(Vr)},Ur=function(t){return Dr(function(n){return t(n).fold(lr,cr)})},Wr=function(t,n){return _r(function(n){return ur(t(n))},n)},Gr=function(t,n,e,r){var o=n.extract([t],e,r);return gr(o,function(t){return{input:r,errors:t}})},qr=function(t,n,e){return ar(Gr(t,n,i,e))},$r=function(t){return t.fold(function(t){throw new Error(Yr(t))},i)},Xr=function(t,n,e){return $r(qr(t,n,e))},Yr=function(t){return"Errors: \n"+(n=t.errors,e=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,B(e,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))+"\n\nInput object: "+Sr(t.input);var n,e},Kr=function(t,n){return Hr(t,n)},Jr=o(Vr),Zr=function(t,n){return Dr(function(e){var r=typeof e;return t(e)?cr(e):lr("Expected type: "+n+" but got: "+r)})},Qr=Zr(k,"number"),to=Zr(w,"string"),no=Zr(C,"boolean"),eo=Zr(O,"function"),ro=function(t){return Ur(function(n){return D(t,n)?gt.value(n):gt.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')})},oo=function(t){return Pr(t,t,Qe(),Ir())},io=function(t,n){return Pr(t,t,Qe(),n)},uo=function(t){return io(t,to)},ao=function(t,n){return Pr(t,t,Qe(),ro(n))},co=function(t){return io(t,eo)},so=function(t,n){return Pr(t,t,Qe(),Br(n))},lo=function(t,n){return Pr(t,t,Qe(),Mr(n))},fo=function(t,n){return Pr(t,t,Qe(),Nr(n))},mo=function(t){return Pr(t,t,tr(),Ir())},go=function(t,n){return Pr(t,t,tr(),n)},po=function(t){return go(t,Qr)},ho=function(t){return go(t,to)},vo=function(t){return go(t,eo)},bo=function(t,n){return go(t,Br(n))},yo=function(t,n){return Pr(t,t,Je(n),Ir())},wo=function(t,n,e){return Pr(t,t,Je(n),e)},xo=function(t,n){return wo(t,n,Qr)},So=function(t,n){return wo(t,n,to)},Co=function(t,n,e){return wo(t,n,ro(e))},Oo=function(t,n){return wo(t,n,no)},ko=function(t,n){return wo(t,n,eo)},To=function(t,n,e){return wo(t,n,Br(e))},Eo=function(t,n){return Fr(t,n)},Do=function(t,n){return ie(t.element(),n.event().target())},Ao=function(t){if(!Et(t,"can")&&!Et(t,"abort")&&!Et(t,"run"))throw new Error("EventHandler defined by: "+xr(t,null,2)+" does not have can, abort, or run!");return Xr("Extracting event.handler",Rr([yo("can",o(!0)),yo("abort",o(!1)),yo("run",n)]),t)},Ro=function(t){var n=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return P(t,function(t,r){return t&&n(r).apply(void 0,e)},!0)}}(t,function(t){return t.can}),e=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return P(t,function(t,r){return t||n(r).apply(void 0,e)},!1)}}(t,function(t){return t.abort});return Ao({can:n,abort:e,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];N(t,function(t){t.run.apply(void 0,n)})}})},Bo=function(t,n){Mo(t,t.element(),n,{})},No=function(t,n,e){Mo(t,t.element(),n,e)},_o=function(t){Bo(t,Sn())},Io=function(t,n,e){Mo(t,n,e,{})},Mo=function(t,n,e,r){var i=$e({target:n},r);t.getSystem().triggerEvent(e,n,et(i,o))},Fo=function(t,n,e,r){t.getSystem().triggerEvent(e,n,r.event())};function Po(t,n,e,r,o){return t(e,r)?b.some(e):O(o)&&o(e)?b.none():n(e,r,o)}var Lo=function(t){var n=ke(t)?t.dom().parentNode:t.dom();return null!=n&&n.ownerDocument.body.contains(n)},Ho=Yt(function(){return Vo(jn.fromDom(t.document))}),Vo=function(t){var n=t.dom().body;if(null==n)throw new Error("Body is not available yet");return jn.fromDom(n)},zo=function(t,n,e){for(var r=t.dom(),i=O(e)?e:o(!1);r.parentNode;){r=r.parentNode;var u=jn.fromDom(r);if(n(u))return b.some(u);if(i(u))break}return b.none()},jo=function(t,n,e){return Po(function(t){return n(t)},zo,t,n,e)},Uo=function(t,n){var e=function(t){for(var r=0;r<t.childNodes.length;r++){if(n(jn.fromDom(t.childNodes[r])))return b.some(jn.fromDom(t.childNodes[r]));var o=e(t.childNodes[r]);if(o.isSome())return o}return b.none()};return e(t.dom())},Wo=function(t,n,e){return jo(t,function(t){return n(t).isSome()},e).bind(n)},Go=function(t){return kt(t)},qo=function(t,n){return{key:t,value:Ao({abort:n})}},$o=function(t,n){return{key:t,value:Ao({can:n})}},Xo=function(t){return{key:t,value:Ao({run:function(t,n){n.event().prevent()}})}},Yo=function(t,n){return{key:t,value:Ao({run:n})}},Ko=function(t,n,e){return{key:t,value:Ao({run:function(t){n.apply(void 0,[t].concat(e))}})}},Jo=function(t){return function(n){return{key:t,value:Ao({run:function(t,e){Do(t,e)&&n(t,e)}})}}},Zo=function(t,n){return Yo(t,function(e,r){e.getSystem().getByUid(n).each(function(n){Fo(n,n.element(),t,r)})})},Qo=function(t,n,e){var r=n.partUids[e];return Zo(t,r)},ti=function(t,n){return Yo(t,function(t,e){var r=e.event(),i=t.getSystem().getByDom(r.target()).fold(function(){return Wo(r.target(),function(n){return t.getSystem().getByDom(n).toOption()},o(!1)).getOr(t)},function(t){return t});n(t,i,e)})},ni=function(t){return Yo(t,function(t,n){n.cut()})},ei=function(t){return Yo(t,function(t,n){n.stop()})},ri=function(t,n){return Jo(t)(n)},oi=Jo(Nn()),ii=Jo(_n()),ui=Jo(An()),ai=function(t){return function(n){return Yo(t,n)}}(Sn()),ci=Go([$o(bn(),function(n,e){var r=e.event().originator(),o=e.event().target();return!function(t,n,e){return ie(n,t.element())&&!ie(n,e)}(n,r,o)||(t.console.warn(bn()+" did not get interpreted by the desired target. \nOriginator: "+Me(r)+"\nTarget: "+Me(o)+"\nCheck the "+bn()+" event handlers"),!1)})]),si=Object.freeze({events:ci}),li=o("alloy-id-"),fi=o("data-alloy-id"),di=li(),mi=fi(),gi=function(t,n){var e=Ge(di+t);return pi(n,e),e},pi=function(t,n){Object.defineProperty(t.dom(),mi,{value:n,writable:!0})},hi=function(t){var n=Oe(t)?t.dom()[mi]:null;return b.from(n)},vi=function(t){return Ge(t)},bi=i,yi=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+"\n"+Me(t().element())+" is not in context.")}};return{debugInfo:o("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:o(!1)}},wi=yi(),xi=function(t){return B(t,function(t){return function(t,n){return function(t,n,e){return""===n||!(t.length<n.length)&&t.substr(e,e+n.length)===n}(t,n,t.length-n.length)}(t,"/*")?t.substring(0,t.length-"/*".length):t})},Si=function(t,n){var e=t.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:xi(i)}},t},Ci=Ge("alloy-premade"),Oi=function(t){return Ot(Ci,t)},ki=function(t){return Ct(t,Ci)},Ti=function(t){return function(t,n){var e=n.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:xi(i.slice(1))}},t}(function(n){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.apply(void 0,[n.getApis()].concat([n].concat(e)))},t)},Ei={init:function(){return Di({readState:function(){return"No State required"}})}},Di=function(t){return t},Ai=function(t,n){var e={};return nt(t,function(t,r){nt(t,function(t,o){var i=St(o,[])(e);e[o]=i.concat([n(r,t)])})}),e},Ri=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},Bi=function(t,n){return e=u.apply(void 0,[t.handler].concat(n)),r=t.purpose(),{cHandler:e,purpose:o(r)};var e,r},Ni=function(t){return t.cHandler},_i=function(t,n){return{name:o(t),handler:o(n)}},Ii=function(t,n,e){var r=$e({},e,function(t,n){var e={};return N(t,function(t){e[t.name()]=t.handlers(n)}),e}(n,t));return Ai(r,_i)},Mi=function(t){var n=function(t){return O(t)?{can:o(!0),abort:o(!1),run:t}:t}(t);return function(t,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[t,e].concat(r);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}},Fi=function(t,n,e){var r=n[e];return r?function(t,n,e,r){var o=e.slice(0);try{var i=o.sort(function(e,o){var i=e[n](),u=o[n](),a=r.indexOf(i),c=r.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+xr(r,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+xr(r,null,2));return a<c?-1:c<a?1:0});return gt.value(i)}catch(t){return gt.error([t])}}("Event: "+e,"name",t,r).map(function(t){var n=B(t,function(t){return t.handler()});return Ro(n)}):function(t,n){return gt.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+xr(B(n,function(t){return t.name()}),null,2)])}(e,t)},Pi=function(t,n){var e=ot(t,function(t,e){return(1===t.length?gt.value(t[0].handler()):Fi(t,n,e)).map(function(r){var i=Mi(r),u=t.length>1?M(n,function(n){return D(t,function(t){return t.name()===n})}).join(" > "):t[0].name();return Ot(e,function(t,n){return{handler:t,purpose:o(n)}}(i,u))})});return Tt(e,{})},Li=function(t){return t.events},Hi=function(t,n){var e=Re(t,n);return void 0===e||""===e?[]:e.split(" ")},Vi=function(t){return void 0!==t.dom().classList},zi=function(t){return Hi(t,"class")},ji=function(t,n){return function(t,n,e){var r=Hi(t,n).concat([e]);return De(t,n,r.join(" ")),!0}(t,"class",n)},Ui=function(t,n){return function(t,n,e){var r=M(Hi(t,n),function(t){return t!==e});return r.length>0?De(t,n,r.join(" ")):Ne(t,n),!1}(t,"class",n)},Wi=function(t,n){Vi(t)?t.dom().classList.add(n):ji(t,n)},Gi=function(t,n){Vi(t)?t.dom().classList.remove(n):Ui(t,n),function(t){0===(Vi(t)?t.dom().classList:zi(t)).length&&Ne(t,"class")}(t)},qi=function(t,n){return Vi(t)&&t.dom().classList.contains(n)},$i=function(t,n){N(n,function(n){Wi(t,n)})},Xi=function(t,n){N(n,function(n){Gi(t,n)})},Yi=function(t){return void 0!==t.style},Ki=function(n,e,r){if(!w(r))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);Yi(n)&&n.style.setProperty(e,r)},Ji=function(t,n){Yi(t)&&t.style.removeProperty(n)},Zi=function(t,n,e){var r=t.dom();Ki(r,n,e)},Qi=function(t,n){var e=t.dom();nt(n,function(t,n){Ki(e,n,t)})},tu=function(t,n){var e=t.dom();nt(n,function(t,n){t.fold(function(){Ji(e,n)},function(t){Ki(e,n,t)})})},nu=function(n,e){var r=n.dom(),o=t.window.getComputedStyle(r).getPropertyValue(e),i=""!==o||Lo(n)?o:eu(r,e);return null===i?void 0:i},eu=function(t,n){return Yi(t)?t.style.getPropertyValue(n):""},ru=function(t,n){var e=t.dom(),r=eu(e,n);return b.from(r).filter(function(t){return t.length>0})},ou=function(t,n,e){var r=jn.fromTag(t);return Zi(r,n,e),ru(r,n).isSome()},iu=function(t,n){var e=t.dom();Ji(e,n),Be(t,"style")&&""===Re(t,"style").replace(/^\s+|\s+$/g,"")&&Ne(t,"style")},uu=function(t){return t.dom().offsetWidth},au=function(t){return t.dom().value},cu=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom().value=n},su=function(t,n){return function(t,n){var e=B(n,function(t){return bo(t.name(),[oo("config"),yo("state",Ei)])}),r=qr("component.behaviours",Br(e),t.behaviours).fold(function(n){throw new Error(Yr(n)+"\nComplete spec:\n"+xr(t,null,2))},function(t){return t});return{list:n,data:et(r,function(t){var n=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return function(){return n}})}}(t,n)},lu=function(t){var n=function(t){var n=St("behaviours",{})(t),e=M(Q(n),function(t){return void 0!==n[t]});return B(e,function(t){return n[t].me})}(t);return su(t,n)},fu=function(t,n,e){var r,o,i,u=$e({},(r=t).dom,{uid:r.uid,domChildren:B(r.components,function(t){return t.element()})}),a=function(t){return t.domModification.fold(function(){return Ri({})},Ri)}(t),c={"alloy.base.modification":a},s=n.length>0?function(t,n,e,r){var o=$e({},n);N(e,function(n){o[n.name()]=n.exhibit(t,r)});var i=Ai(o,function(t,n){return{name:t,modification:n}}),u=function(t){return F(t,function(t,n){return $e({},n.modification,t)},{})},a=F(i.classes,function(t,n){return n.modification.concat(t)},[]),c=u(i.attributes),s=u(i.styles);return Ri({classes:a,attributes:c,styles:s})}(e,c,n,u):a;return i=s,$e({},o=u,{attributes:$e({},o.attributes,i.attributes),styles:$e({},o.styles,i.styles),classes:o.classes.concat(i.classes)})},du=function(t,n,e){var r={"alloy.base.behaviour":Li(t)};return function(t,n,e,r){var o=Ii(t,e,r);return Pi(o,n)}(e,t.eventOrder,n,r).getOrDie()},mu=function(t){var n=function(){return f},e=Dt(wi),r=$r(function(t){return qr("custom.definition",Br([Pr("dom","dom",Qe(),Br([oo("tag"),yo("styles",{}),yo("classes",[]),yo("attributes",{}),mo("value"),mo("innerHtml")])),oo("components"),oo("uid"),yo("events",{}),yo("apis",{}),Pr("eventOrder","eventOrder",Ze({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),Jr()),mo("domModification")]),t)}(t)),i=lu(t),u=function(t){return t.list}(i),a=function(t){return t.data}(i),c=function(t){var n=jn.fromTag(t.tag);Ae(n,t.attributes),$i(n,t.classes),Qi(n,t.styles),t.innerHtml.each(function(t){return we(n,t)});var e=t.domChildren;return he(n,e),t.value.each(function(t){cu(n,t)}),t.uid,pi(n,t.uid),n}(fu(r,u,a)),s=du(r,u,a),l=Dt(r.components),f={getSystem:e.get,config:function(n){var e=a;return(O(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+xr(t,null,2))})()},hasConfigured:function(t){return O(a[t.name()])},spec:o(t),readState:function(t){return a[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return r.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(yi(n))},element:o(c),syncComponents:function(){var t=le(c),n=U(t,function(t){return e.get().getByDom(t).fold(function(){return[]},function(t){return[t]})});l.set(n)},components:l.get,events:o(s)};return f},gu=function(t){var n=bi(t),e=n.events,r=Xe(n,["events"]),o=function(t){var n=St("components",[])(t);return B(n,bu)}(r),i=$e({},r,{events:$e({},si,e),components:o});return gt.value(mu(i))},pu=function(t){var n=jn.fromText(t);return hu({element:n})},hu=function(t){var e=Xr("external.component",Rr([oo("element"),mo("uid")]),t),r=Dt(yi());e.uid.each(function(t){pi(e.element,t)});var i={getSystem:r.get,config:b.none,hasConfigured:o(!1),connect:function(t){r.set(t)},disconnect:function(){r.set(yi(function(){return i}))},getApis:function(){return{}},element:o(e.element),spec:o(t),readState:o("No state"),syncComponents:n,components:o([]),events:o({})};return Oi(i)},vu=vi,bu=function(t){return ki(t).fold(function(){var n=t.hasOwnProperty("uid")?t:$e({uid:vu("")},t);return gu(n).getOrDie()},function(t){return t})},yu=Oi,wu=function(t,n,e){return jo(t,n,e).isSome()},xu=function(t,n,e){return zo(t,function(t){return ne(t,n)},e)},Su=function(t,n){return oe(n,t)},Cu=function(t,n,e){return Po(ne,xu,t,n,e)},Ou=function(t,n){return function(t){return jo(t,function(t){if(!Oe(t))return!1;var n=Re(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1}).bind(function(t){var n=Re(t,"id"),e=ue(t);return Su(e,'[aria-owns="'+n+'"]')})}(n).exists(function(n){return ku(t,n)})},ku=function(t,n){return wu(n,function(n){return ie(n,t.element())},o(!1))||Ou(t,n)},Tu=o([oo("menu"),oo("selectedMenu")]),Eu=o([oo("item"),oo("selectedItem")]),Du=(o(Br(Eu().concat(Tu()))),o(Br(Eu()))),Au=so("initSize",[oo("numColumns"),oo("numRows")]),Ru=function(){return so("markers",[oo("backgroundMenu")].concat(Tu()).concat(Eu()))},Bu=function(t){return so("markers",B(t,oo))},Nu=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");L(n,function(t){return t.indexOf("alloy")>0&&!A(He,function(n){return t.indexOf(n)>-1})}).getOr("unknown")}}(),Pr(n,n,e,Ur(function(t){return gt.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)})}))},_u=function(t){return Nu(0,t,Je(n))},Iu=function(t){return Nu(0,t,Je(b.none))},Mu=function(t){return Nu(0,t,Qe())},Fu=function(t){return Nu(0,t,Qe())},Pu=function(t,n){return Eo(t,o(n))},Lu=function(t){return Eo(t,i)},Hu=o(Au),Vu=function(t,n,e){return ui(function(r,o){e(r,t,n)})},zu=function(t,n,e){return function(t,n,e){var r=e.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:xi(u.slice(0,1).concat(u.slice(3)))}},t}(function(r){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var a=[r].concat(i);return r.config({name:o(t)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)},function(t){var e=Array.prototype.slice.call(a,1);return n.apply(void 0,[r,t.config,t.state].concat(e))})},e,n)},ju=function(t){return{key:t,value:void 0}},Uu=function(t,n,e,r,o,i,a){var c=function(t){return Et(t,e)?t[e]():b.none()},s=et(o,function(t,n){return zu(e,t,n)}),l=et(i,function(t,n){return Si(t,n)}),f=$e({},l,s,{revoke:u(ju,e),config:function(n){var r=Xr(e+"-config",t,n);return{key:e,value:{config:r,me:f,configAsRaw:Yt(function(){return Xr(e+"-config",t,n)}),initialConfig:n,state:a}}},schema:function(){return n},exhibit:function(t,n){return c(t).bind(function(t){return Ct(r,"exhibit").map(function(e){return e(n,t.config,t.state)})}).getOr(Ri({}))},name:function(){return e},handlers:function(t){return c(t).map(function(t){return St("events",function(t,n){return{}})(r)(t.config,t.state)}).getOr({})}});return f},Wu=function(t){return kt(t)},Gu=Rr([oo("fields"),oo("name"),yo("active",{}),yo("apis",{}),yo("state",Ei),yo("extra",{})]),qu=function(t){var n=Xr("Creating behaviour: "+t.name,Gu,t);return function(t,n,e,r,o,i){var u,a,c=Rr(t),s=bo(n,[(u="config",a=t,go(u,Rr(a)))]);return Uu(c,s,n,e,r,o,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},$u=Rr([oo("branchKey"),oo("branches"),oo("name"),yo("active",{}),yo("apis",{}),yo("state",Ei),yo("extra",{})]),Xu=function(t){var n=Xr("Creating behaviour: "+t.name,$u,t);return function(t,n,e,r,o,i){var u=t,a=bo(n,[go("config",t)]);return Uu(u,a,n,e,r,o,i)}(Kr(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},Yu=o(void 0),Ku=Object.freeze({events:function(t){return Go([Yo(xn(),function(n,e){var r=t.channels,o=function(t,n){return n.universal()?t:M(t,function(t){return D(n.channels(),t)})}(Q(r),e);N(o,function(t){var o=r[t],i=o.schema,u=Xr("channel["+t+"] data\nReceiver: "+Me(n.element()),i,e.data());o.onReceive(n,u)})})])}}),Ju=[io("channels",Wr(gt.value,Rr([Mu("onReceive"),yo("schema",Jr())])))],Zu=qu({fields:Ju,name:"receiving",active:Ku}),Qu=Object.freeze({exhibit:function(t,n){return Ri({classes:[],styles:n.useFixed?{}:{position:"relative"}})}}),ta=function(t,n){return{left:o(t),top:o(n),translate:function(e,r){return ta(t+e,n+r)}}},na=ta,ea=function(t,n){return void 0!==t?t:void 0!==n?n:0},ra=function(n){var e=n.dom().ownerDocument,r=e.body,o=function(n){var e=n.dom();return e===e.window&&n instanceof t.Window?n:Te(n)?e.defaultView||e.parentWindow:null}(jn.fromDom(e)),i=e.documentElement,u=ea(o.pageYOffset,i.scrollTop),a=ea(o.pageXOffset,i.scrollLeft),c=ea(i.clientTop,r.clientTop),s=ea(i.clientLeft,r.clientLeft);return oa(n).translate(a-s,u-c)},oa=function(n){var e=n.dom(),r=e.ownerDocument,o=r.body,i=jn.fromDom(r.documentElement);return o===e?na(o.offsetLeft,o.offsetTop):function(n,e){var r=e||jn.fromDom(t.document.documentElement);return zo(n,u(ie,r)).isSome()}(n,i)?function(t){var n=t.getBoundingClientRect();return na(n.left,n.top)}(e):na(0,0)},ia=(hn.detect().browser.isSafari(),function(n){var e=void 0!==n?n.dom():t.document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return na(r,o)});function ua(t,n){var e=function(e){var r=n(e);if(r<=0||null===r){var o=nu(e,t);return parseFloat(o)||0}return r},r=function(t,n){return P(n,function(n,e){var r=nu(t,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o},0)};return{set:function(n,e){if(!k(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var r=n.dom();Yi(r)&&(r.style[t]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(t,n,e){var o=r(t,e);return n>o?n-o:0}}}var aa=ua("width",function(t){return t.dom().offsetWidth}),ca=function(t){return aa.get(t)},sa=function(t){return aa.getOuter(t)},la=ua("height",function(t){var n=t.dom();return Lo(t)?n.getBoundingClientRect().height:n.offsetHeight}),fa=function(t){return la.get(t)},da=function(t){return la.getOuter(t)},ma=qn(["x","y","width","height","maxHeight","direction","classes","label","candidateYforTest"],[]),ga=Un("position","left","top","right","bottom"),pa=pt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ha=pa.southeast,va=pa.southwest,ba=pa.northeast,ya=pa.northwest,wa=pa.south,xa=pa.north,Sa=pa.east,Ca=pa.west,Oa=Un("point","width","height"),ka=Un("x","y","width","height"),Ta=function(t,n,e,r){return{x:o(t),y:o(n),width:o(e),height:o(r),right:o(t+e),bottom:o(n+r)}},Ea=function(t){var n=ra(t),e=sa(t),r=da(t);return Ta(n.left(),n.top(),e,r)},Da=function(t,n){return t.view(n).fold(o([]),function(n){var e=t.owner(n),r=Da(t,e);return[n].concat(r)})},Aa=Object.freeze({view:function(n){return(n.dom()===t.document?b.none():b.from(n.dom().defaultView.frameElement)).map(jn.fromDom)},owner:function(t){return ue(t)}}),Ra=function(n){var e=jn.fromDom(t.document),r=ia(e);return function(t,n){var e=n.owner(t),r=Da(n,e);return b.some(r)}(n,Aa).fold(u(ra,n),function(t){var e=oa(n),o=F(t,function(t,n){var e=oa(n);return{left:t.left+e.left(),top:t.top+e.top()}},{left:0,top:0});return na(o.left+e.left()+r.left(),o.top+e.top()+r.top())})},Ba=function(){var n=t.window.innerWidth,e=t.window.innerHeight,r=jn.fromDom(t.document),o=ia(r);return Ta(o.left(),o.top(),n,e)},Na=pt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),_a=function(t,n,e,r,o,i){var u=n.x()-e,a=n.y()-r,c=o-(u+n.width()),s=i-(a+n.height()),l=b.some(u),f=b.some(a),d=b.some(c),m=b.some(s),g=b.none();return function(t,n,e,r,o,i,u,a,c){return t.fold(n,e,r,o,i,u,a,c)}(n.direction(),function(){return ga(t,l,f,g,g)},function(){return ga(t,g,f,d,g)},function(){return ga(t,l,g,g,m)},function(){return ga(t,g,g,d,m)},function(){return ga(t,l,f,g,g)},function(){return ga(t,l,g,g,m)},function(){return ga(t,l,f,g,g)},function(){return ga(t,g,f,d,g)})},Ia=function(t,n){var e=u(Ra,n),r=t.fold(e,e,function(){var t=ia();return Ra(n).translate(-t.left(),-t.top())}),o=sa(n),i=da(n);return Ta(r.left(),r.top(),o,i)},Ma=function(t,n){return n.fold(function(){return t.fold(Ba,Ba,Ta)},function(n){return t.fold(n,n,Ta)})},Fa=Na.relative,Pa=Na.fixed,La=Un("anchorBox","origin"),Ha=function(t,n){return La(t,n)},Va=pt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),za=function(t,n,e,r,a){var c=e.width(),s=e.height(),l=function(t,i,u,l){return function(t,n,e,r){var i=t.x(),u=t.y(),a=t.bubble().offset().left(),c=t.bubble().offset().top(),s=r.x(),l=r.y(),f=r.width(),d=r.height(),m=i+a,g=u+c,p=m>=s,h=g>=l,v=p&&h,b=m+n<=s+f&&g+e<=l+d,y=p?Math.min(n,s+f-m):Math.abs(s-(m+n)),w=h?Math.min(e,l+d-g):Math.abs(l-(g+e)),x=r.x()+r.width(),S=Math.max(r.x(),m),C=Math.min(S,x),O=h?g:g+(e-w),k=o(O+w-l),T=o(l+d-O),E=function(t,n,e,r){return t.fold(n,n,r,r,n,r,e,e)}(t.direction(),T,T,k),D=ma({x:C,y:O,width:y,height:w,maxHeight:E,direction:t.direction(),classes:{on:t.bubble().classesOn(),off:t.bubble().classesOff()},label:t.label(),candidateYforTest:g});return v&&b?Va.fit(D):Va.nofit(D,y,w)}(t(n,e,r),c,s,a).fold(Va.fit,function(t,n,e){return e>l||n>u?Va.nofit(t,n,e):Va.nofit(i,u,l)})};return P(t,function(t,n){var e=u(l,n);return t.fold(Va.fit,e)},Va.nofit(ma({x:n.x(),y:n.y(),width:e.width(),height:e.height(),maxHeight:e.height(),direction:ha(),classes:[],label:"none",candidateYforTest:n.y()}),-1,-1)).fold(i,i)},ja=function(t,n,e,r){iu(n,"max-height");var i,u={width:o(sa(i=n)),height:o(da(i))};return za(r.preference(),t,u,e,r.bounds())},Ua=function(t,n,e){var r=function(t){return t+"px"},o=function(t,n){return t.fold(function(){return ga("absolute",b.some(n.x()),b.some(n.y()),b.none(),b.none())},function(t,e,r,o){return _a("absolute",n,t,e,r,o)},function(t,e,r,o){return _a("fixed",n,t,e,r,o)})}(e.origin(),n);tu(t,{position:b.some(o.position()),left:o.left().map(r),top:o.top().map(r),right:o.right().map(r),bottom:o.bottom().map(r)})},Wa=function(t,n){!function(t,n){var e=la.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Zi(t,"max-height",e+"px")}(t,Math.floor(n))},Ga=o(function(t,n){Wa(t,n),Qi(t,{"overflow-x":"hidden","overflow-y":"auto"})}),qa=o(function(t,n){Wa(t,n)}),$a=qn(["bounds","origin","preference","maxHeightFunction"],[]),Xa=function(t,n,e,r){var o=ja(t,n,e,r);Ua(n,o,r),function(t,n){var e=n.classes();Xi(t,e.off),$i(t,e.on)}(n,o),function(t,n,e){e.maxHeightFunction()(t,n.maxHeight())}(n,o,r)},Ya=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Ka=function(t,n,e){var r=function(t){return Ct(e,t).getOr([])},o=function(t,n,e){var o=$(Ya,e);return{offset:function(){return na(t,n)},classesOn:function(){return U(e,r)},classesOff:function(){return U(o,r)}}};return{southeast:function(){return o(-t,n,["top","alignLeft"])},southwest:function(){return o(t,n,["top","alignRight"])},south:function(){return o(-t/2,n,["top","alignCentre"])},northeast:function(){return o(-t,-n,["bottom","alignLeft"])},northwest:function(){return o(t,-n,["bottom","alignRight"])},north:function(){return o(-t/2,-n,["bottom","alignCentre"])},east:function(){return o(t,-n/2,["valignCentre","left"])},west:function(){return o(-t,-n/2,["valignCentre","right"])}}},Ja=function(){return Ka(0,0,{})},Za=Un("x","y","bubble","direction","label"),Qa=function(t){return t.x()},tc=function(t,n){return t.x()+t.width()/2-n.width()/2},nc=function(t,n){return t.x()+t.width()-n.width()},ec=function(t,n){return t.y()-n.height()},rc=function(t){return t.y()+t.height()},oc=function(t,n){return t.y()+t.height()/2-n.height()/2},ic=function(t,n,e){return Za(Qa(t),rc(t),e.southeast(),ha(),"layout-se")},uc=function(t,n,e){return Za(nc(t,n),rc(t),e.southwest(),va(),"layout-sw")},ac=function(t,n,e){return Za(Qa(t),ec(t,n),e.northeast(),ba(),"layout-ne")},cc=function(t,n,e){return Za(nc(t,n),ec(t,n),e.northwest(),ya(),"layout-nw")},sc=function(t,n,e){return Za(tc(t,n),ec(t,n),e.north(),xa(),"layout-n")},lc=function(t,n,e){return Za(tc(t,n),rc(t),e.south(),wa(),"layout-s")},fc=function(t,n,e){return Za(function(t){return t.x()+t.width()}(t),oc(t,n),e.east(),Sa(),"layout-e")},dc=function(t,n,e){return Za(function(t,n){return t.x()-n.width()}(t,n),oc(t,n),e.west(),Ca(),"layout-w")},mc=function(){return[ic,uc,ac,cc,lc,sc,fc,dc]},gc=function(){return[uc,ic,cc,ac,lc,sc,fc,dc]},pc=function(t){return t},hc=function(t,n){return function(e){return"rtl"===vc(e)?n:t}},vc=function(t){return"rtl"===nu(t,"direction")?"rtl":"ltr"},bc=function(){return bo("layouts",[oo("onLtr"),oo("onRtl")])},yc=function(t,n,e,r){var o=n.layouts.map(function(n){return n.onLtr(t)}).getOr(e),i=n.layouts.map(function(n){return n.onRtl(t)}).getOr(r);return hc(o,i)(t)},wc=[oo("hotspot"),mo("bubble"),bc(),Pu("placement",function(t,n,e){var r=n.hotspot,o=Ia(e,r.element()),i=yc(t.element(),n,mc(),gc());return b.some(pc({anchorBox:o,bubble:n.bubble.getOr(Ja()),overrides:{},layouts:i,placer:b.none()}))})],xc=[oo("x"),oo("y"),yo("height",0),yo("width",0),yo("bubble",Ja()),bc(),Pu("placement",function(t,n,e){var r=Ta(n.x,n.y,n.width,n.height),o=yc(t.element(),n,mc(),gc());return b.some(pc({anchorBox:r,bubble:n.bubble,overrides:{},layouts:o,placer:b.none()}))})],Sc=(pt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),pt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}])),Cc=Un("start","soffset","finish","foffset"),Oc=Sc.exact,kc=function(t,n,e,r){var o=function(t,n,e,r){var o=ue(t).dom().createRange();return o.setStart(t.dom(),n),o.setEnd(e.dom(),r),o}(t,n,e,r),i=ie(t,e)&&n===r;return o.collapsed&&!i},Tc=function(t,n,e){var r,o=t.document.createRange();return r=o,n.fold(function(t){r.setStartBefore(t.dom())},function(t,n){r.setStart(t.dom(),n)},function(t){r.setStartAfter(t.dom())}),function(t,n){n.fold(function(n){t.setEndBefore(n.dom())},function(n,e){t.setEnd(n.dom(),e)},function(n){t.setEndAfter(n.dom())})}(o,e),o},Ec=function(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},Dc=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},Ac=pt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Rc=function(t,n,e){return n(jn.fromDom(e.startContainer),e.startOffset,jn.fromDom(e.endContainer),e.endOffset)},Bc=function(t,n){return function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Ac.rtl(jn.fromDom(t.endContainer),t.endOffset,jn.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Rc(0,Ac.ltr,e)}):Rc(0,Ac.ltr,e)}(0,function(t,n){return n.match({domRange:function(t){return{ltr:o(t),rtl:b.none}},relative:function(n,e){return{ltr:Yt(function(){return Tc(t,n,e)}),rtl:Yt(function(){return b.some(Tc(t,e,n))})}},exact:function(n,e,r,o){return{ltr:Yt(function(){return Ec(t,n,e,r,o)}),rtl:Yt(function(){return b.some(Ec(t,r,o,n,e))})}}})}(t,n))},Nc=function(t,n){var e=function(n){return t(n)?b.from(n.dom().nodeValue):b.none()},r=hn.detect().browser,o=r.isIE()&&10===r.version.major?function(t){try{return e(t)}catch(t){return b.none()}}:e;return{get:function(e){if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return o(e).getOr("")},getOption:o,set:function(e,r){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom().nodeValue=r}}}(ke,"text"),_c=function(t){return Nc.get(t)},Ic=(document.caretPositionFromPoint||document.caretRangeFromPoint,function(t,n){return re(n,t)}),Mc=function(t){var n=jn.fromDom(t.anchorNode),e=jn.fromDom(t.focusNode);return kc(n,t.anchorOffset,e,t.focusOffset)?b.some(Cc(n,t.anchorOffset,e,t.focusOffset)):function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return b.some(Cc(jn.fromDom(n.startContainer),n.startOffset,jn.fromDom(e.endContainer),e.endOffset))}return b.none()}(t)},Fc=function(t,n){return function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?b.some(e).map(Dc):b.none()}(function(t,n){return Bc(t,n).match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}})}(t,n))},Pc=Un("element","offset"),Lc=pt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Hc=function(t){return t.fold(function(t){return t},function(t,n,e){return t.translate(-n,-e)})},Vc=function(t){return t.fold(function(t){return t},function(t,n,e){return t})},zc=function(t){return P(t,function(t,n){return t.translate(n.left(),n.top())},na(0,0))},jc=function(t){var n=B(t,Vc);return zc(n)},Uc=Lc.screen,Wc=Lc.absolute,Gc=function(t,n,e){var r=ue(t.element()),o=ia(r),i=function(t,n,e){var r=ae(e.root).dom();return b.from(r.frameElement).map(jn.fromDom).filter(function(n){var e=ue(n),r=ue(t.element());return ie(e,r)}).map(ra)}(t,0,e).getOr(o);return Wc(i,o.left(),o.top())},qc=function(t,n,e,r){var o=t,i=n,u=e,a=r;t<0&&(o=0,u=e+t),n<0&&(i=0,a=r+n);var c=Uc(na(o,i));return b.some(Oa(c,u,a))},$c=function(t,n,e,r,o){return t.map(function(t){var i,u,a,c=[n,t.point()],s=(i=function(){return jc(c)},u=function(){return jc(c)},a=function(){return function(t){var n=B(t,Hc);return zc(n)}(c)},r.fold(i,u,a)),l=ka(s.left(),s.top(),t.width(),t.height()),f=yc(o,e,e.showAbove?[ac,cc,ic,uc,sc,lc]:[ic,uc,ac,cc,lc,lc],e.showAbove?[cc,ac,uc,ic,sc,lc]:[uc,ic,cc,ac,lc,sc]);return pc({anchorBox:l,bubble:e.bubble.getOr(Ja()),overrides:e.overrides,layouts:f,placer:b.none()})})},Xc=Un("element","offset"),Yc=function(t,n){return ke(t)?Xc(t,n):function(t,n){var e=le(t);if(0===e.length)return Pc(t,n);if(n<e.length)return Pc(e[n],0);var r=e[e.length-1],o=ke(r)?_c(r).length:le(r).length;return Pc(r,o)}(t,n)},Kc=function(t,n){return n.getSelection.getOrThunk(function(){return function(){return function(t){return b.from(t.getSelection()).filter(function(t){return t.rangeCount>0}).bind(Mc)}(t)}})().map(function(t){var n=Yc(t.start(),t.soffset()),e=Yc(t.finish(),t.foffset());return Cc(n.element(),n.offset(),e.element(),e.offset())})},Jc=[mo("getSelection"),oo("root"),mo("bubble"),bc(),yo("overrides",{}),yo("showAbove",!1),Pu("placement",function(t,n,e){var r=ae(n.root).dom(),o=Gc(t,0,n),i=Kc(r,n).bind(function(t){var n;return Fc(r,(n=t,Sc.exact(n.start(),n.soffset(),n.finish(),n.foffset()))).orThunk(function(){var n=jn.fromText("\ufeff");return de(t.start(),n),Fc(r,Oc(n,0,n,1)).map(function(t){return be(n),t})}).bind(function(t){return qc(t.left(),t.top(),t.width(),t.height())})}),u=Kc(r,n).bind(function(t){return Oe(t.start())?b.some(t.start()):ce(t.start())}).getOr(t.element());return $c(i,o,n,e,u)})],Zc=[oo("node"),oo("root"),mo("bubble"),bc(),yo("overrides",{}),yo("showAbove",!1),Pu("placement",function(t,n,e){var r=Gc(t,0,n);return n.node.bind(function(o){var i=o.dom().getBoundingClientRect(),u=qc(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element());return $c(u,r,n,e,a)})})],Qc=function(t){return t.x()+t.width()},ts=function(t,n){return t.x()-n.width()},ns=function(t,n){return t.y()-n.height()+t.height()},es=function(t){return t.y()},rs=function(t,n,e){return Za(Qc(t),es(t),e.southeast(),ha(),"link-layout-se")},os=function(t,n,e){return Za(ts(t,n),es(t),e.southwest(),va(),"link-layout-sw")},is=function(t,n,e){return Za(Qc(t),ns(t,n),e.northeast(),ba(),"link-layout-ne")},us=function(t,n,e){return Za(ts(t,n),ns(t,n),e.northwest(),ya(),"link-layout-nw")},as=[oo("item"),bc(),Pu("placement",function(t,n,e){var r=Ia(e,n.item.element()),o=yc(t.element(),n,[rs,os,is,us],[os,rs,us,is]);return b.some(pc({anchorBox:r,bubble:Ja(),overrides:{},layouts:o,placer:b.none()}))})],cs=Kr("anchor",{selection:Jc,node:Zc,hotspot:wc,submenu:as,makeshift:xc}),ss=function(t,n,e,r,o){!function(t,n,e,r,o,i){var u=function(t,n,e){return void 0===t[n]?e:t[n]}(i,"maxHeightFunction",Ga()),a=t.anchorBox(),c=t.origin(),s=$a({bounds:Ma(c,o),origin:c,preference:r,maxHeightFunction:u});Xa(a,n,e,s)}(Ha(e.anchorBox,n),o.element(),e.bubble,e.layouts,r,e.overrides)},ls=function(n,e,r,o,i,u){var a=Xr("positioning anchor.info",cs,o);Zi(i.element(),"position","fixed");var c=ru(i.element(),"visibility");Zi(i.element(),"visibility","hidden");var s=e.useFixed?Pa(0,0,t.window.innerWidth,t.window.innerHeight):function(t){var n=ra(t.element()),e=t.element().dom().getBoundingClientRect();return Fa(n.left(),n.top(),e.width,e.height)}(n),l=a.placement,f=u.map(function(t){return function(){return Ea(t)}}).or(e.getBounds);l(n,a,s).each(function(t){t.placer.getOr(ss)(n,s,t,f,i)}),c.fold(function(){iu(i.element(),"visibility")},function(t){Zi(i.element(),"visibility",t)}),ru(i.element(),"left").isNone()&&ru(i.element(),"top").isNone()&&ru(i.element(),"right").isNone()&&ru(i.element(),"bottom").isNone()&&ru(i.element(),"position").is("fixed")&&iu(i.element(),"position")},fs=Object.freeze({position:function(t,n,e,r,o){var i=b.none();ls(t,n,e,r,o,i)},positionWithin:ls,getMode:function(t,n,e){return n.useFixed?"fixed":"absolute"}}),ds=[yo("useFixed",!1),mo("getBounds")],ms=qu({fields:ds,name:"positioning",active:Qu,apis:fs}),gs=function(t){Bo(t,_n());var n=t.components();N(n,gs)},ps=function(t){var n=t.components();N(n,ps),Bo(t,Nn())},hs=function(t,n){vs(t,n,pe)},vs=function(t,n,e){t.getSystem().addToWorld(n),e(t.element(),n.element()),Lo(t.element())&&ps(n),t.syncComponents()},bs=function(t){gs(t),be(t.element()),t.getSystem().removeFromWorld(t)},ys=function(t){var n=ce(t.element()).bind(function(n){return t.getSystem().getByDom(n).fold(b.none,b.some)});bs(t),n.each(function(t){t.syncComponents()})},ws=function(t){var n=t.components();N(n,bs),ve(t.element()),t.syncComponents()},xs=function(t,n){Ss(t,n,pe)},Ss=function(t,n,e){e(t,n.element());var r=le(n.element());N(r,function(t){n.getByDom(t).each(ps)})},Cs=function(t){var n=le(t.element());N(n,function(n){t.getByDom(n).each(gs)}),be(t.element())},Os=function(t,n,e,r){var o=function(t,n,e,r){e.get().each(function(n){ws(t)});var o=n.getAttachPoint(t);hs(o,t);var i=t.getSystem().build(r);return hs(t,i),e.set(i),i}(t,n,e,r);return n.onOpen(t,o),o},ks=function(t,n,e){e.get().each(function(r){ws(t),ys(t),n.onClose(t,r),e.clear()})},Ts=function(t,n,e){return e.isOpen()},Es=function(t,n,e){var r=n.getAttachPoint(t);Zi(t.element(),"position",ms.getMode(r)),function(t,n,e,r){ru(t.element(),n).fold(function(){Ne(t.element(),e)},function(n){De(t.element(),e,n)}),Zi(t.element(),n,r)}(t,"visibility",n.cloakVisibilityAttr,"hidden")},Ds=function(t,n,e){(function(t){return A(["top","left","right","bottom"],function(n){return ru(t,n).isSome()})})(t.element())||iu(t.element(),"position"),function(t,n,e){if(Be(t.element(),e)){var r=Re(t.element(),e);Zi(t.element(),n,r)}else iu(t.element(),n)}(t,"visibility",n.cloakVisibilityAttr)},As=Object.freeze({cloak:Es,decloak:Ds,open:Os,openWhileCloaked:function(t,n,e,r,o){Es(t,n,e),Os(t,n,e,r),o(),Ds(t,n,e)},close:ks,isOpen:Ts,isPartOf:function(t,n,e,r){return Ts(0,0,e)&&e.get().exists(function(e){return n.isPartOf(t,e,r)})},getState:function(t,n,e){return e.get()}}),Rs=Object.freeze({events:function(t,n){return Go([Yo(En(),function(e,r){ks(e,t,n)})])}}),Bs=[_u("onOpen"),_u("onClose"),oo("isPartOf"),oo("getAttachPoint"),yo("cloakVisibilityAttr","data-precloak-visibility")],Ns=qu({fields:Bs,name:"sandboxing",active:Rs,apis:As,state:Object.freeze({init:function(){var t=Dt(b.none()),n=o("not-implemented");return Di({readState:n,isOpen:function(){return t.get().isSome()},clear:function(){t.set(b.none())},set:function(n){t.set(b.some(n))},get:function(n){return t.get()}})}})}),_s=o("dismiss.popups"),Is=o("mouse.released"),Ms=Rr([yo("isExtraPart",o(!1)),bo("fireEventInstead",[yo("event",In())])]),Fs=function(t){var n=Ps(t);return Zu.config(n)},Ps=function(t){var n=Xr("Dismissal",Ms,t);return{channels:Ot(_s(),{schema:Rr([oo("target")]),onReceive:function(t,e){Ns.isOpen(t)&&(Ns.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold(function(){return Ns.close(t)},function(n){return Bo(t,n.event)}))}})}},Ls=function(t,n){return To(t,{},B(n,function(n){return e=n.name(),r="Cannot configure "+n.name()+" for "+t,Pr(e,e,tr(),Dr(function(t){return lr("The field: "+e+" is forbidden. "+r)}));var e,r}).concat([Eo("dump",i)]))},Hs=function(t){return t.dump},Vs=function(t,n){return $e({},t.dump,Wu(n))},zs={field:Ls,augment:Vs,get:Hs},js=pt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Us=function(t,n,e,r){return"placeholder"===e.uiType?function(t,n,e,r){return t.exists(function(t){return t!==e.owner})?js.single(!0,o(e)):Ct(r,e.name).fold(function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+Q(r)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+xr(e,null,2))},function(t){return t.replace()})}(t,0,e,r):js.single(!1,o(e))},Ws=function(t,n,e,r){return Us(t,0,e,r).fold(function(o,i){var u=i(n,e.config,e.validated),a=Ct(u,"components").getOr([]),c=U(a,function(e){return Ws(t,n,e,r)});return[$e({},u,{components:c})]},function(t,r){var o=r(n,e.config,e.validated);return e.validated.preprocess.getOr(i)(o)})},Gs=function(t,n,e,r){return U(e,function(e){return Ws(t,n,e,r)})},qs=function(t,n,e,r){var i=et(r,function(t,n){return r=t,i=!1,{name:o(e=n),required:function(){return r.fold(function(t,n){return t},function(t,n){return t})},used:function(){return i},replace:function(){if(!0===i)throw new Error("Trying to use the same placeholder more than once: "+e);return i=!0,r}};var e,r,i}),u=Gs(t,n,e,i);return nt(i,function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+xr(n.components,null,2))}),u},$s=js.single,Xs=js.multiple,Ys=o("placeholder"),Ks=pt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Js=yo("factory",{sketch:i}),Zs=yo("schema",[]),Qs=oo("name"),tl=Pr("pname","pname",nr(function(t){return"<alloy."+Ge(t.name)+">"}),Jr()),nl=Eo("schema",function(){return[mo("preprocess")]}),el=yo("defaults",o({})),rl=yo("overrides",o({})),ol=Br([Js,Zs,Qs,tl,el,rl]),il=Br([Js,Zs,Qs,el,rl]),ul=Br([Js,Zs,Qs,tl,el,rl]),al=Br([Js,nl,Qs,oo("unit"),tl,el,rl]),cl=function(t){return t.fold(b.some,b.none,b.some,b.some)},sl=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},ll=function(t,n){return function(e){var r=Xr("Converting part type",n,e);return t(r)}},fl=ll(Ks.required,ol),dl=ll(Ks.external,il),ml=ll(Ks.optional,ul),gl=ll(Ks.group,al),pl=o("entirety"),hl=Object.freeze({required:fl,external:dl,optional:ml,group:gl,asNamedPart:cl,name:sl,asCommon:function(t){return t.fold(i,i,i,i)},original:pl}),vl=function(t,n,e,r){return bt(n.defaults(t,e,r),e,{uid:t.partUids[n.name]},n.overrides(t,e,r))},bl=function(t,n){var e={};return N(n,function(n){cl(n).each(function(n){var r=yl(t,n.pname);e[n.name]=function(e){var o=Xr("Part: "+n.name+" in "+t,Br(n.schema),e);return $e({},r,{config:e,validated:o})}})}),e},yl=function(t,n){return{uiType:Ys(),owner:t,name:n}},wl=function(t,n,e){return{uiType:Ys(),owner:t,name:n,config:e,validated:{}}},xl=function(t){return U(t,function(t){return t.fold(b.none,b.some,b.none,b.none).map(function(t){return so(t.name,t.schema.concat([Lu(pl())]))}).toArray()})},Sl=function(t){return B(t,sl)},Cl=function(t,n,e){return function(t,n,e){var r={},i={};return N(e,function(t){t.fold(function(t){r[t.pname]=$s(!0,function(n,e,r){return t.factory.sketch(vl(n,t,e,r))})},function(t){var e=n.parts[t.name];i[t.name]=o(t.factory.sketch(vl(n,t,e[pl()]),e))},function(t){r[t.pname]=$s(!1,function(n,e,r){return t.factory.sketch(vl(n,t,e,r))})},function(t){r[t.pname]=Xs(!0,function(n,e,r){var o=n[t.name];return B(o,function(e){return t.factory.sketch(bt(t.defaults(n,e,r),e,t.overrides(n,e)))})})})}),{internals:o(r),externals:o(i)}}(0,n,e)},Ol=function(t,n,e){return qs(b.some(t),n,n.components,e)},kl=function(t,n,e){var r=n.partUids[e];return t.getSystem().getByUid(r).toOption()},Tl=function(t,n,e){return kl(t,n,e).getOrDie("Could not find part: "+e)},El=function(t,n,e){var r={},i=n.partUids,u=t.getSystem();return N(e,function(t){r[t]=u.getByUid(i[t])}),et(r,o)},Dl=function(t,n){var e=t.getSystem();return et(n.partUids,function(t,n){return o(e.getByUid(t))})},Al=function(t){return Q(t.partUids)},Rl=function(t,n,e){var r={},i=n.partUids,u=t.getSystem();return N(e,function(t){r[t]=u.getByUid(i[t]).getOrDie()}),et(r,o)},Bl=function(t,n){var e=Sl(n);return kt(B(e,function(n){return{key:n,value:t+"-"+n}}))},Nl=function(t){return Pr("partUids","partUids",er(function(n){return Bl(n.uid,t)}),Jr())},_l=Object.freeze({generate:bl,generateOne:wl,schemas:xl,names:Sl,substitutes:Cl,components:Ol,defaultUids:Bl,defaultUidsSchema:Nl,getAllParts:Dl,getAllPartNames:Al,getPart:kl,getPartOrDie:Tl,getParts:El,getPartsOrDie:Rl}),Il=function(t,n,e,r,o){var i=function(t,n,e,r){return(n.length>0?[so("parts",n)]:[]).concat([oo("uid"),yo("dom",{}),yo("components",[]),Lu("originalSpec"),yo("debug.sketcher",{})]).concat(e)}(0,r,o);return Xr(t+" [SpecSchema]",Rr(i.concat(n)),e)},Ml=function(t,n,e,r,o){var i=Fl(o),u=xl(e),a=Nl(e),c=Il(t,n,i,u,[a]),s=Cl(0,c,e);return r(c,Ol(t,c,s.internals()),i,s.externals())},Fl=function(t){return t.hasOwnProperty("uid")?t:$e({},t,{uid:vi("uid")})};function Pl(t){return void 0!==t.uid}var Ll,Hl=Rr([oo("name"),oo("factory"),oo("configFields"),yo("apis",{}),yo("extraApis",{})]),Vl=Rr([oo("name"),oo("factory"),oo("configFields"),oo("partFields"),yo("apis",{}),yo("extraApis",{})]),zl=function(t){var n=Xr("Sketcher for "+t.name,Hl,t),e=et(n.apis,Ti),r=et(n.extraApis,function(t,n){return Si(t,n)});return $e({name:o(n.name),partFields:o([]),configFields:o(n.configFields),sketch:function(t){return function(t,n,e,r){var o=Fl(r);return e(Il(t,n,o,[],[]),o)}(n.name,n.configFields,n.factory,t)}},e,r)},jl=function(t){var n=Xr("Sketcher for "+t.name,Vl,t),e=bl(n.name,n.partFields),r=et(n.apis,Ti),i=et(n.extraApis,function(t,n){return Si(t,n)});return $e({name:o(n.name),partFields:o(n.partFields),configFields:o(n.configFields),sketch:function(t){return Ml(n.name,n.configFields,n.partFields,n.factory,t)},parts:o(e)},r,i)},Ul=function(t){return"input"===xe(t)&&"radio"!==Re(t,"type")||"textarea"===xe(t)},Wl=Object.freeze({getCurrent:function(t,n,e){return n.find(t)}}),Gl=[oo("find")],ql=qu({fields:Gl,name:"composing",apis:Wl}),$l=function(t,n,e,r){var o=t+n;return o>r?e:o<e?r:o},Xl=function(t,n,e){return t<=n?n:t>=e?e:t},Yl=function(t,n,e,r){var o=Ic(t.element(),"."+n.highlightClass);N(o,function(e){A(r,function(t){return t.element()===e})||(Gi(e,n.highlightClass),t.getSystem().getByDom(e).each(function(e){n.onDehighlight(t,e),Bo(e,Vn())}))})},Kl=function(t,n,e,r){Yl(t,n,0,[r]),Jl(t,n,e,r)||(Wi(r.element(),n.highlightClass),n.onHighlight(t,r),Bo(r,Hn()))},Jl=function(t,n,e,r){return qi(r.element(),n.highlightClass)},Zl=function(t,n,e,r){var o=Ic(t.element(),"."+n.itemClass);return b.from(o[r]).fold(function(){return gt.error("No element found with index "+r)},t.getSystem().getByDom)},Ql=function(t,n,e){return Su(t.element(),"."+n.itemClass).bind(function(n){return t.getSystem().getByDom(n).toOption()})},tf=function(t,n,e){var r=Ic(t.element(),"."+n.itemClass);return(r.length>0?b.some(r[r.length-1]):b.none()).bind(function(n){return t.getSystem().getByDom(n).toOption()})},nf=function(t,n,e,r){var o=Ic(t.element(),"."+n.itemClass);return H(o,function(t){return qi(t,n.highlightClass)}).bind(function(n){var e=$l(n,r,0,o.length-1);return t.getSystem().getByDom(o[e]).toOption()})},ef=function(t,n,e){var r=Ic(t.element(),"."+n.itemClass);return At(B(r,function(n){return t.getSystem().getByDom(n).toOption()}))},rf=Object.freeze({dehighlightAll:function(t,n,e){return Yl(t,n,0,[])},dehighlight:function(t,n,e,r){Jl(t,n,e,r)&&(Gi(r.element(),n.highlightClass),n.onDehighlight(t,r),Bo(r,Vn()))},highlight:Kl,highlightFirst:function(t,n,e){Ql(t,n,e).each(function(r){Kl(t,n,e,r)})},highlightLast:function(t,n,e){tf(t,n,e).each(function(r){Kl(t,n,e,r)})},highlightAt:function(t,n,e,r){Zl(t,n,e,r).fold(function(t){throw new Error(t)},function(r){Kl(t,n,e,r)})},highlightBy:function(t,n,e,r){var o=ef(t,n,e);L(o,r).each(function(r){Kl(t,n,e,r)})},isHighlighted:Jl,getHighlighted:function(t,n,e){return Su(t.element(),"."+n.highlightClass).bind(function(n){return t.getSystem().getByDom(n).toOption()})},getFirst:Ql,getLast:tf,getPrevious:function(t,n,e){return nf(t,n,0,-1)},getNext:function(t,n,e){return nf(t,n,0,1)},getCandidates:ef}),of=[oo("highlightClass"),oo("itemClass"),_u("onHighlight"),_u("onDehighlight")],uf=qu({fields:of,name:"highlighting",apis:rf}),af=function(t,n,e){var r=q(t.slice(0,n)),o=q(t.slice(n+1));return L(r.concat(o),e)},cf=function(t,n,e){var r=q(t.slice(0,n));return L(r,e)},sf=function(t,n,e){var r=t.slice(0,n),o=t.slice(n+1);return L(o.concat(r),e)},lf=function(t,n,e){var r=t.slice(n+1);return L(r,e)},ff=function(t){return function(n){var e=n.raw();return D(t,e.which)}},df=function(t){return function(n){return W(t,function(t){return t(n)})}},mf=function(t){return!0===t.raw().shiftKey},gf=function(t){return!0===t.raw().ctrlKey},pf=s(mf),hf=function(t,n){return{matches:t,classification:n}},vf=function(t,n){return L(t,function(t){return t.matches(n)}).map(function(t){return t.classification})},bf=function(t){t.dom().focus()},yf=function(n){var e=void 0!==n?n.dom():t.document;return b.from(e.activeElement).map(jn.fromDom)},wf=function(t){return yf(ue(t)).filter(function(n){return t.dom().contains(n.dom())})},xf=function(t,n,e){n.exists(function(t){return e.exists(function(n){return ie(n,t)})})||No(t,Mn(),{prevFocus:n,newFocus:e})},Sf=function(){var t=function(t){return wf(t.element())};return{get:t,set:function(n,e){var r=t(n);n.getSystem().triggerFocus(e,n.element());var o=t(n);xf(n,r,o)}}},Cf=function(){var t=function(t){return uf.getHighlighted(t).map(function(t){return t.element()})};return{get:t,set:function(e,r){var o=t(e);e.getSystem().getByDom(r).fold(n,function(t){uf.highlight(e,t)});var i=t(e);xf(e,o,i)}}};!function(t){t.OnFocusMode="onFocus",t.OnEnterOrSpaceMode="onEnterOrSpace",t.OnApiMode="onApi"}(Ll||(Ll={}));var Of,kf=function(t,n,e,r,o){var i=function(t,n,e,r,o){var i=e(t,n,r,o);return vf(i,n.event()).bind(function(e){return e(t,n,r,o)})},u={schema:function(){return t.concat([yo("focusManager",Sf()),wo("focusInside","onFocus",Ur(function(t){return D(["onFocus","onEnterOrSpace","onApi"],t)?gt.value(t):gt.error("Invalid value for focusInside")})),Pu("handler",u),Pu("state",n),Pu("sendFocusIn",o)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==Ll.OnFocusMode?b.none():o(t).map(function(e){return Yo(bn(),function(r,o){e(r,t,n),o.stop()})});return Go(u.toArray().concat([Yo(jt(),function(r,u){i(r,u,e,t,n).fold(function(){!function(e,r){var i=ff([32].concat([13]))(r.event());t.focusInside===Ll.OnEnterOrSpaceMode&&i&&Do(e,r)&&o(t).each(function(o){o(e,t,n),r.stop()})}(r,u)},function(t){u.stop()})}),Yo(Ut(),function(e,o){i(e,o,r,t,n).each(function(t){o.stop()})})]))}};return u},Tf=function(t){var n=[mo("onEscape"),mo("onEnter"),yo("selector",'[data-alloy-tabstop="true"]'),yo("firstTabstop",0),yo("useTabstopAt",o(!0)),mo("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind(function(t){return Cu(n,t)}).getOr(n);return fa(e)>0},r=function(t,n){(function(t,n){var r=Ic(t.element(),n.selector),o=M(r,function(t){return e(n,t)});return b.from(o[n.firstTabstop])})(t,n).each(function(e){n.focusManager.set(t,e)})},i=function(t,n,r,o,i){return i(n,r,function(t){return function(t,n){return e(t,n)&&t.useTabstopAt(n)}(o,t)}).fold(function(){return o.cyclic?b.some(!0):b.none()},function(n){return o.focusManager.set(t,n),b.some(!0)})},a=function(t,n,e,r){var o=Ic(t.element(),e.selector);return function(t,n){return n.focusManager.get(t).bind(function(t){return Cu(t,n.selector)})}(t,e).bind(function(n){return H(o,u(ie,n)).bind(function(n){return i(t,o,n,e,r)})})},c=o([hf(df([mf,ff([9])]),function(t,n,e,r){var o=e.cyclic?af:cf;return a(t,0,e,o)}),hf(ff([9]),function(t,n,e,r){var o=e.cyclic?sf:lf;return a(t,0,e,o)}),hf(ff([27]),function(t,n,e,r){return e.onEscape.bind(function(e){return e(t,n)})}),hf(df([pf,ff([13])]),function(t,n,e,r){return e.onEnter.bind(function(e){return e(t,n)})})]),s=o([]);return kf(n,Ei.init,c,s,function(){return b.some(r)})},Ef=Tf(Eo("cyclic",o(!1))),Df=Tf(Eo("cyclic",o(!0))),Af=function(t,n,e){return Ul(e)&&ff([32])(n.event())?b.none():function(t,n,e){return Io(t,e,Sn()),b.some(!0)}(t,0,e)},Rf=function(t,n){return b.some(!0)},Bf=[yo("execute",Af),yo("useSpace",!1),yo("useEnter",!0),yo("useControlEnter",!1),yo("useDown",!1)],Nf=function(t,n,e){return e.execute(t,n,t.element())},_f=kf(Bf,Ei.init,function(t,n,e,r){var o=e.useSpace&&!Ul(t.element())?[32]:[],i=e.useEnter?[13]:[],u=e.useDown?[40]:[],a=o.concat(i).concat(u);return[hf(ff(a),Nf)].concat(e.useControlEnter?[hf(df([gf,ff([13])]),Nf)]:[])},function(t,n,e,r){return e.useSpace&&!Ul(t.element())?[hf(ff([32]),Rf)]:[]},function(){return b.none()}),If=function(t){var n=Dt(b.none());return Di({readState:function(){return n.get().map(function(t){return{numRows:t.numRows(),numColumns:t.numColumns()}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set(b.some({numRows:o(t),numColumns:o(e)}))},getNumRows:function(){return n.get().map(function(t){return t.numRows()})},getNumColumns:function(){return n.get().map(function(t){return t.numColumns()})}})},Mf=Object.freeze({flatgrid:If,init:function(t){return t.state(t)}}),Ff=function(t){return function(n,e,r,o){var i=t(n.element());return Vf(i,n,e,r,o)}},Pf=function(t,n){var e=hc(t,n);return Ff(e)},Lf=function(t,n){var e=hc(n,t);return Ff(e)},Hf=function(t){return function(n,e,r,o){return Vf(t,n,e,r,o)}},Vf=function(t,n,e,r,o){return r.focusManager.get(n).bind(function(e){return t(n.element(),e,r,o)}).map(function(t){return r.focusManager.set(n,t),!0})},zf=Hf,jf=Hf,Uf=Hf,Wf=function(t){return!function(t){return t.offsetWidth<=0&&t.offsetHeight<=0}(t.dom())},Gf=qn(["index","candidates"],[]),qf=function(t,n,e){return $f(t,n,e,Wf)},$f=function(t,n,e,r){var o=u(ie,n),i=Ic(t,e);return function(t,n){return H(t,n).map(function(n){return Gf({index:n,candidates:t})})}(M(i,Wf),o)},Xf=function(t,n){return H(t,function(t){return ie(n,t)})},Yf=function(t,n,e,r){return r(Math.floor(n/e),n%e).bind(function(n){var r=n.row()*e+n.column();return r>=0&&r<t.length?b.some(t[r]):b.none()})},Kf=function(t,n,e,r,i){return Yf(t,n,r,function(n,u){var a=n===e-1?t.length-n*r:r,c=$l(u,i,0,a-1);return b.some({row:o(n),column:o(c)})})},Jf=function(t,n,e,r,i){return Yf(t,n,r,function(n,u){var a=$l(n,i,0,e-1),c=a===e-1?t.length-a*r:r,s=Xl(u,0,c-1);return b.some({row:o(a),column:o(s)})})},Zf=[oo("selector"),yo("execute",Af),Iu("onEscape"),yo("captureTab",!1),Hu()],Qf=function(t,n,e){Su(t.element(),n.selector).each(function(e){n.focusManager.set(t,e)})},td=function(t){return function(n,e,r,o){return qf(n,e,r.selector).bind(function(n){return t(n.candidates(),n.index(),o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))})}},nd=function(t,n,e,r){return e.captureTab?b.some(!0):b.none()},ed=td(function(t,n,e,r){return Kf(t,n,e,r,-1)}),rd=td(function(t,n,e,r){return Kf(t,n,e,r,1)}),od=td(function(t,n,e,r){return Jf(t,n,e,r,-1)}),id=td(function(t,n,e,r){return Jf(t,n,e,r,1)}),ud=o([hf(ff([37]),Pf(ed,rd)),hf(ff([39]),Lf(ed,rd)),hf(ff([38]),zf(od)),hf(ff([40]),jf(id)),hf(df([mf,ff([9])]),nd),hf(df([pf,ff([9])]),nd),hf(ff([27]),function(t,n,e,r){return e.onEscape(t,n)}),hf(ff([32].concat([13])),function(t,n,e,r){return function(t,n){return n.focusManager.get(t).bind(function(t){return Cu(t,n.selector)})}(t,e).bind(function(r){return e.execute(t,n,r)})})]),ad=o([hf(ff([32]),Rf)]),cd=kf(Zf,If,ud,ad,function(){return b.some(Qf)}),sd=function(t,n,e,r){var o=function(t,n,e){var i,u=$l(n,r,0,e.length-1);return u===t?b.none():(i=e[u],"button"===xe(i)&&"disabled"===Re(i,"disabled")?o(t,u,e):b.from(e[u]))};return qf(t,e,n).bind(function(t){var n=t.index(),e=t.candidates();return o(n,n,e)})},ld=[oo("selector"),yo("getInitial",b.none),yo("execute",Af),Iu("onEscape"),yo("executeOnMove",!1),yo("allowVertical",!0)],fd=function(t,n,e){return function(t,n){return n.focusManager.get(t).bind(function(t){return Cu(t,n.selector)})}(t,e).bind(function(r){return e.execute(t,n,r)})},dd=function(t,n){n.getInitial(t).orThunk(function(){return Su(t.element(),n.selector)}).each(function(e){n.focusManager.set(t,e)})},md=function(t,n,e){return sd(t,e.selector,n,-1)},gd=function(t,n,e){return sd(t,e.selector,n,1)},pd=function(t){return function(n,e,r){return t(n,e,r).bind(function(){return r.executeOnMove?fd(n,e,r):b.some(!0)})}},hd=function(t,n,e,r){return e.onEscape(t,n)},vd=o([hf(ff([32]),Rf)]),bd=kf(ld,Ei.init,function(t,n,e,r){var o=[37].concat(e.allowVertical?[38]:[]),i=[39].concat(e.allowVertical?[40]:[]);return[hf(ff(o),pd(Pf(md,gd))),hf(ff(i),pd(Lf(md,gd))),hf(ff([13]),fd),hf(ff([32]),fd),hf(ff([27]),hd)]},vd,function(){return b.some(dd)}),yd=qn(["rowIndex","columnIndex","cell"],[]),wd=function(t,n,e){return b.from(t[n]).bind(function(t){return b.from(t[e]).map(function(t){return yd({rowIndex:n,columnIndex:e,cell:t})})})},xd=function(t,n,e,r){var o=t[n].length,i=$l(e,r,0,o-1);return wd(t,n,i)},Sd=function(t,n,e,r){var o=$l(e,r,0,t.length-1),i=t[o].length,u=Xl(n,0,i-1);return wd(t,o,u)},Cd=function(t,n,e,r){var o=t[n].length,i=Xl(e+r,0,o-1);return wd(t,n,i)},Od=function(t,n,e,r){var o=Xl(e+r,0,t.length-1),i=t[o].length,u=Xl(n,0,i-1);return wd(t,o,u)},kd=[so("selectors",[oo("row"),oo("cell")]),yo("cycles",!0),yo("previousSelector",b.none),yo("execute",Af)],Td=function(t,n){n.previousSelector(t).orThunk(function(){var e=n.selectors;return Su(t.element(),e.cell)}).each(function(e){n.focusManager.set(t,e)})},Ed=function(t,n){return function(e,r,o){var i=o.cycles?t:n;return Cu(r,o.selectors.row).bind(function(t){var n=Ic(t,o.selectors.cell);return Xf(n,r).bind(function(n){var r=Ic(e,o.selectors.row);return Xf(r,t).bind(function(t){var e=function(t,n){return B(t,function(t){return Ic(t,n.selectors.cell)})}(r,o);return i(e,t,n).map(function(t){return t.cell()})})})})}},Dd=Ed(function(t,n,e){return xd(t,n,e,-1)},function(t,n,e){return Cd(t,n,e,-1)}),Ad=Ed(function(t,n,e){return xd(t,n,e,1)},function(t,n,e){return Cd(t,n,e,1)}),Rd=Ed(function(t,n,e){return Sd(t,e,n,-1)},function(t,n,e){return Od(t,e,n,-1)}),Bd=Ed(function(t,n,e){return Sd(t,e,n,1)},function(t,n,e){return Od(t,e,n,1)}),Nd=o([hf(ff([37]),Pf(Dd,Ad)),hf(ff([39]),Lf(Dd,Ad)),hf(ff([38]),zf(Rd)),hf(ff([40]),jf(Bd)),hf(ff([32].concat([13])),function(t,n,e){return wf(t.element()).bind(function(r){return e.execute(t,n,r)})})]),_d=o([hf(ff([32]),Rf)]),Id=kf(kd,Ei.init,Nd,_d,function(){return b.some(Td)}),Md=[oo("selector"),yo("execute",Af),yo("moveOnTab",!1)],Fd=function(t,n,e){return e.focusManager.get(t).bind(function(r){return e.execute(t,n,r)})},Pd=function(t,n){Su(t.element(),n.selector).each(function(e){n.focusManager.set(t,e)})},Ld=function(t,n,e){return sd(t,e.selector,n,-1)},Hd=function(t,n,e){return sd(t,e.selector,n,1)},Vd=o([hf(ff([38]),Uf(Ld)),hf(ff([40]),Uf(Hd)),hf(df([mf,ff([9])]),function(t,n,e){return e.moveOnTab?Uf(Ld)(t,n,e):b.none()}),hf(df([pf,ff([9])]),function(t,n,e){return e.moveOnTab?Uf(Hd)(t,n,e):b.none()}),hf(ff([13]),Fd),hf(ff([32]),Fd)]),zd=o([hf(ff([32]),Rf)]),jd=kf(Md,Ei.init,Vd,zd,function(){return b.some(Pd)}),Ud=[Iu("onSpace"),Iu("onEnter"),Iu("onShiftEnter"),Iu("onLeft"),Iu("onRight"),Iu("onTab"),Iu("onShiftTab"),Iu("onUp"),Iu("onDown"),Iu("onEscape"),yo("stopSpaceKeyup",!1),mo("focusIn")],Wd=kf(Ud,Ei.init,function(t,n,e){return[hf(ff([32]),e.onSpace),hf(df([pf,ff([13])]),e.onEnter),hf(df([mf,ff([13])]),e.onShiftEnter),hf(df([mf,ff([9])]),e.onShiftTab),hf(df([pf,ff([9])]),e.onTab),hf(ff([38]),e.onUp),hf(ff([40]),e.onDown),hf(ff([37]),e.onLeft),hf(ff([39]),e.onRight),hf(ff([32]),e.onSpace),hf(ff([27]),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[hf(ff([32]),Rf)]:[]},function(t){return t.focusIn}),Gd=Ef.schema(),qd=Df.schema(),$d=bd.schema(),Xd=cd.schema(),Yd=Id.schema(),Kd=_f.schema(),Jd=jd.schema(),Zd=Wd.schema(),Qd=Xu({branchKey:"mode",branches:Object.freeze({acyclic:Gd,cyclic:qd,flow:$d,flatgrid:Xd,matrix:Yd,execution:Kd,menu:Jd,special:Zd}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold(function(){t.getSystem().triggerFocus(t.element(),t.element())},function(r){r(t,n,e)})},setGridSize:function(n,e,r,o,i){Et(r,"setGridSize")?r.setGridSize(o,i):t.console.error("Layout does not support setGridSize")}},state:Mf}),tm=function(t,n,e,r){var o=t.getSystem().build(r);vs(t,o,e)},nm=function(t,n,e,r){var o=em(t,n);L(o,function(t){return ie(r.element(),t.element())}).each(ys)},em=function(t,n){return t.components()},rm=function(t,n,e,r,o){var i=em(t,n);return b.from(i[r]).map(function(e){return nm(t,n,0,e),o.each(function(n){tm(t,0,function(t,n){!function(t,n,e){fe(t,e).fold(function(){pe(t,n)},function(t){de(t,n)})}(t,n,r)},n)}),e})},om=qu({fields:[],name:"replacing",apis:Object.freeze({append:function(t,n,e,r){tm(t,0,pe,r)},prepend:function(t,n,e,r){tm(t,0,ge,r)},remove:nm,replaceAt:rm,replaceBy:function(t,n,e,r,o){var i=em(t,n);return H(i,r).bind(function(e){return rm(t,n,0,e,o)})},set:function(t,e,r,o){var i,u,a,c;ws(t),i=function(){var n=B(o,t.getSystem().build);N(n,function(n){hs(t,n)})},u=t.element(),a=ue(u),c=yf(a).bind(function(t){var n=function(n){return ie(t,n)};return n(u)?b.some(u):Uo(u,n)}),i(u),c.each(function(t){yf(a).filter(function(n){return ie(n,t)}).fold(function(){bf(t)},n)})},contents:em})}),im=function(t,n,e){n.store.manager.onLoad(t,n,e)},um=function(t,n,e){n.store.manager.onUnload(t,n,e)},am=Object.freeze({onLoad:im,onUnload:um,setValue:function(t,n,e,r){n.store.manager.setValue(t,n,e,r)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),cm=Object.freeze({events:function(t,n){var e=t.resetOnDom?[oi(function(e,r){im(e,t,n)}),ii(function(e,r){um(e,t,n)})]:[Vu(t,n,im)];return Go(e)}}),sm=function(){var t=Dt(null);return Di({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},lm=function(){var t=Dt({}),n=Dt({});return Di({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return Ct(t.get(),e).orThunk(function(){return Ct(n.get(),e)})},update:function(e){var r=t.get(),o=n.get(),i={},u={};N(e,function(t){i[t.value]=t,Ct(t,"meta").each(function(n){Ct(n,"text").each(function(n){u[n]=t})})}),t.set($e({},r,i)),n.set($e({},o,u))},clear:function(){t.set({}),n.set({})}})},fm=Object.freeze({memory:sm,dataset:lm,manual:function(){return Di({readState:function(){}})},init:function(t){return t.store.manager.state(t)}}),dm=function(t,n,e,r){var o=n.store;e.update([r]),o.setValue(t,r),n.onSetValue(t,r)},mm=[mo("initialValue"),oo("getFallbackEntry"),oo("getDataKey"),oo("setValue"),Pu("manager",{setValue:dm,getValue:function(t,n,e){var r=n.store,o=r.getDataKey(t);return e.lookup(o).fold(function(){return r.getFallbackEntry(o)},function(t){return t})},onLoad:function(t,n,e){n.store.initialValue.each(function(r){dm(t,n,e,r)})},onUnload:function(t,n,e){e.clear()},state:lm})],gm=[oo("getValue"),yo("setValue",n),mo("initialValue"),Pu("manager",{setValue:function(t,n,e,r){n.store.setValue(t,r),n.onSetValue(t,r)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each(function(e){n.store.setValue(t,e)})},onUnload:n,state:Ei.init})],pm=[mo("initialValue"),Pu("manager",{setValue:function(t,n,e,r){e.set(r),n.onSetValue(t,r)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:sm})],hm=[wo("store",{mode:"memory"},Kr("mode",{memory:pm,manual:gm,dataset:mm})),_u("onSetValue"),yo("resetOnDom",!1)],vm=qu({fields:hm,name:"representing",active:cm,apis:am,extra:{setValueFrom:function(t,n){var e=vm.getValue(n);vm.setValue(t,e)}},state:fm}),bm=function(t,n){n.ignore||(bf(t.element()),n.onFocus(t))},ym=Object.freeze({focus:bm,blur:function(t,n){n.ignore||function(t){t.dom().blur()}(t.element())},isFocused:function(t){return function(t){var n=ue(t).dom();return t.dom()===n.activeElement}(t.element())}}),wm=Object.freeze({exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return Ri(e)},events:function(t){return Go([Yo(bn(),function(n,e){bm(n,t),e.stop()})].concat(t.stopMousedown?[Yo(Mt(),function(t,n){n.event().prevent()})]:[]))}}),xm=[_u("onFocus"),yo("stopMousedown",!1),yo("ignore",!1)],Sm=qu({fields:xm,name:"focusing",active:wm,apis:ym}),Cm=function(t,n,e){var r=n.aria;r.update(t,r,e.get())},Om=function(t,n,e){n.toggleClass.each(function(n){e.get()?Wi(t.element(),n):Gi(t.element(),n)})},km=function(t,n,e){Dm(t,n,e,!e.get())},Tm=function(t,n,e){e.set(!0),Om(t,n,e),Cm(t,n,e)},Em=function(t,n,e){e.set(!1),Om(t,n,e),Cm(t,n,e)},Dm=function(t,n,e,r){(r?Tm:Em)(t,n,e)},Am=function(t,n,e){Dm(t,n,e,n.selected)},Rm=Object.freeze({onLoad:Am,toggle:km,isOn:function(t,n,e){return e.get()},on:Tm,off:Em,set:Dm}),Bm=Object.freeze({exhibit:function(t,n,e){return Ri({})},events:function(t,n){var e,r,o,i=(e=t,r=n,o=km,ai(function(t){o(t,e,r)})),u=Vu(t,n,Am);return Go(j([t.toggleOnExecute?[i]:[],[u]]))}}),Nm=function(t,n,e){De(t.element(),"aria-expanded",e)},_m=[yo("selected",!1),mo("toggleClass"),yo("toggleOnExecute",!0),wo("aria",{mode:"none"},Kr("mode",{pressed:[yo("syncWithExpanded",!1),Pu("update",function(t,n,e){De(t.element(),"aria-pressed",e),n.syncWithExpanded&&Nm(t,n,e)})],checked:[Pu("update",function(t,n,e){De(t.element(),"aria-checked",e)})],expanded:[Pu("update",Nm)],selected:[Pu("update",function(t,n,e){De(t.element(),"aria-selected",e)})],none:[Pu("update",n)]}))],Im=qu({fields:_m,name:"toggling",active:Bm,apis:Rm,state:(Of=!1,{init:function(){var t=Dt(Of);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(Of)},readState:function(){return t.get()}}}})}),Mm=function(t){(wf(t.element()).isNone()||Sm.isFocused(t))&&(Sm.isFocused(t)||Sm.focus(t),No(t,"alloy.item-hover",{item:t}))},Fm=function(t){No(t,"alloy.item-focus",{item:t})},Pm=o("alloy.item-hover"),Lm=o("alloy.item-focus"),Hm=function(t,n){return{key:t,value:{config:{},me:function(t,n){var e=Go(n);return qu({fields:[oo("enabled")],name:t,active:{events:o(e)}})}(t,n),configAsRaw:o({}),initialConfig:{},state:Ei}}},Vm=[oo("data"),oo("components"),oo("dom"),yo("hasSubmenu",!1),mo("toggling"),zs.field("itemBehaviours",[Im,Sm,Qd,vm]),yo("ignoreFocus",!1),yo("domModification",{}),Pu("builder",function(t){return{dom:t.dom,domModification:$e({},t.domModification,{attributes:$e({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes,{"aria-haspopup":t.hasSubmenu},t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:zs.augment(t.itemBehaviours,[t.toggling.fold(Im.revoke,function(t){return Im.config($e({aria:{mode:"checked"}},t))}),Sm.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Fm(t)}}),Qd.config({mode:"execution"}),vm.config({store:{mode:"memory",initialValue:t.data}}),Hm("item-type-events",[Yo(kn(),_o),ni(Mt()),Yo(Ht(),Mm),Yo(Cn(),Sm.focus)])]),components:t.components,eventOrder:t.eventOrder}}),yo("eventOrder",{})],zm=[oo("dom"),oo("components"),Pu("builder",function(t){return{dom:t.dom,components:t.components,events:Go([ei(Cn())])}})],jm=o([fl({name:"widget",overrides:function(t){return{behaviours:Wu([vm.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:function(){}}})])}}})]),Um=[oo("uid"),oo("data"),oo("components"),oo("dom"),yo("autofocus",!1),yo("ignoreFocus",!1),zs.field("widgetBehaviours",[vm,Sm,Qd]),yo("domModification",{}),Nl(jm()),Pu("builder",function(t){var n=Cl(0,t,jm()),e=Ol("item-widget",t,n.internals()),r=function(n){return kl(n,t,"widget").map(function(t){return Qd.focusIn(t),t})},o=function(n,e){return Ul(e.event().target())?b.none():t.autofocus?(e.setSource(n.element()),b.none()):b.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:Go([ai(function(t,n){r(t).each(function(t){n.stop()})}),Yo(Ht(),Mm),Yo(Cn(),function(n,e){t.autofocus?r(n):Sm.focus(n)})]),behaviours:zs.augment(t.widgetBehaviours,[vm.config({store:{mode:"memory",initialValue:t.data}}),Sm.config({ignore:t.ignoreFocus,onFocus:function(t){Fm(t)}}),Qd.config({mode:"special",focusIn:t.autofocus?function(t){r(t)}:Yu(),onLeft:o,onRight:o,onEscape:function(n,e){return Sm.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element()),b.none()):b.none():(Sm.focus(n),b.some(!0))}})])}})],Wm=Kr("type",{widget:Um,item:Vm,separator:zm}),Gm=o([gl({factory:{sketch:function(t){var n=Xr("menu.spec item",Wm,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:$e({},n,{uid:vi("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),qm=o([oo("value"),oo("items"),oo("dom"),oo("components"),yo("eventOrder",{}),Ls("menuBehaviours",[uf,vm,ql,Qd]),wo("movement",{mode:"menu",moveOnTab:!0},Kr("mode",{grid:[Hu(),Pu("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[Pu("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),oo("rowSelector")],menu:[yo("moveOnTab",!0),Pu("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),io("markers",Du()),yo("fakeFocus",!1),yo("focusManager",Sf()),_u("onHighlight")]),$m=o("alloy.menu-focus"),Xm=jl({name:"Menu",configFields:qm(),partFields:Gm(),factory:function(t,n,e,r){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Vs(t.menuBehaviours,[uf.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),vm.config({store:{mode:"memory",initialValue:t.value}}),ql.config({find:b.some}),Qd.config(t.movement.config(t,t.movement))]),events:Go([Yo(Lm(),function(t,n){var e=n.event();t.getSystem().getByDom(e.target()).each(function(e){uf.highlight(t,e),n.stop(),No(t,$m(),{menu:t,item:e})})}),Yo(Pm(),function(t,n){var e=n.event().item();uf.highlight(t,e)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Ym=function(t,n,e,r){return Ct(e,r).bind(function(r){return Ct(t,r).bind(function(r){var o=Ym(t,n,e,r);return b.some([r].concat(o))})}).getOr([])},Km=function(t,n){var e={};nt(t,function(t,n){N(t,function(t){e[t]=n})});var r=n,o=rt(n,function(t,n){return{k:t,v:n}}),i=et(o,function(t,n){return[n].concat(Ym(e,r,o,n))});return et(e,function(t){return Ct(i,t).getOr([t])})},Jm=function(){var t=Dt({}),n=Dt({}),e=Dt({}),r=Dt(b.none()),o=Dt({}),i=function(t){return Ct(n.get(),t)};return{setMenuBuilt:function(t,e){var r;n.set($e({},n.get(),((r={})[t]={type:"prepared",menu:e},r)))},setContents:function(i,u,a,c){r.set(b.some(i)),t.set(a),n.set(u),o.set(c);var s=Km(c,a);e.set(s)},expand:function(n){return Ct(t.get(),n).map(function(t){var r=Ct(e.get(),n).getOr([]);return[t].concat(r)})},refresh:function(t){return Ct(e.get(),t)},collapse:function(t){return Ct(e.get(),t).bind(function(t){return t.length>1?b.some(t.slice(1)):b.none()})},lookupMenu:i,otherMenus:function(t){var n=o.get();return $(Q(n),t)},getPrimary:function(){return r.get().bind(function(t){return i(t).bind(function(t){return"prepared"===t.type?b.some(t.menu):b.none()})})},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),r.set(b.none())},isClear:function(){return r.get().isNone()}}},Zm=o("collapse-item"),Qm=zl({name:"TieredMenu",configFields:[Fu("onExecute"),Fu("onEscape"),Mu("onOpenMenu"),Mu("onOpenSubmenu"),_u("onCollapseMenu"),yo("highlightImmediately",!0),so("data",[oo("primary"),oo("menus"),oo("expansions")]),yo("fakeFocus",!1),_u("onHighlight"),_u("onHover"),Ru(),oo("dom"),yo("navigateOnHover",!0),yo("stayInDom",!1),Ls("tmenuBehaviours",[Qd,uf,ql,om]),yo("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)}},factory:function(t,n){var e,r=Dt(b.none()),o=Jm(),i=function(n){var e=function(n,e,r){return et(r,function(r,o){var i=function(){return Xm.sketch($e({dom:r.dom},r,{value:o,items:r.items,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?Cf():Sf()}))};return o===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}})}(n,t.data.primary,t.data.menus),r=a(n);return o.setContents(t.data.primary,e,t.data.expansions,r),o.getPrimary()},u=function(t){return vm.getValue(t).value},a=function(n){return et(t.data.menus,function(t,n){return U(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})},c=function(t,n){uf.highlight(t,n),uf.getHighlighted(n).orThunk(function(){return uf.getFirst(n)}).each(function(n){Io(t,n.element(),Cn())})},s=function(t,n){return At(B(n,function(n){return t.lookupMenu(n).bind(function(t){return"prepared"===t.type?b.some(t.menu):b.none()})}))},l=function(n,e,r){var o=s(e,e.otherMenus(r));N(o,function(e){Xi(e.element(),[t.markers.backgroundMenu]),t.stayInDom||om.remove(n,e)})},f=function(n,e){var o=function(n){return r.get().getOrThunk(function(){var e={},o=Ic(n.element(),"."+t.markers.item),i=M(o,function(t){return"true"===Re(t,"aria-haspopup")});return N(i,function(t){n.getSystem().getByDom(t).each(function(t){var n=u(t);e[n]=t})}),r.set(b.some(e)),e})}(n);nt(o,function(t,n){var r=D(e,n);De(t.element(),"aria-expanded",r)})},d=function(n,e,r){return b.from(r[0]).bind(function(o){return e.lookupMenu(o).bind(function(o){if("notbuilt"===o.type)return b.none();var i=o.menu,u=s(e,r.slice(1));return N(u,function(n){Wi(n.element(),t.markers.backgroundMenu)}),Lo(i.element())||om.append(n,yu(i)),Xi(i.element(),[t.markers.backgroundMenu]),c(n,i),l(n,e,r),b.some(i)})})};!function(t){t[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent"}(e||(e={}));var m=function(n,r,i){void 0===i&&(i=e.HighlightSubmenu);var a=u(r);return o.expand(a).bind(function(u){return f(n,u),b.from(u[0]).bind(function(a){return o.lookupMenu(a).bind(function(c){var s=function(t,n,e){if("notbuilt"===e.type){var r=t.getSystem().build(e.nbMenu());return o.setMenuBuilt(n,r),r}return e.menu}(n,a,c);return Lo(s.element())||om.append(n,yu(s)),t.onOpenSubmenu(n,r,s),i===e.HighlightSubmenu?(uf.highlightFirst(s),d(n,o,u)):(uf.dehighlightAll(s),b.some(r))})})})},g=function(n,e){var r=u(e);return o.collapse(r).bind(function(r){return f(n,r),d(n,o,r).map(function(r){return t.onCollapseMenu(n,e,r),r})})},p=function(n){return function(e,r){return Cu(r.getSource(),"."+t.markers.item).bind(function(t){return e.getSystem().getByDom(t).toOption().bind(function(t){return n(e,t).map(function(){return!0})})})}},h=Go([Yo($m(),function(t,n){var e=n.event().menu();uf.highlight(t,e);var r=u(n.event().item());o.refresh(r).each(function(n){return l(t,o,n)})}),ai(function(n,r){var o=r.event().target();n.getSystem().getByDom(o).each(function(r){0===u(r).indexOf("collapse-item")&&g(n,r),m(n,r,e.HighlightSubmenu).fold(function(){t.onExecute(n,r)},function(){})})}),oi(function(n,e){i(n).each(function(e){om.append(n,yu(e)),t.onOpenMenu(n,e),t.highlightImmediately&&c(n,e)})})].concat(t.navigateOnHover?[Yo(Pm(),function(n,r){var i=r.event().item();!function(t,n){var e=u(n);o.refresh(e).bind(function(n){return f(t,n),d(t,o,n)})}(n,i),m(n,i,e.HighlightParent),t.onHover(n,i)})]:[])),v={collapseMenu:function(t){uf.getHighlighted(t).each(function(n){uf.getHighlighted(n).each(function(n){g(t,n)})})},highlightPrimary:function(t){o.getPrimary().each(function(n){c(t,n)})}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Vs(t.tmenuBehaviours,[Qd.config({mode:"special",onRight:p(function(t,n){return Ul(n.element())?b.none():m(t,n,e.HighlightSubmenu)}),onLeft:p(function(t,n){return Ul(n.element())?b.none():g(t,n)}),onEscape:p(function(n,e){return g(n,e).orThunk(function(){return t.onEscape(n,e).map(function(){return n})})}),focusIn:function(t,n){o.getPrimary().each(function(n){Io(t,n.element(),Cn())})}}),uf.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),ql.config({find:function(t){return uf.getHighlighted(t)}}),om.config({})]),eventOrder:t.eventOrder,apis:v,events:h}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Ot(t,n),expansions:{}}},collapseItem:function(t){return{value:Ge(Zm()),meta:{text:t}}}}}),tg=zl({name:"InlineView",configFields:[oo("lazySink"),_u("onShow"),_u("onHide"),vo("onEscape"),Ls("inlineBehaviours",[Ns,Zu]),bo("fireDismissalEventInstead",[yo("event",In())]),yo("getRelated",b.none),yo("eventOrder",b.none)],factory:function(t,n){var e=function(n,e,r,o){var i=t.lazySink(n).getOrDie();Ns.openWhileCloaked(n,r,function(){return ms.positionWithin(i,e,n,o)}),t.onShow(n)},r={setContent:function(t,n){Ns.open(t,n)},showAt:function(t,n,r){var o=b.none();e(t,n,r,o)},showWithin:e,showMenuAt:function(n,e,r){var o=function(t,n,e,r){var o=function(){return t.lazySink(n)};return Qm.sketch({dom:{tag:"div"},data:r.data,markers:r.menu.markers,onEscape:function(){return Ns.close(n),t.onEscape.map(function(t){return t(n)}),b.some(!0)},onExecute:function(){return b.some(!0)},onOpenMenu:function(t,n){ms.position(o().getOrDie(),e,n)},onOpenSubmenu:function(t,n,e){var r=o().getOrDie();ms.position(r,{anchor:"submenu",item:n},e)}})}(t,n,e,r);Ns.open(n,o),t.onShow(n)},hide:function(n){Ns.close(n),t.onHide(n)},getContent:function(t){return Ns.getState(t)},isOpen:Ns.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Vs(t.inlineBehaviours,[Ns.config({isPartOf:function(n,e,r){return ku(e,r)||function(n,e){return t.getRelated(n).exists(function(t){return ku(t,e)})}(n,r)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()}}),Fs($e({isExtraPart:o(!1)},t.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))]),eventOrder:t.eventOrder,apis:r}},apis:{showAt:function(t,n,e,r){t.showAt(n,e,r)},showWithin:function(t,n,e,r,o){t.showWithin(n,e,r,o)},showMenuAt:function(t,n,e,r){t.showMenuAt(n,e,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)}}}),ng=function(t){var n=function(t,n){n.stop(),_o(t)},e=hn.detect().deviceType.isTouch()?[Yo(On(),n)]:[Yo(qt(),n),Yo(Mt(),function(t,n){n.cut()})];return Go(j([t.map(function(t){return Yo(Sn(),function(n,e){t(n),e.stop()})}).toArray(),e]))},eg=zl({name:"Button",factory:function(t){var n=ng(t.action),e=t.dom.tag,r=function(n){return Ct(t.dom,"attributes").bind(function(t){return Ct(t,n)})};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:zs.augment(t.buttonBehaviours,[Sm.config({}),Qd.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var t=r("type").getOr("button"),n=r("role").map(function(t){return{role:t}}).getOr({});return $e({type:t},n)}return{role:r("role").getOr("button")}}()},eventOrder:t.eventOrder}},configFields:[yo("uid",void 0),oo("dom"),yo("components",[]),zs.field("buttonBehaviours",[Sm,Qd]),mo("action"),mo("role"),yo("eventOrder",{})]}),rg=function(t){var n=Pl(t)&&Et(t,"uid")?t.uid:vi("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).fold(b.none,b.some)},asSpec:function(){return $e({},t,{uid:n})}}},og=function(t){return b.from(t()["temporary-placeholder"]).getOr("!not found!")},ig=function(t,n){return b.from(n()[t]).getOrThunk(function(){return og(n)})},ug=function(t,n){return Rt(t,function(t){return b.from(n()[t])}).getOrThunk(function(){return og(n)})},ag={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},cg=zl({name:"Notification",factory:function(t){var n=rg({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:Wu([om.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},r=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},o=rg({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},r(0)],behaviours:Wu([om.config({})])}),i={updateProgress:function(t,n){t.getSystem().isConnected()&&o.getOpt(t).each(function(t){om.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},r(n)])})},updateText:function(t,e){if(t.getSystem().isConnected()){var r=n.get(t);om.set(r,[pu(e)])}}},u=j([t.icon.toArray(),t.level.toArray(),t.level.bind(function(t){return b.from(ag[t])}).toArray()]);return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:ug(u,t.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:Wu([om.config({})])}].concat(t.progress?[o.asSpec()]:[]).concat(eg.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:ig("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),apis:i}},configFields:[mo("level"),oo("progress"),oo("icon"),oo("onAction"),oo("text"),oo("iconProvider"),oo("translationProvider")],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),sg=tinymce.util.Tools.resolve("tinymce.util.Delay");function lg(t,n,e){var r=n.backstage;return{open:function(t,o){var i=function(){o(),tg.hide(a)},u=bu(cg.sketch({text:t.text,level:D(["success","error","warning","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:b.from(t.icon),onAction:i,iconProvider:r.shared.providers.icons,translationProvider:r.shared.providers.translate})),a=bu(tg.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}}));return e.add(a),t.timeout&&sg.setTimeout(function(){i()},t.timeout),{close:i,moveTo:function(t,n){tg.showAt(a,{anchor:"makeshift",x:t,y:n},yu(u))},moveRel:function(t,e){tg.showAt(a,n.backstage.shared.anchors.banner(),yu(u))},text:function(t){cg.updateText(u,t)},settings:t,getEl:function(){},progressBar:{value:function(t){cg.updateProgress(u,t)}}}},close:function(t){t.close()},reposition:function(n){!function(t){N(t,function(t){t.moveTo(0,0)})}(n),function(n){if(n.length>0){var e=n.slice(0,1)[0],r=function(t){return t.inline?t.getElement():t.getContentAreaContainer()}(t);e.moveRel(r,"tc-tc"),N(n,function(t,e){e>0&&t.moveRel(n[e-1].getEl(),"bc-tc")})}}(n)},getArgs:function(t){return t.settings}}}var fg,dg=function(n,e){var r=null;return{cancel:function(){null!==r&&(t.clearTimeout(r),r=null)},throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null!==r&&t.clearTimeout(r),r=t.setTimeout(function(){n.apply(null,o),r=null},e)}}},mg=/[\u00a0 \t\r\n]/,gg=function(t,n,e,r,o){return void 0===o&&(o=0),(i=t).collapsed&&3===i.startContainer.nodeType?function(t,n,e,r){var o;for(o=n-1;o>=0;o--){if(mg.test(t.charAt(o)))return b.none();if(t.charAt(o)===e)break}return-1===o||n-o<r?b.none():b.some(t.substring(o+1,n))}(e,r,n,o).map(function(n){var e=t.cloneRange();return e.setStart(t.startContainer,t.startOffset-n.length-1),e.setEnd(t.startContainer,t.startOffset),{text:n,rng:e}}):b.none();var i},pg=function(t,n){n.on("keypress",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){No(t,jt(),{raw:n})};n.on("keydown",function(n){var r=function(){return t.getView().bind(uf.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which?t.closeIfNecessary():32===n.which?t.closeIfNecessary():13===n.which?(r().each(_o),n.preventDefault()):40===n.which?(r().fold(function(){t.getView().each(uf.highlightFirst)},function(t){e(t,n)}),n.preventDefault()):37!==n.which&&38!==n.which&&39!==n.which||r().each(function(t){e(t,n),n.preventDefault()}))})},hg=tinymce.util.Tools.resolve("tinymce.util.Promise"),vg=function(t,n){return 0===t.startOffset||/\s/.test(n.charAt(t.startOffset-1))},bg=function(t,n){var e=n(),r=t.selection.getRng(),o=r.startContainer.nodeValue;return function(t,n,e){return Rt(e.triggerChars,function(e){return gg(t,e,n,t.startOffset).map(function(t){return{range:t.rng,text:t.text,triggerChar:e}})})}(r,o,e).map(function(t){var n=M(e.lookupByChar(t.triggerChar),function(n){return t.text.length>=n.minChars&&n.matches.getOr(vg)(t.range,o,t.text)});return{lookupData:hg.all(B(n,function(n){return n.fetch(t.text,n.maxResults).then(function(t){return{items:t,columns:n.columns,onAction:n.onAction}})})),triggerChar:t.triggerChar,range:t.range}})},yg=Br([Eo("type",function(){return"autocompleteitem"}),Eo("active",function(){return!1}),Eo("disabled",function(){return!1}),yo("meta",{}),uo("value"),ho("text"),ho("icon")]),wg=Br([uo("type"),uo("ch"),xo("minChars",1),yo("columns",1),xo("maxResults",10),vo("matches"),co("fetch"),co("onAction")]),xg=function(t){var n=t.ui.registry.getAll().popups,e=et(n,function(t){return(n=t,qr("Autocompleter",wg,n)).fold(function(t){throw new Error(Yr(t))},function(t){return t});var n}),r=function(t){var n={};return N(t,function(t){n[t]={}}),Q(n)}(ot(e,function(t){return t.ch})),o=ut(e);return{dataset:e,triggerChars:r,lookupByChar:function(t){return M(o,function(n){return n.ch===t})}}},Sg=[Oo("disabled",!1),ho("text"),ho("shortcut"),Pr("value","value",nr(function(){return Ge("menuitem-value")}),Jr()),yo("meta",{})],Cg=Br([uo("type"),ko("onSetup",function(){return n}),ko("onAction",n),ho("icon")].concat(Sg)),Og=Br([uo("type"),co("getSubmenuItems"),ko("onSetup",function(){return n}),ho("icon")].concat(Sg)),kg=Br([uo("type"),Oo("active",!1),ko("onSetup",function(){return n}),co("onAction")].concat(Sg)),Tg=Br([uo("type"),Oo("active",!1),ho("icon")].concat(Sg)),Eg=Br([uo("type"),ho("text")]),Dg=Br([uo("type"),ao("fancytype",["inserttable"]),ko("onAction",n)]),Ag=function(t,n,e){var r=Ic(t.element(),"."+e);if(r.length>0){var o=H(r,function(t){var e=t.dom().getBoundingClientRect().top,o=r[0].dom().getBoundingClientRect().top;return Math.abs(e-o)>n}).getOr(r.length);return b.some({numColumns:o,numRows:Math.ceil(r.length/o)})}return b.none()},Rg=function(t,n){return Wu([Hm(t,n)])},Bg=function(t){return Rg(Ge("unnamed-events"),t)},Ng=[oo("lazySink"),oo("tooltipDom"),yo("exclusive",!0),yo("tooltipComponents",[]),yo("delay",300),Co("mode","normal",["normal","follow-highlight"]),yo("anchor",function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:o([lc,sc,ic,ac,uc,cc]),onRtl:o([lc,sc,ic,ac,uc,cc])}}}),_u("onHide"),_u("onShow")],_g=Object.freeze({init:function(){var n=Dt(b.none()),e=Dt(b.none()),r=function(){n.get().each(function(n){t.clearTimeout(n)})},i=o("not-implemented");return Di({getTooltip:function(){return e.get()},isShowing:function(){return e.get().isSome()},setTooltip:function(t){e.set(b.some(t))},clearTooltip:function(){e.set(b.none())},clearTimer:r,resetTimer:function(e,o){r(),n.set(b.some(t.setTimeout(function(){e()},o)))},readState:i})}}),Ig=Ge("tooltip.exclusive"),Mg=Ge("tooltip.show"),Fg=Ge("tooltip.hide"),Pg=function(t,n,e){t.getSystem().broadcastOn([Ig],{})},Lg=Object.freeze({hideAllExclusive:Pg,setComponents:function(t,n,e,r){e.getTooltip().each(function(t){t.getSystem().isConnected()&&om.set(t,r)})}}),Hg=qu({fields:Ng,name:"tooltipping",active:Object.freeze({events:function(t,n){var e=function(e){n.getTooltip().each(function(r){ys(r),t.onHide(e,r),n.clearTooltip()}),n.clearTimer()};return Go(j([[Yo(Mg,function(e){n.resetTimer(function(){!function(e){if(!n.isShowing()){Pg(e);var r=t.lazySink(e).getOrDie(),o=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Go("normal"===t.mode?[Yo(Ht(),function(t){Bo(e,Mg)}),Yo(Pt(),function(t){Bo(e,Fg)})]:[]),behaviours:Wu([om.config({})])});n.setTooltip(o),hs(r,o),t.onShow(e,o),ms.position(r,t.anchor(e),o)}}(e)},t.delay)}),Yo(Fg,function(r){n.resetTimer(function(){e(r)},t.delay)}),Yo(xn(),function(t,n){D(n.channels(),Ig)&&e(t)}),ii(function(t){e(t)})],"normal"===t.mode?[Yo(Vt(),function(t){Bo(t,Mg)}),Yo(yn(),function(t){Bo(t,Fg)}),Yo(Ht(),function(t){Bo(t,Mg)}),Yo(Pt(),function(t){Bo(t,Fg)})]:[Yo(Hn(),function(t,n){Bo(t,Mg)}),Yo(Vn(),function(t){Bo(t,Fg)})]]))}}),state:_g,apis:Lg}),Vg=function(t){var n=jn.fromHtml(t),e=le(n),r=function(t){var n=void 0!==t.dom().attributes?t.dom().attributes:[];return P(n,function(t,n){var e;return"class"===n.name?t:$e({},t,((e={})[n.name]=n.value,e))},{})}(n),o=function(t){return Array.prototype.slice.call(t.dom().classList,0)}(n),i=0===e.length?{}:{innerHtml:ye(n)};return $e({tag:xe(n),classes:o,attributes:r},i)},zg=tinymce.util.Tools.resolve("tinymce.util.I18n"),jg="tox-menu-nav__js",Ug={normal:jg,color:"tox-swatch"},Wg="tox-collection__item--active",Gg=function(t){return Ct(Ug,t).getOr(jg)},qg=tinymce.util.Tools.resolve("tinymce.Env"),$g=function(t){var n=qg.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=t.split("+"),r=B(e,function(t){var e=t.toLowerCase().trim();return ct(n,e)?n[e]:t});return qg.mac?r.join(""):r.join("+")},Xg=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},Yg=function(t){return{dom:{tag:"div",classes:["tox-collection__item-label"]},components:[pu(zg.translate(t))]}},Kg=function(t,n){return{dom:{tag:"div",classes:["tox-collection__item-label"]},components:[{dom:{tag:t.tag,attributes:{style:t.styleAttr}},components:[pu(zg.translate(n))]}]}},Jg=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:$g(t)}}},Zg=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon","tox-collection__item-checkmark"],innerHtml:ig("checkmark",t)}}},Qg=function(t,n,e,r){void 0===r&&(r=b.none());var o=t.iconContent.map(function(t){return function(t,n,e){return b.from(n()[t]).or(e).getOrThunk(function(){return og(n)})}(t,n.icons,r)}),i=b.from(t.meta).fold(function(){return Yg},function(t){return ct(t,"style")?u(Kg,t.style):Yg});return"color"===t.presets?function(t,n,e,r){var o,i;return{dom:(o=e.getOr(""),i=t.map(function(t){return' title="'+r.translate(t)+'"'}).getOr(""),Vg("custom"===n?'<button class="tox-swatch tox-swatches__picker-btn"'+i+">"+o+"</button>":"remove"===n?'<div class="tox-swatch tox-swatch--remove"'+i+">"+o+"</div>":'<div class="tox-swatch" style="background-color: '+n+'" data-mce-color="'+n+'"'+i+"></div>")),optComponents:[]}}(t.ariaLabel,t.value,o,n):function(t,n,e,r){var o=e?t.checkMark.orThunk(function(){return n.or(b.some("")).map(Xg)}):b.none(),i=t.ariaLabel.map(function(t){return{attributes:{title:zg.translate(t)}}}).getOr({});return{dom:yt({tag:"div",classes:[jg,"tox-collection__item"]},i),optComponents:[o,t.textContent.map(r),t.shortcutContent.map(Jg),t.caret]}}(t,o,e,i)},tp=["input","button","textarea"],np=function(t,n,e){n.disabled&&ap(t,n,e)},ep=function(t){return D(tp,xe(t.element()))},rp=function(t){De(t.element(),"disabled","disabled")},op=function(t){Ne(t.element(),"disabled")},ip=function(t){De(t.element(),"aria-disabled","true")},up=function(t){De(t.element(),"aria-disabled","false")},ap=function(t,n,e){n.disableClass.each(function(n){Wi(t.element(),n)}),(ep(t)?rp:ip)(t)},cp=function(t,n,e){n.disableClass.each(function(n){Gi(t.element(),n)}),(ep(t)?op:up)(t)},sp=function(t){return ep(t)?function(t){return Be(t.element(),"disabled")}(t):function(t){return"true"===Re(t.element(),"aria-disabled")}(t)},lp=Object.freeze({enable:cp,disable:ap,isDisabled:sp,onLoad:np,set:function(t,n,e,r){(r?ap:cp)(t,n,e)}}),fp=Object.freeze({exhibit:function(t,n,e){return Ri({classes:n.disabled?n.disableClass.map(X).getOr([]):[]})},events:function(t,n){return Go([qo(Sn(),function(t,n){return sp(t)}),Vu(t,n,np)])}}),dp=[yo("disabled",!1),mo("disableClass")],mp=qu({fields:dp,name:"disabling",active:fp,apis:lp}),gp=function(t){return mp.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},pp=function(t){return mp.config({disabled:t})},hp=function(t){return mp.config({disabled:t,disableClass:"tox-tbtn--disabled"})},vp=function(t,n){var e=t.getApi(n);return function(t){t(e)}},bp=function(t,n){return oi(function(e){vp(t,e)(function(e){var r=t.onSetup(e);null!=r&&n.set(r)})})},yp=function(t,n){return ii(function(e){return vp(t,e)(n.get())})};!function(t){t[t.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",t[t.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(fg||(fg={}));var wp,xp=fg,Sp=function(t,n){return ai(function(e,r){vp(t,e)(t.onAction),t.triggersSubmenu||n!==xp.CLOSE_ON_EXECUTE||(Bo(e,En()),r.stop())})},Cp={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},Op=function(t){return U(t,function(t){return t.toArray()})},kp=function(t,e,r){var o=Dt(n);return{type:"item",dom:e.dom,components:Op(e.optComponents),data:t.data,eventOrder:Cp,hasSubmenu:t.triggersSubmenu,itemBehaviours:Wu([Hm("item-events",[Sp(t,r),bp(t,o),yp(t,o)]),gp(t.disabled),om.config({})].concat(t.itemBehaviours))}},Tp=function(t){return{value:t.value,meta:yt({text:t.text.getOr("")},t.meta)}},Ep=function(t,n){return at(t,"tooltipWorker").map(function(t){return[Hg.config({lazySink:n.getSink,tooltipDom:{tag:"div"},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t}},mode:"follow-highlight",onShow:function(n,e){t(function(t){Hg.setComponents(n,[hu({element:jn.fromDom(t)})])})}})]}).getOr([])},Dp=o(bl("item-widget",jm())),Ap=Ge("cell-over"),Rp=Ge("cell-execute"),Bp=function(t,n,e){var r,o=function(e){return No(e,Rp,{row:t,col:n})};return bu({dom:{tag:"div",attributes:(r={role:"button"},r["aria-labelledby"]=e,r)},behaviours:Wu([Hm("insert-table-picker-cell",[Yo(Ht(),Sm.focus),Yo(Sn(),o),Yo(kn(),o)]),Im.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Sm.config({onFocus:function(e){return No(e,Ap,{row:t,col:n})}})])})},Np=function(t,n,e){for(var r=[],o=0;o<n;o++){for(var i=[],u=0;u<e;u++)i.push(Bp(o,u,t));r.push(i)}return r},_p=function(t,n,e,r,o){for(var i=0;i<r;i++)for(var u=0;u<o;u++)Im.set(t[i][u],i<=n&&u<=e)},Ip=function(t){return U(t,function(t){return B(t,yu)})},Mp=function(t,n){return pu(n+1+"x"+(t+1))},Fp={inserttable:function(t){var n=Ge("size-label"),e=Np(n,10,10),r=rg({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[pu("0x0")],behaviours:Wu([om.config({})])});return{type:"widget",data:{value:Ge("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Dp().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Ip(e).concat(r.asSpec()),behaviours:Wu([Hm("insert-table-picker",[ti(Ap,function(t,n,o){var i=o.event().row(),u=o.event().col();_p(e,i,u,10,10),om.set(r.get(t),[Mp(i,u)])}),ti(Rp,function(n,e,r){t.onAction({numRows:r.event().row()+1,numColumns:r.event().col()+1}),Bo(n,En())})]),Qd.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}}},Pp=function(t,n,e,r,o,i,u){var a=Qg({presets:e,textContent:n?t.text:b.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:b.none(),checkMark:n?b.some(Zg(u.icons)):b.none(),caret:b.none(),value:t.value},u,!0);return bt(kp({data:Tp(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Im.set(t,n)},isActive:function(){return Im.isOn(t)},isDisabled:function(){return mp.isDisabled(t)},setDisabled:function(n){return mp.set(t,n)}}},onAction:function(n){return r(t.value)},onSetup:function(t){return t.setActive(o),function(){}},triggersSubmenu:!1,itemBehaviours:[]},a,i),{toggling:{toggleClass:"tox-collection__item--enabled",toggleOnExecute:!1,selected:t.active}})},Lp=function(t,n,e,r,o,i,u){void 0===u&&(u=!0);var a=Qg({presets:e,textContent:n?t.text:b.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:b.none(),checkMark:b.none(),caret:b.none(),value:t.value},i.providers,u,t.icon);return kp({data:Tp(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(n){return r(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:Ep(t.meta,i)},a,o)},Hp=function(t){var n=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:$e({tag:"div",classes:["tox-collection__item","tox-collection__group-heading"]},n),components:[]}},Vp=function(t,n,e,r){void 0===r&&(r=!0);var o=Qg({presets:"normal",iconContent:t.icon,textContent:t.text,ariaLabel:t.text,caret:b.none(),checkMark:b.none(),shortcutContent:t.shortcut},e,r);return kp({data:Tp(t),getApi:function(t){return{isDisabled:function(){return mp.isDisabled(t)},setDisabled:function(n){return mp.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n)},zp=function(t,e,r,o){void 0===o&&(o=!0);var i,u=(i=r.icons,{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:ig("chevron-right",i)}}),a=Qg({presets:"normal",iconContent:t.icon,textContent:t.text,ariaLabel:t.text,caret:b.some(u),checkMark:b.none(),shortcutContent:t.shortcut},r,o);return kp({data:Tp(t),getApi:function(t){return{isDisabled:function(){return mp.isDisabled(t)},setDisabled:function(n){return mp.set(t,n)}}},disabled:t.disabled,onAction:n,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,e)},jp=function(t,n,e){var r=Qg({iconContent:b.none(),textContent:t.text,ariaLabel:t.text,checkMark:b.some(Zg(e.icons)),caret:b.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,!0);return bt(kp({data:Tp(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Im.set(t,n)},isActive:function(){return Im.isOn(t)},isDisabled:function(){return mp.isDisabled(t)},setDisabled:function(n){return mp.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n),{toggling:{toggleClass:"tox-collection__item--enabled",toggleOnExecute:!1,selected:t.active}})},Up=function(t){return(n=Fp,e=t.fancytype,Object.prototype.hasOwnProperty.call(n,e)?b.some(n[e]):b.none()).map(function(n){return n(t)});var n,e},Wp=function(t){return"color"===t?"tox-swatches":"tox-menu"},Gp=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Wp(t),tieredMenu:"tox-tiered-menu"}},qp=function(t){var n=Gp(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Gg(t)}},$p=function(t,n,e){var r=Gp(e);return{tag:"div",classes:j([[r.menu,"tox-menu-"+n+"-column"],t?[r.hasIcons]:[]])}},Xp=[Xm.parts().items({})],Yp=function(t,n,e){var r=Gp(e);return{dom:{tag:"div",classes:j([[r.tieredMenu]])},markers:qp(e)}},Kp=function(t,n){var e=qp(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},Jp=function(t,n){return function(e){var r=R(e,n);return B(r,function(n){return{dom:t,components:n}})}},Zp=function(t,n,e){return void 0===e&&(e=!0),{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[Xm.parts().items({preprocess:function(e){return"auto"!==t&&t>1?Jp({tag:"div",classes:["tox-collection__group"]},t)(e):function(t,n){var e=[],r=[];return N(t,function(t,o){n(t,o)?(r.length>0&&e.push(r),r=[],ct(t.dom,"innerHtml")&&r.push(t)):r.push(t)}),r.length>0&&e.push(r),B(e,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})}(e,function(t,e){return"separator"===n[e].type})}})]}};!function(t){t[t.ContentFocus=0]="ContentFocus",t[t.UiFocus=1]="UiFocus"}(wp||(wp={}));var Qp=function(n){return t.console.error(Yr(n)),t.console.log(n),b.none()},th=function(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type},nh=function(t){return A(t,th)},eh=function(n,e,r,o){switch(void 0===o&&(o=!0),n.type){case"menuitem":return(i=n,qr("menuitem",Cg,i)).fold(Qp,function(t){return b.some(Vp(t,e,r,o))});case"nestedmenuitem":return function(t){return qr("nestedmenuitem",Og,t)}(n).fold(Qp,function(t){return b.some(zp(t,e,r,o))});case"togglemenuitem":return function(t){return qr("togglemenuitem",kg,t)}(n).fold(Qp,function(t){return b.some(jp(t,e,r))});case"separator":return function(t){return qr("separatormenuitem",Eg,t)}(n).fold(Qp,function(t){return b.some(Hp(t))});case"fancymenuitem":return function(t){return qr("fancymenuitem",Dg,t)}(n).fold(Qp,function(t){return Up(t)});default:return t.console.error("Unknown item in general menu",n),b.none()}var i},rh=function(t,n,e,r,o){var u;return"color"===o?{value:t,dom:(u=function(t){return{dom:{tag:"div",classes:["tox-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Xm.parts().items({preprocess:"auto"!==t?Jp({tag:"div",classes:["tox-swatches__row"]},t):i})]}]}}(r)).dom,components:u.components,items:e}:"normal"===o&&"auto"===r?{value:t,dom:(u=Zp(r,e)).dom,components:u.components,items:e}:"normal"===o&&1===r?{value:t,dom:(u=Zp(1,e)).dom,components:u.components,items:e}:"normal"===o?{value:t,dom:(u=Zp(r,e)).dom,components:u.components,items:e}:"listpreview"===o&&"auto"!==r?{value:t,dom:(u=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Xm.parts().items({preprocess:Jp({tag:"div",classes:["tox-collection__group"]},t)})]}}(r)).dom,components:u.components,items:e}:{value:t,dom:$p(n,r,o),components:Xp,items:e}},oh=function(t,n,e,r,o,i,u){return At(B(t,function(t){return"choiceitem"===t.type?(a=t,qr("choicemenuitem",Tg,a)).fold(Qp,function(a){return b.some(Pp(a,1===e,r,n,i(t.value),o,u))}):b.none();var a}))},ih=function(t,n,e,r,o){var i=1===e,u=!i||nh(t);return At(B(t,function(t){return(e=t,qr("Autocompleter.Item",yg,e)).fold(Qp,function(t){return b.some(Lp(t,i,"normal",n,r,o,u))});var e}))},uh=function(t,n,e,r,o,i,u,a){var c=nh(n),s=oh(n,e,r,"color"!==o?"normal":"color",i,u,a);return rh(t,c,s,r,o)},ah=function(t,n,e,r){var o=nh(n),i=At(B(n,function(t){var n=function(t){return eh(t,e,r,o)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(yt(t,{disabled:!0})):n(t)}));return rh(t,o,i,1,"normal")},ch=function(t){return Qm.singleData(t.value,t)},sh=function(n,e){var r=bu(tg.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],lazySink:e.getSink})),o=function(){return tg.isOpen(r)},i=function(){o()&&tg.hide(r)},u=Yt(function(){return xg(n)}),a=dg(function(o){(" "===o.key?b.none():bg(n,u)).fold(i,function(o){o.lookupData.then(function(u){var a=function(r,o){var u=Rt(o,function(t){return b.from(t.columns)}).getOr(1);return U(o,function(o){var a=o.items;return ih(a,function(e,u){var a=n.selection.getRng(),c=a.startContainer;gg(a,r,c.data,a.startOffset).fold(function(){return t.console.error("Lost context. Cursor probably moved")},function(t){var n=t.rng,r={hide:i};o.onAction(r,n,e,u)})},u,xp.BUBBLE_TO_SANDBOX,e)})}(o.triggerChar,u);if(a.length>0){var c=Rt(u,function(t){return b.from(t.columns)}).getOr(1);tg.showAt(r,{anchor:"selection",root:jn.fromDom(n.getBody()),getSelection:function(){return b.some({start:function(){return jn.fromDom(o.range.startContainer)},soffset:function(){return o.range.startOffset},finish:function(){return jn.fromDom(o.range.endContainer)},foffset:function(){return o.range.endOffset}})}},Xm.sketch(function(t,n,e,r){var o=e===wp.ContentFocus?Cf():Sf(),i=Kp(n,r),u=qp(r);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===wp.ContentFocus,focusManager:o,menuBehaviours:Bg("auto"!==n?[]:[oi(function(t,n){Ag(t,4,u.item).each(function(n){var e=n.numColumns,r=n.numRows;Qd.setGridSize(t,r,e)})})])}}(rh("autocompleter-value",!0,a,c,"normal"),c,wp.ContentFocus,"normal"))),tg.getContent(r).each(uf.highlightFirst)}else i()})})},50);pg({onKeypress:a,closeIfNecessary:i,isActive:o,getView:function(){return tg.getContent(r)}},n)},lh=function(t,n){return function(e){if(t(e)){var i=jn.fromDom(e.target),u=function(){e.stopPropagation()},a=function(){e.preventDefault()},c=r(a,u),s=function(t,n,e,r,i,u,a){return{target:o(t),x:o(n),y:o(e),stop:r,prevent:i,kill:u,raw:o(a)}}(i,e.clientX,e.clientY,u,a,c,e);n(s)}}},fh=function(t,n,e,r,o){var i=lh(e,r);return t.dom().addEventListener(n,i,o),{unbind:u(dh,t,n,i,o)}},dh=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},mh=o(!0),gh=function(t,n,e){return function(t,n,e,r){return fh(t,n,e,r,!1)}(t,n,mh,e)},ph=function(t,n,e){return function(t,n,e,r){return fh(t,n,e,r,!0)}(t,n,mh,e)},hh=function(t,n,e){return Cu(t,n,e).isSome()};function vh(n,e){var r=null;return{cancel:function(){null!==r&&(t.clearTimeout(r),r=null)},schedule:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r=t.setTimeout(function(){n.apply(null,o),r=null},e)}}}var bh=function(t){var n=t.raw();return void 0===n.touches||1!==n.touches.length?b.none():b.some(n.touches[0])},yh=function(t){var n=Dt(b.none()),e=vh(function(e){n.set(b.none()),t.triggerEvent(Tn(),e)},400),r=kt([{key:Nt(),value:function(t){return bh(t).each(function(r){e.cancel();var i={x:o(r.clientX),y:o(r.clientY),target:t.target};e.schedule(t),n.set(b.some(i))}),b.none()}},{key:_t(),value:function(t){return e.cancel(),bh(t).each(function(t){n.get().each(function(e){(function(t,n){var e=Math.abs(t.clientX-n.x()),r=Math.abs(t.clientY-n.y());return e>5||r>5})(t,e)&&n.set(b.none())})}),b.none()}},{key:It(),value:function(r){return e.cancel(),n.get().filter(function(t){return ie(t.target(),r.target())}).map(function(n){return t.triggerEvent(On(),r)})}}]);return{fireIfReady:function(t,n){return Ct(r,n).bind(function(n){return n(t)})}}},wh=hn.detect().browser.isFirefox(),xh=Rr([co("triggerEvent"),yo("stopBackspace",!0)]),Sh=function(n,e){var r=Xr("Getting GUI events settings",xh,e),o=hn.detect().deviceType.isTouch()?["touchstart","touchmove","touchend","gesturestart"]:["mousedown","mouseup","mouseover","mousemove","mouseout","click"],i=yh(r),u=B(o.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return gh(n,t,function(n){i.fireIfReady(n,t).each(function(t){t&&n.kill()}),r.triggerEvent(t,n)&&n.kill()})}),a=Dt(b.none()),c=gh(n,"paste",function(n){i.fireIfReady(n,"paste").each(function(t){t&&n.kill()}),r.triggerEvent("paste",n)&&n.kill(),a.set(b.some(t.setTimeout(function(){r.triggerEvent(wn(),n)},0)))}),s=gh(n,"keydown",function(t){r.triggerEvent("keydown",t)?t.kill():!0===r.stopBackspace&&function(t){return 8===t.raw().which&&!D(["input","textarea"],xe(t.target()))&&!hh(t.target(),'[contenteditable="true"]')}(t)&&t.prevent()}),l=function(t,n){return wh?ph(t,"focus",n):gh(t,"focusin",n)}(n,function(t){r.triggerEvent("focusin",t)&&t.kill()}),f=Dt(b.none()),d=function(t,n){return wh?ph(t,"blur",n):gh(t,"focusout",n)}(n,function(n){r.triggerEvent("focusout",n)&&n.kill(),f.set(b.some(t.setTimeout(function(){r.triggerEvent(yn(),n)},0)))});return{unbind:function(){N(u,function(t){t.unbind()}),s.unbind(),l.unbind(),d.unbind(),c.unbind(),a.get().each(t.clearTimeout),f.get().each(t.clearTimeout)}}},Ch=function(t,n){var e=Ct(t,"target").map(function(t){return t()}).getOr(n);return Dt(e)},Oh=pt([{stopped:[]},{resume:["element"]},{complete:[]}]),kh=function(t,n,e,r,i,u){var a=t(n,r),c=function(t,n){var e=Dt(!1),r=Dt(!1);return{stop:function(){e.set(!0)},cut:function(){r.set(!0)},isStopped:e.get,isCut:r.get,event:o(t),setSource:n.set,getSource:n.get}}(e,i);return a.fold(function(){return u.logEventNoHandlers(n,r),Oh.complete()},function(t){var e=t.descHandler();return Ni(e)(c),c.isStopped()?(u.logEventStopped(n,t.element(),e.purpose()),Oh.stopped()):c.isCut()?(u.logEventCut(n,t.element(),e.purpose()),Oh.complete()):ce(t.element()).fold(function(){return u.logNoParent(n,t.element(),e.purpose()),Oh.complete()},function(r){return u.logEventResponse(n,t.element(),e.purpose()),Oh.resume(r)})})},Th=function(t,n,e,r,o,i){return kh(t,n,e,r,o,i).fold(function(){return!0},function(r){return Th(t,n,e,r,o,i)},function(){return!1})},Eh=function(t,e,r){var i=function(t){var e=Dt(!1);return{stop:function(){e.set(!0)},cut:n,isStopped:e.get,isCut:o(!1),event:o(t),setSource:l("Cannot set source of a broadcasted event"),getSource:l("Cannot get source of a broadcasted event")}}(e);return N(t,function(t){var n=t.descHandler();Ni(n)(i)}),i.isStopped()},Dh=function(t,n,e,r,o){var i=Ch(e,r);return Th(t,n,e,r,i,o)},Ah=Un("element","descHandler"),Rh=function(t,n){return{id:o(t),descHandler:o(n)}};function Bh(){var t={};return{registerId:function(n,e,r){nt(r,function(r,o){var i=void 0!==t[o]?t[o]:{};i[e]=Bi(r,n),t[o]=i})},unregisterId:function(n){nt(t,function(t,e){t.hasOwnProperty(n)&&delete t[n]})},filterByType:function(n){return Ct(t,n).map(function(t){return ot(t,function(t,n){return Rh(n,t)})}).getOr([])},find:function(n,e,r){var o=xt(e)(t);return Wo(r,function(t){return function(t,n){return hi(n).fold(function(){return b.none()},function(e){var r=xt(e);return t.bind(r).map(function(t){return Ah(n,t)})})}(o,t)},n)}}}function Nh(){var t=Bh(),n={},e=function(e){hi(e.element()).each(function(e){delete n[e],t.unregisterId(e)})};return{find:function(n,e,r){return t.find(n,e,r)},filter:function(n){return t.filterByType(n)},register:function(r){var o=function(t){var n=t.element();return hi(n).fold(function(){return gi("uid-",t.element())},function(t){return t})}(r);Et(n,o)&&function(t,r){var o=n[r];if(o!==t)throw new Error('The tagId "'+r+'" is already used by: '+Me(o.element())+"\nCannot use it for: "+Me(t.element())+"\nThe conflicting element is"+(Lo(o.element())?" ":" not ")+"already in the DOM");e(t)}(r,o);var i=[r];t.registerId(i,o,r.events()),n[o]=r},unregister:e,getById:function(t){return xt(t)(n)}}}var _h,Ih=zl({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,r=Xe(n,["attributes"]);return{uid:t.uid,dom:$e({tag:"div",attributes:$e({role:"presentation"},e)},r),components:t.components,behaviours:Hs(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[yo("components",[]),Ls("containerBehaviours",[]),yo("events",{}),yo("domModification",{}),yo("eventOrder",{})]}),Mh=function(t){var e=function(n){return ce(t.element()).fold(function(){return!0},function(t){return ie(n,t)})},r=Nh(),i=function(t,n){return r.find(e,t,n)},u=Sh(t.element(),{triggerEvent:function(t,n){return Ve(t,n.target(),function(e){return function(t,n,e,r){var o=e.target();return Dh(t,n,e,o,r)}(i,t,n,e)})}}),a={debugInfo:o("real"),triggerEvent:function(t,n,e){Ve(t,n,function(r){Dh(i,t,e,n,r)})},triggerFocus:function(t,e){hi(t).fold(function(){bf(t)},function(r){Ve(bn(),t,function(r){!function(t,n,e,r,o){var i=Ch(e,r);kh(t,n,e,r,i,o)}(i,bn(),{originator:o(e),kill:n,prevent:n,target:o(t)},t,r)})})},triggerEscape:function(t,n){a.triggerEvent("keydown",t.element(),n.event())},getByUid:function(t){return h(t)},getByDom:function(t){return v(t)},build:bu,addToGui:function(t){l(t)},removeFromGui:function(t){f(t)},addToWorld:function(t){c(t)},removeFromWorld:function(t){s(t)},broadcast:function(t){m(t)},broadcastOn:function(t,n){g(t,n)},broadcastEvent:function(t,n){p(t,n)},isConnected:o(!0)},c=function(t){t.connect(a),ke(t.element())||(r.register(t),N(t.components(),c),a.triggerEvent(An(),t.element(),{target:o(t.element())}))},s=function(t){ke(t.element())||(N(t.components(),s),r.unregister(t)),t.disconnect()},l=function(n){hs(t,n)},f=function(t){ys(t)},d=function(t){var n=r.filter(xn());N(n,function(n){var e=n.descHandler();Ni(e)(t)})},m=function(t){d({universal:o(!0),data:o(t)})},g=function(t,n){d({universal:o(!1),channels:o(t),data:o(n)})},p=function(t,n){var e=r.filter(t);return Eh(e,n)},h=function(t){return r.getById(t).fold(function(){return gt.error(new Error('Could not find component with uid: "'+t+'" in system.'))},gt.value)},v=function(t){var n=hi(t).getOr("not found");return h(n)};return c(t),{root:o(t),element:t.element,destroy:function(){u.unbind(),be(t.element())},add:l,remove:f,getByUid:h,getByDom:v,addToWorld:c,removeFromWorld:s,broadcast:m,broadcastOn:g,broadcastEvent:p}},Fh=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ph=tinymce.util.Tools.resolve("tinymce.EditorManager"),Lh=function(t){return b.from(t.settings.min_width).filter(k)},Hh=function(t){return b.from(t.settings.min_height).filter(k)},Vh=function(t){var n=Q(t.settings),e=M(n,function(t){return/^toolbar([1-9])$/.test(t)}),r=B(e,function(n){return t.getParam(n,!1,"string")}),o=M(r,function(t){return"string"==typeof t});return o.length>0?b.some(o):b.none()};!function(t){t.default="",t.floating="floating",t.sliding="sliding"}(_h||(_h={}));var zh,jh=function(t){return t.getParam("toolbar_drawer","","string")},Uh=function(t){var n=function(t){return t.getParam("fixed_toolbar_container","","string")}(t),e=t.getParam("inline",!1,"boolean");return n.length>0&&e?Su(Ho(),n):b.none()},Wh=function(t){return t.getParam("inline",!1,"boolean")&&Uh(t).isSome()},Gh=Ge("form-component-change"),qh=Ge("form-close"),$h=Ge("form-cancel"),Xh=Ge("form-action"),Yh=Ge("form-submit"),Kh=Ge("form-block"),Jh=Ge("form-unblock"),Zh=Ge("form-tabchange"),Qh=Ge("form-resize"),tv=o([yo("prefix","form-field"),Ls("fieldBehaviours",[ql,vm])]),nv=o([ml({schema:[oo("dom")],name:"label"}),ml({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[oo("text")],name:"aria-descriptor"}),fl({factory:{sketch:function(t){var n=wt(t,["factory"]);return t.factory.sketch(n)}},schema:[oo("factory")],name:"field"})]),ev=jl({name:"FormField",configFields:tv(),partFields:nv(),factory:function(t,n,e,r){var o=Vs(t.fieldBehaviours,[ql.config({find:function(n){return kl(n,t,"field")}}),vm.config({store:{mode:"manual",getValue:function(t){return ql.getCurrent(t).bind(vm.getValue)},setValue:function(t,n){ql.getCurrent(t).each(function(t){vm.setValue(t,n)})}}})]),i=Go([oi(function(n,e){var r=El(n,t,["label","field","aria-descriptor"]);r.field().each(function(n){var e=Ge(t.prefix);r.label().each(function(t){De(t.element(),"for",e),De(n.element(),"id",e)}),r["aria-descriptor"]().each(function(e){var r=Ge(t.prefix);De(e.element(),"id",r),De(n.element(),"aria-describedby",r)})})})]),u={getField:function(n){return kl(n,t,"field")},getLabel:function(n){return kl(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:o,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),rv=Object.freeze({getCoupled:function(t,n,e,r){return e.getOrCreate(t,n,r)}}),ov=[io("others",Wr(gt.value,Jr()))],iv=qu({fields:ov,name:"coupling",apis:rv,state:Object.freeze({init:function(t){var n={},e=o({});return Di({readState:e,getOrCreate:function(t,e,r){var o=Q(e.others);if(o)return Ct(n,r).getOrThunk(function(){var o=Ct(e.others,r).getOrDie("No information found for coupled component: "+r)(t),i=t.getSystem().build(o);return n[r]=i,i});throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+xr(o,null,2))}})}})}),uv=Object.freeze({events:function(t,n){var e=t.stream.streams.setup(t,n);return Go([Yo(t.event,e),ii(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[Yo(t,function(){return n.cancel()})]}).getOr([])))}}),av=function(t){var n=Dt(null);return Di({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},cv=Object.freeze({throttle:av,init:function(t){return t.stream.streams.state(t)}}),sv=[io("stream",Kr("mode",{throttle:[oo("delay"),yo("stopEvent",!0),Pu("streams",{setup:function(t,n){var e=t.stream,r=dg(t.onStream,e.delay);return n.setTimer(r),function(t,n){r.throttle(t,n),e.stopEvent&&n.stop()}},state:av})]})),yo("event","input"),mo("cancelEvent"),Mu("onStream")],lv=qu({fields:sv,name:"streaming",active:uv,state:cv}),fv=function(n){var e=b.none(),r=[],o=function(t){i()?a(t):r.push(t)},i=function(){return e.isSome()},u=function(t){N(t,a)},a=function(n){e.each(function(e){t.setTimeout(function(){n(e)},0)})};return n(function(t){e=b.some(t),u(r),r=[]}),{get:o,map:function(t){return fv(function(n){o(function(e){n(t(e))})})},isReady:i}},dv={nu:fv,pure:function(t){return fv(function(n){n(t)})}},mv=function(n){var e=function(e){var r;n((r=e,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var o=this;t.setTimeout(function(){r.apply(o,n)},0)}))},r=function(){return dv.nu(e)};return{map:function(t){return mv(function(n){e(function(e){var r=t(e);n(r)})})},bind:function(t){return mv(function(n){e(function(e){t(e).get(n)})})},anonBind:function(t){return mv(function(n){e(function(e){t.get(n)})})},toLazy:r,toCached:function(){var t=null;return mv(function(n){null===t&&(t=r()),t.get(n)})},get:e}},gv={nu:mv,pure:function(t){return mv(function(n){n(t)})}},pv=o("sink"),hv=o(ml({name:pv(),overrides:o({dom:{tag:"div"},behaviours:Wu([ms.config({useFixed:!0})]),events:Go([ni(jt()),ni(Mt()),ni(qt())])})}));!function(t){t[t.HighlightFirst=0]="HighlightFirst",t[t.HighlightNone=1]="HighlightNone"}(zh||(zh={}));var vv=function(t,n){var e=t.getHotspot(n).getOr(n);return t.layouts.fold(function(){return{anchor:"hotspot",hotspot:e}},function(t){return{anchor:"hotspot",hotspot:e,layouts:t}})},bv=function(t,n,e,r,o,i,u){return function(t,n,e,r,o,i,u){var a=function(t,n,e){return(0,t.fetch)(e).map(n)}(t,n,r),c=Sv(r,t);return a.map(function(t){return t.bind(function(t){return b.from(Qm.sketch($e({},i.menu(),{uid:vi(""),data:t,highlightImmediately:u===zh.HighlightFirst,onOpenMenu:function(t,n){var r=c().getOrDie();ms.position(r,e,n),Ns.decloak(o)},onOpenSubmenu:function(t,n,e){var r=c().getOrDie();ms.position(r,{anchor:"submenu",item:n},e),Ns.decloak(o)},onEscape:function(){return Sm.focus(r),Ns.close(o),b.some(!0)}})))})})}(t,n,vv(t,e),e,r,o,u).map(function(t){return t.fold(function(){Ns.isOpen(r)&&Ns.close(r)},function(t){Ns.cloak(r),Ns.open(r,t),i(r)}),r})},yv=function(t,n,e,r,o,i,u){return Ns.close(r),gv.pure(r)},wv=function(t,n,e,r,o,i){var u=iv.getCoupled(e,"sandbox");return(Ns.isOpen(u)?yv:bv)(t,n,e,u,r,o,i)},xv=function(t,n,e){var r=ql.getCurrent(n).getOr(n),o=ca(t.element());e?Zi(r.element(),"min-width",o+"px"):function(t,n){aa.set(t,n)}(r.element(),o)},Sv=function(t,n){return t.getSystem().getByUid(n.uid+"-"+pv()).map(function(t){return function(){return gt.value(t)}}).getOrThunk(function(){return n.lazySink.fold(function(){return function(){return gt.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(n){return function(){return n(t)}})})},Cv=function(t,n,e){var r,i=(r=Ge("aria-owns"),{id:o(r),link:function(t){De(t,"aria-owns",r)},unlink:function(t){Ne(t,"aria-owns")}}),u=Sv(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:i.id()}},behaviours:zs.augment(t.sandboxBehaviours,[vm.config({store:{mode:"memory",initialValue:n}}),Ns.config({onOpen:function(r,o){var u=vv(t,n);i.link(n.element()),t.matchWidth&&xv(u.hotspot,o,t.useMinWidth),t.onOpen(u,r,o),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,o)},onClose:function(t,r){i.unlink(n.element()),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,r){return ku(e,r)||ku(n,r)},getAttachPoint:function(){return u().getOrDie()}}),ql.config({find:function(t){return Ns.getState(t).bind(function(t){return ql.getCurrent(t)})}}),Fs({isExtraPart:o(!1)})])}},Ov=function(t,n,e){var r=vm.getValue(e);vm.setValue(n,r),Tv(n)},kv=function(t,n){var e=t.element(),r=au(e),o=e.dom();"number"!==Re(e,"type")&&n(o,r)},Tv=function(t){kv(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},Ev=function(t,n,e){if(t.selectsOver){var r=vm.getValue(n),o=t.getDisplayText(r),i=vm.getValue(e);return 0===t.getDisplayText(i).indexOf(o)?b.some(function(){Ov(0,n,e),function(t,n){kv(t,function(t,e){return t.setSelectionRange(n,e.length)})}(n,o.length)}):b.none()}return b.none()},Dv=o([mo("data"),yo("inputAttributes",{}),yo("inputStyles",{}),yo("tag","input"),yo("inputClasses",[]),_u("onSetValue"),yo("styles",{}),yo("eventOrder",{}),Ls("inputBehaviours",[vm,Sm]),yo("selectOnFocus",!0)]),Av=function(t){return Wu([Sm.config({onFocus:!1===t.selectOnFocus?n:function(t){var n=t.element(),e=au(n);n.dom().setSelectionRange(0,e.length)}})])},Rv=function(t){return $e({},Av(t),Vs(t.inputBehaviours,[vm.config({store:{mode:"manual",initialValue:t.data.getOr(void 0),getValue:function(t){return au(t.element())},setValue:function(t,n){au(t.element())!==n&&cu(t.element(),n)}},onSetValue:t.onSetValue})]))},Bv=function(t){return{tag:t.tag,attributes:$e({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},Nv=o("alloy.typeahead.itemexecute"),_v=function(){return[yo("sandboxClasses",[]),zs.field("sandboxBehaviours",[ql,Zu,Ns,vm])]},Iv=o([mo("lazySink"),oo("fetch"),yo("minChars",5),yo("responseTime",1e3),_u("onOpen"),yo("getHotspot",b.some),yo("layouts",b.none()),yo("eventOrder",{}),To("model",{},[yo("getDisplayText",function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value}),yo("selectsOver",!0),yo("populateFromBrowse",!0)]),_u("onSetValue"),Iu("onExecute"),_u("onItemExecute"),yo("inputClasses",[]),yo("inputAttributes",{}),yo("inputStyles",{}),yo("matchWidth",!0),yo("useMinWidth",!1),yo("dismissOnBlur",!0),Bu(["openClass"]),mo("initialData"),Ls("typeaheadBehaviours",[Sm,vm,lv,Qd,Im,iv]),Eo("previewing",function(){return Dt(!0)})].concat(Dv()).concat(_v())),Mv=o([dl({schema:[Ru()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each(function(r){Ev(t.model,r,e).fold(function(){return uf.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(t.uid).each(function(n){t.model.populateFromBrowse&&Ov(t.model,n,e)}),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOption().map(function(t){return No(t,Nv(),{item:e}),!0})},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each(function(n){t.model.populateFromBrowse&&Ov(t.model,n,e)})}}}})]),Fv=jl({name:"Typeahead",configFields:Iv(),partFields:Mv(),factory:function(t,e,r,o){var u=function(e,r,i){t.previewing.set(!1);var u=iv.getCoupled(e,"sandbox");Ns.isOpen(u)?ql.getCurrent(u).each(function(t){uf.getHighlighted(t).fold(function(){i(t)},function(){Fo(u,t.element(),"keydown",r)})}):bv(t,c(e),e,u,o,function(t){ql.getCurrent(t).each(i)},zh.HighlightFirst).get(n)},a=Av(t),c=function(t){return function(n){return n.map(function(n){var e=ut(n.menus),r=U(e,function(t){return M(t.items,function(t){return"item"===t.type})});return vm.getState(t).update(B(r,function(t){return t.data})),n})}},s=[Sm.config({}),vm.config({onSetValue:t.onSetValue,store:$e({mode:"dataset",getDataKey:function(t){return au(t.element())},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){cu(n.element(),t.model.getDisplayText(e))}},t.initialData.map(function(t){return Ot("initialValue",t)}).getOr({}))}),lv.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(e,r){var i=iv.getCoupled(e,"sandbox");if(Sm.isFocused(e)&&au(e.element()).length>=t.minChars){var u=ql.getCurrent(i).bind(function(t){return uf.getHighlighted(t).map(vm.getValue)});t.previewing.set(!0),bv(t,c(e),e,i,o,function(n){ql.getCurrent(i).each(function(n){u.fold(function(){t.model.selectsOver&&uf.highlightFirst(n)},function(t){uf.highlightBy(n,function(n){return vm.getValue(n).value===t.value}),uf.getHighlighted(n).orThunk(function(){return uf.highlightFirst(n),b.none()})})})},zh.HighlightFirst).get(n)}},cancelEvent:Dn()}),Qd.config({mode:"special",onDown:function(t,n){return u(t,n,uf.highlightFirst),b.some(!0)},onEscape:function(t){var n=iv.getCoupled(t,"sandbox");return Ns.isOpen(n)?(Ns.close(n),b.some(!0)):b.none()},onUp:function(t,n){return u(t,n,uf.highlightLast),b.some(!0)},onEnter:function(n){var e=iv.getCoupled(n,"sandbox"),r=Ns.isOpen(e);if(r&&!t.previewing.get())return ql.getCurrent(e).bind(function(t){return uf.getHighlighted(t)}).map(function(t){return No(n,Nv(),{item:t}),!0});var o=vm.getValue(n);return Bo(n,Dn()),t.onExecute(e,n,o),r&&Ns.close(e),b.some(!0)}}),Im.config({toggleClass:t.markers.openClass,aria:{mode:"pressed",syncWithExpanded:!0}}),iv.config({others:{sandbox:function(n){return Cv(t,n,{onOpen:i,onClose:i})}}}),Hm("typeaheadevents",[ai(function(e){var r=n;wv(t,c(e),e,o,r,zh.HighlightFirst).get(n)}),Yo(Nv(),function(n,e){var r=iv.getCoupled(n,"sandbox");Ov(t.model,n,e.event().item()),Bo(n,Dn()),t.onItemExecute(n,r,e.event().item(),vm.getValue(n)),Ns.close(r),Tv(n)})].concat(t.dismissOnBlur?[Yo(yn(),function(t){var n=iv.getCoupled(t,"sandbox");wf(n.element()).isNone()&&Ns.close(n)})]:[]))];return{uid:t.uid,dom:Bv(t),behaviours:$e({},a,Vs(t.typeaheadBehaviours,s)),eventOrder:t.eventOrder}}}),Pv=function(t,n,e){var r=Hv(t,n,e);return ev.sketch(r)},Lv=function(t,n){return Pv(t,n,[])},Hv=function(t,n,e){return{dom:Vv(e),components:t.toArray().concat([n])}},Vv=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},zv=function(t,n){return ev.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},jv=function(t){return"separator"===t.type},Uv={type:"separator"},Wv=function(t,n){var e=P(t,function(t,e){return function(t){return w(t)}(e)?""===e?t:"|"===e?t.length>0&&!jv(t[t.length-1])?t.concat([Uv]):t:ct(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])},[]);return e.length>0&&jv(e[e.length-1])&&e.pop(),e},Gv=function(t,n){return function(t){return ct(t,"getSubmenuItems")}(t)?function(t,n){var e=t.getSubmenuItems(),r=qv(e,n);return{item:t,menus:bt(r.menus,Ot(t.value,r.items)),expansions:bt(r.expansions,Ot(t.value,t.value))}}(t,n):{item:t,menus:{},expansions:{}}},qv=function(t,n){var e=Wv(w(t)?t.split(" "):t,n);return F(e,function(t,e){var r=function(t){if(jv(t))return t;var n=Ct(t,"value").getOrThunk(function(){return Ge("generated-menu-item")});return bt({value:n},t)}(e),o=Gv(r,n);return{menus:bt(t.menus,o.menus),items:[o.item].concat(t.items),expansions:bt(t.expansions,o.expansions)}},{menus:{},expansions:{},items:[]})},$v=function(t,n,e){var r=Ge("primary-menu"),o=qv(t,e.menuItems());if(0===o.items.length)return b.none();var i=ah(r,o.items,n,e),u=et(o.menus,function(t,r){return ah(r,t,n,e)}),a=bt(u,Ot(r,i));return b.from(Qm.tieredData(r,a,o.expansions))},Xv=zl({name:"Input",configFields:Dv(),factory:function(t,n){return{uid:t.uid,dom:Bv(t),components:[],behaviours:Rv(t),eventOrder:t.eventOrder}}}),Yv=hn.detect().browser.isFirefox(),Kv={position:"absolute",left:"-9999px"},Jv=function(n,e,r){var o=function(t,n){var e=jn.fromTag("span",t.dom());De(e,"role","presentation");var r=jn.fromText(n,t.dom());return pe(e,r),e}(ue(e),r);Yv&&function(t,n){var e=Ge("ephox-alloy-aria-voice");De(n,"id",e),De(t,"aria-describedby",e)}(e,o),Ae(o,n(r)),Qi(o,Kv),pe(e,o),t.setTimeout(function(){Ne(o,"aria-live"),be(o)},1e3)},Zv=function(t){return{"aria-live":"assertive","aria-atomic":"true",role:"alert"}},Qv=["input","textarea"],tb=function(t){var n=xe(t);return D(Qv,n)},nb=function(t,n){var e=n.getRoot(t).getOr(t.element());Gi(e,n.invalidClass),n.notify.each(function(n){tb(t.element())&&Ne(e,"title"),n.getContainer(t).each(function(t){we(t,n.validHtml)}),n.onValid(t)})},eb=function(t,n,e,r){var o=n.getRoot(t).getOr(t.element());Wi(o,n.invalidClass),n.notify.each(function(n){tb(t.element())&&De(t.element(),"title",r),function(t,n){Jv(Zv,t,n)}(Ho(),r),n.getContainer(t).each(function(t){we(t,r)}),n.onInvalid(t,r)})},rb=function(t,n,e){return n.validator.fold(function(){return gv.pure(gt.value(!0))},function(n){return n.validate(t)})},ob=function(t,n,e){return n.notify.each(function(n){n.onValidate(t)}),rb(t,n).map(function(e){return t.getSystem().isConnected()?e.fold(function(e){return eb(t,n,0,e),gt.error(e)},function(e){return nb(t,n),gt.value(e)}):gt.error("No longer in system")})},ib=Object.freeze({markValid:nb,markInvalid:eb,query:rb,run:ob,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element());return qi(e,n.invalidClass)}}),ub=Object.freeze({events:function(t,e){return t.validator.map(function(e){return Go([Yo(e.onEvent,function(n){ob(n,t).get(i)})].concat(e.validateOnLoad?[oi(function(e){ob(e,t).get(n)})]:[]))}).getOr({})}}),ab=[oo("invalidClass"),yo("getRoot",b.none),bo("notify",[yo("aria","alert"),yo("getContainer",b.none),yo("validHtml",""),_u("onValid"),_u("onInvalid"),_u("onValidate")]),bo("validator",[oo("validate"),yo("onEvent","input"),yo("validateOnLoad",!0)])],cb=qu({fields:ab,name:"invalidating",active:ub,apis:ib,extra:{validation:function(t){return function(n){var e=vm.getValue(n);return gv.pure(t(e))}}}}),sb=Object.freeze({exhibit:function(t,n){return Ri({attributes:kt([{key:n.tabAttr,value:"true"}])})}}),lb=[yo("tabAttr","data-alloy-tabstop")],fb=qu({fields:lb,name:"tabstopping",active:sb}),db=function(t){return{value:o(t)}},mb=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,gb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,pb=function(t){return mb.test(t)||gb.test(t)},hb=function(t){var n=function(t){var n=t.value().replace(mb,function(t,n,e,r){return n+n+e+e+r+r});return{value:o(n)}}(t),e=gb.exec(n.value());return null===e?["FFFFFF","FF","FF","FF"]:e},vb=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},bb=function(t){var n=vb(t.red())+vb(t.green())+vb(t.blue());return db(n)},yb=Math.min,wb=Math.max,xb=Math.round,Sb=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Cb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Ob=function(t,n,e,r){return{red:o(t),green:o(n),blue:o(e),alpha:o(r)}},kb=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},Tb=function(t){var n,e,r,o=(t.hue()||0)%360,i=t.saturation()/100,u=t.value()/100;if(i=wb(0,yb(i,1)),u=wb(0,yb(u,1)),0===i)return n=e=r=xb(255*u),Ob(n,e,r,1);var a=o/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,r=0;break;case 1:n=s,e=c,r=0;break;case 2:n=0,e=c,r=s;break;case 3:n=0,e=s,r=c;break;case 4:n=s,e=0,r=c;break;case 5:n=c,e=0,r=s;break;default:n=e=r=0}return n=xb(255*(n+l)),e=xb(255*(e+l)),r=xb(255*(r+l)),Ob(n,e,r,1)},Eb=function(t){var n=hb(t),e=parseInt(n[1],16),r=parseInt(n[2],16),o=parseInt(n[3],16);return Ob(e,r,o,1)},Db=function(t,n,e,r){var o=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(r);return Ob(o,i,u,a)},Ab=function(t){return"rgba("+t.red()+","+t.green()+","+t.blue()+","+t.alpha()+")"},Rb=o(Ob(255,0,0,1)),Bb=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Nb="tinymce-custom-colors",_b="choiceitem",Ib=[{type:_b,text:"Turquoise",value:"#18BC9B"},{type:_b,text:"Green",value:"#2FCC71"},{type:_b,text:"Blue",value:"#3598DB"},{type:_b,text:"Purple",value:"#9B59B6"},{type:_b,text:"Navy Blue",value:"#34495E"},{type:_b,text:"Dark Turquoise",value:"#18A085"},{type:_b,text:"Dark Green",value:"#27AE60"},{type:_b,text:"Medium Blue",value:"#2880B9"},{type:_b,text:"Medium Purple",value:"#8E44AD"},{type:_b,text:"Midnight Blue",value:"#2B3E50"},{type:_b,text:"Yellow",value:"#F1C40F"},{type:_b,text:"Orange",value:"#E67E23"},{type:_b,text:"Red",value:"#E74C3C"},{type:_b,text:"Light Gray",value:"#ECF0F1"},{type:_b,text:"Gray",value:"#95A5A6"},{type:_b,text:"Dark Yellow",value:"#F29D12"},{type:_b,text:"Dark Orange",value:"#D35400"},{type:_b,text:"Dark Red",value:"#E74C3C"},{type:_b,text:"Medium Gray",value:"#BDC3C7"},{type:_b,text:"Dark Gray",value:"#7E8C8D"},{type:_b,text:"Black",value:"#000000"},{type:_b,text:"White",value:"#ffffff"}],Mb=function(t){void 0===t&&(t=10);var n,e=Bb.getItem(Nb),r=w(e)?JSON.parse(e):[],o=t-(n=r).length<0?n.slice(0,t):n,i=function(t){o.splice(t,1)};return{add:function(n){E(o,n).each(i),o.unshift(n),o.length>t&&o.pop(),Bb.setItem(Nb,JSON.stringify(o))},state:function(){return o.slice(0)}}}(10),Fb=function(t){var n,e=[];for(n=0;n<t.length;n+=2)e.push({text:t[n+1],value:"#"+t[n],type:"choiceitem"});return e},Pb=function(t){return t.getParam("color_map")},Lb=function(t,n){return t.getParam("color_cols",n,"number")},Hb=function(t){return!1!==t.getParam("custom_colors")},Vb=function(t){var n=Pb(t);return void 0!==n?Fb(n):Ib},zb=function(){return B(Mb.state(),function(t){return{type:_b,text:t,value:t}})},jb=function(t){Mb.add(t)},Ub=function(t,n){var e;return t.dom.getParents(t.selection.getStart(),function(t){var r;(r=t.style["forecolor"===n?"color":"background-color"])&&(e=e||r)}),e},Wb=function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))},Gb=function(t){var n=Vb(t),e=Wb(n.length);return Lb(t,e)},qb=function(t,n,e,r){"custom"===e?Kb(t)(function(e){e.each(function(e){jb(e),t.execCommand("mceApplyTextcolor",n,e),r(e)})},"#000000"):"remove"===e?(r(""),t.execCommand("mceRemoveTextcolor",n)):(r(e),t.execCommand("mceApplyTextcolor",n,e))},$b=function(t,n){return function(e){e(t.concat(zb().concat(function(t){var n={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[n,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[n]}(n))))}},Xb=function(t,n,e){var r,o;r="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",o=e,t.setIconFill(r,o),t.setIconStroke(r,o)},Yb=function(t,n,e,r,o){t.ui.registry.addSplitButton(n,{tooltip:r,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){return b.from(Ub(t,e)).bind(function(t){return function(t){if("transparent"===t)return b.some(Ob(0,0,0,0));var n=Sb.exec(t);if(null!==n)return b.some(Db(n[1],n[2],n[3],"1"));var e=Cb.exec(t);return null!==e?b.some(Db(e[1],e[2],e[3],e[4])):b.none()}(t).map(function(t){var e=bb(t).value();return sn(n.toLowerCase(),e)})}).getOr(!1)},columns:Gb(t),fetch:$b(Vb(t),Hb(t)),onAction:function(n){null!==o.get()&&qb(t,e,o.get(),function(){})},onItemAction:function(r,i){qb(t,e,i,function(t){o.set(t),Xb(r,n,t)})},onSetup:function(t){return null!==o.get()&&Xb(t,n,o.get()),function(){}}})},Kb=function(t){return function(n,e){var r={colorpicker:e},o=function(t){return function(n){var e=n.getData();t(b.from(e.colorpicker)),n.close()}}(n);t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:o,onClose:function(){},onCancel:function(){n(b.none())}})}},Jb={register:function(t){!function(t){t.addCommand("mceApplyTextcolor",function(n,e){!function(t,n,e){t.undoManager.transact(function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()})}(t,n,e)}),t.addCommand("mceRemoveTextcolor",function(n){!function(t,n){t.undoManager.transact(function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()})}(t,n)})}(t);var n=Dt(null),e=Dt(null);Yb(t,"forecolor","forecolor","Text color",n),Yb(t,"backcolor","hilitecolor","Background color",e)},getFetch:$b,colorPickerDialog:Kb,getCurrentColor:Ub,getColorCols:Gb,calcCols:Wb},Zb=o([oo("dom"),oo("fetch"),_u("onOpen"),Iu("onExecute"),yo("getHotspot",b.some),yo("layouts",b.none()),Ls("dropdownBehaviours",[Im,iv,Qd,Sm]),oo("toggleClass"),yo("eventOrder",{}),mo("lazySink"),yo("matchWidth",!1),yo("useMinWidth",!1),mo("role")].concat(_v())),Qb=o([dl({schema:[Ru()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),hv()]),ty=jl({name:"Dropdown",configFields:Zb(),partFields:Qb(),factory:function(t,e,r,o){var i,u,a=function(t){Ns.getState(t).each(function(t){Qm.highlightPrimary(t)})},c={expand:function(e){Im.isOn(e)||wv(t,function(t){return t},e,o,n,zh.HighlightNone).get(n)},open:function(e){Im.isOn(e)||wv(t,function(t){return t},e,o,n,zh.HighlightFirst).get(n)},isOpen:Im.isOn,close:function(e){Im.isOn(e)&&wv(t,function(t){return t},e,o,n,zh.HighlightFirst).get(n)}},s=function(t,n){return _o(t),b.some(!0)};return{uid:t.uid,dom:t.dom,components:e,behaviours:Vs(t.dropdownBehaviours,[Im.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),iv.config({others:{sandbox:function(n){return Cv(t,n,{onOpen:function(){Im.on(n)},onClose:function(){Im.off(n)}})}}}),Qd.config({mode:"special",onSpace:s,onEnter:s,onDown:function(t,n){if(ty.isOpen(t)){var e=iv.getCoupled(t,"sandbox");a(e)}else ty.open(t);return b.some(!0)},onEscape:function(t,n){return ty.isOpen(t)?(ty.close(t),b.some(!0)):b.none()}}),Sm.config({})]),events:ng(b.some(function(e){wv(t,function(t){return t},e,o,a,zh.HighlightFirst).get(n)})),eventOrder:$e({},t.eventOrder,(i={},i[Sn()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:c,domModification:{attributes:$e({"aria-haspopup":"true"},t.role.fold(function(){return{}},function(t){return{role:t}}),"button"===t.dom.tag?{type:(u="type",Ct(t.dom,"attributes").bind(function(t){return Ct(t,u)})).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)}}}),ny=Object.freeze({events:function(t){return Go([qo(Xt(),o(!0))])},exhibit:function(t,n){return Ri({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),ey=qu({fields:[],name:"unselecting",active:ny}),ry=Ge("color-input-change"),oy=Ge("color-swatch-change"),iy=Ge("color-picker-cancel"),uy=function(t,n,e){var r=ev.parts().field({factory:Xv,inputClasses:["tox-textfield"],onSetValue:function(t){return cb.run(t).get(function(){})},inputBehaviours:Wu([fb.config({}),cb.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return ce(t.element())},notify:{onValid:function(t){var n=vm.getValue(t);No(t,ry,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=vm.getValue(t);if(0===n.length)return gv.pure(gt.value(!0));var e=jn.fromTag("span");Zi(e,"background-color",n);var r=ru(e,"background-color").fold(function(){return gt.error("blah")},function(t){return gt.value(n)});return gv.pure(r)}}})]),selectOnFocus:!1}),o=t.label.map(function(t){return zv(t,n.providers)}),i=function(t,n){No(t,oy,{value:n})},u=rg(function(t,n){return ty.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:Wu([ey.config({}),fb.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(){return gv.nu(function(n){return t.fetch(n)}).map(function(e){return b.from(ch(bt(uh(Ge("menu-value"),e,function(n){t.onItemAction(n)},5,"color",xp.CLOSE_ON_EXECUTE,function(){return!1},n.providers),{movement:Kp(5,"color")})))})},parts:{menu:Yp(0,0,"color")}})}({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:b.some({onRtl:function(){return[ic]},onLtr:function(){return[uc]}}),components:[],fetch:Jb.getFetch(e.getColors(),e.hasCustomColors()),onItemAction:function(t){n.getSink().each(function(n){u.getOpt(n).each(function(n){"custom"===t?e.colorPicker(function(t){t.fold(function(){return Bo(n,iy)},function(t){i(n,t),jb(t)})},"#ffffff"):i(n,"remove"===t?"":t)})})}},n));return ev.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:o.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,u.asSpec()]}]),fieldBehaviours:Wu([Hm("form-field-events",[Yo(ry,function(t,n){u.getOpt(t).each(function(t){Zi(t.element(),"background-color",n.event().color())})}),Yo(oy,function(t,n){ev.getField(t).each(function(e){vm.setValue(e,n.event().value()),ql.getCurrent(t).each(Sm.focus)})}),Yo(iy,function(t,n){ev.getField(t).each(function(n){ql.getCurrent(t).each(Sm.focus)})})])])})},ay=function(t,n,e){return{hue:o(t),saturation:o(n),value:o(e)}},cy=o(Ge("rgb-hex-update")),sy=o(Ge("slider-update")),ly=o(Ge("palette-update")),fy=hn.detect(),dy=fy.deviceType.isTouch(),my=ml({schema:[oo("dom")],name:"label"}),gy=function(t){return ml({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold(function(){return{}},function(t){var e=Go([Ko(Nt(),t,[n])]),r=Go([Ko(Mt(),t,[n]),Ko(Ft(),function(n,e){e.mouseIsDown.get()&&t(n,e)},[n])]);return{events:dy?e:r}})}})},py=gy("top-left"),hy=gy("top"),vy=gy("top-right"),by=gy("right"),yy=gy("bottom-right"),wy=gy("bottom"),xy=gy("bottom-left"),Sy=[my,gy("left"),by,hy,wy,py,vy,xy,yy,fl({name:"thumb",defaults:o({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Go([Qo(Nt(),t,"spectrum"),Qo(_t(),t,"spectrum"),Qo(It(),t,"spectrum"),Qo(Mt(),t,"spectrum"),Qo(Ft(),t,"spectrum"),Qo(Lt(),t,"spectrum")])}}}),fl({schema:[Eo("mouseIsDown",function(){return Dt(!1)})],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,r){return n.getValueFromEvent(r).map(function(r){return n.setValueFrom(e,t,r)})},r=Go([Yo(Nt(),e),Yo(_t(),e)]),o=Go([Yo(Mt(),e),Yo(Ft(),function(n,r){t.mouseIsDown.get()&&e(n,r)})]);return{behaviours:Wu(dy?[]:[Qd.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),Sm.config({})]),events:dy?r:o}}})],Cy=hn.detect().deviceType.isTouch(),Oy=o("slider.change.value"),ky=function(t){var n=t.event().raw();if(Cy){var e=n;return void 0!==e.touches&&1===e.touches.length?b.some(e.touches[0]).map(function(t){return na(t.clientX,t.clientY)}):b.none()}var r=n;return void 0!==r.clientX?b.some(r).map(function(t){return na(t.clientX,t.clientY)}):b.none()},Ty=function(t,n,e,r){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-r)},Ey=function(t,n,e,r){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+r)},Dy=function(t,n,e){return Math.max(n,Math.min(e,t))},Ay=function(t){var n=t.min,e=t.max,r=t.range,o=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(o<f)return g;if(o>d)return p;var h=function(t,n,e){return Math.min(e,Math.max(t,n))-n}(o,f,d),v=Dy(h/m*r+n,g,p);return u&&v>=n&&v<=e?function(t,n,e,r,o){return o.fold(function(){var o=t-n,i=Math.round(o/r)*r;return Dy(n+i,n-1,e+1)},function(n){var o=(t-n)%r,i=Math.round(o/r),u=Math.floor((t-n)/r),a=Math.floor((e-n)/r),c=n+Math.min(a,u+i)*r;return Math.max(n,c)})}(v,n,e,i,a):c?Math.round(v):v},Ry=function(t){var n=t.min,e=t.max,r=t.range,o=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return o<n?i?0:s:o>e?u?a:l:(o-n)/r*c},By=function(t){return t.model.minX},Ny=function(t){return t.model.minY},_y=function(t){return t.model.minX-1},Iy=function(t){return t.model.minY-1},My=function(t){return t.model.maxX},Fy=function(t){return t.model.maxY},Py=function(t){return t.model.maxX+1},Ly=function(t){return t.model.maxY+1},Hy=function(t,n,e){return n(t)-e(t)},Vy=function(t){return Hy(t,My,By)},zy=function(t){return Hy(t,Fy,Ny)},jy=function(t){return Vy(t)/2},Uy=function(t){return zy(t)/2},Wy=function(t){return t.stepSize},Gy=function(t){return t.snapToGrid},qy=function(t){return t.snapStart},$y=function(t){return t.rounded},Xy=function(t,n){return void 0!==t[n+"-edge"]},Yy=function(t){return Xy(t,"left")},Ky=function(t){return Xy(t,"right")},Jy=function(t){return Xy(t,"top")},Zy=function(t){return Xy(t,"bottom")},Qy=function(t){return t.model.value.get()},tw=function(t){return{x:o(t)}},nw=function(t){return{y:o(t)}},ew=function(t,n){return{x:o(t),y:o(n)}},rw=function(t,n){No(t,Oy(),{value:n})},ow=function(t){return t.element().dom().getBoundingClientRect()},iw=function(t,n){return t[n]},uw=function(t){var n=ow(t);return iw(n,"left")},aw=function(t){var n=ow(t);return iw(n,"right")},cw=function(t){var n=ow(t);return iw(n,"top")},sw=function(t){var n=ow(t);return iw(n,"bottom")},lw=function(t){var n=ow(t);return iw(n,"width")},fw=function(t){var n=ow(t);return iw(n,"height")},dw=function(t,n,e){return(t+n)/2-e},mw=function(t,n){var e=ow(t),r=ow(n),o=iw(e,"left"),i=iw(e,"right"),u=iw(r,"left");return dw(o,i,u)},gw=function(t,n){var e=ow(t),r=ow(n),o=iw(e,"top"),i=iw(e,"bottom"),u=iw(r,"top");return dw(o,i,u)},pw=function(t,n){No(t,Oy(),{value:n})},hw=function(t){return{x:o(t)}},vw=function(t,n,e){var r={min:By(n),max:My(n),range:Vy(n),value:e,step:Wy(n),snap:Gy(n),snapStart:qy(n),rounded:$y(n),hasMinEdge:Yy(n),hasMaxEdge:Ky(n),minBound:uw(t),maxBound:aw(t),screenRange:lw(t)};return Ay(r)},bw=function(t){return function(n,e){return function(t,n,e){var r=(t>0?Ey:Ty)(Qy(e).x(),By(e),My(e),Wy(e));return pw(n,hw(r)),b.some(r)}(t,n,e).map(function(){return!0})}},yw=function(t,n,e,r,o,i){var u=function(t,n,e,r,o){var i=lw(t),u=r.bind(function(n){return b.some(mw(n,t))}).getOr(0),a=o.bind(function(n){return b.some(mw(n,t))}).getOr(i),c={min:By(n),max:My(n),range:Vy(n),value:e,hasMinEdge:Yy(n),hasMaxEdge:Ky(n),minBound:uw(t),minOffset:0,maxBound:aw(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return Ry(c)}(n,i,e,r,o);return uw(n)-uw(t)+u},ww=bw(-1),xw=bw(1),Sw=b.none,Cw=b.none,Ow={"top-left":b.none(),top:b.none(),"top-right":b.none(),right:b.some(function(t,n){rw(t,tw(Py(n)))}),"bottom-right":b.none(),bottom:b.none(),"bottom-left":b.none(),left:b.some(function(t,n){rw(t,tw(_y(n)))})},kw=Object.freeze({setValueFrom:function(t,n,e){var r=vw(t,n,e),o=hw(r);return pw(t,o),r},setToMin:function(t,n){var e=By(n);pw(t,hw(e))},setToMax:function(t,n){var e=My(n);pw(t,hw(e))},findValueOfOffset:vw,getValueFromEvent:function(t){return ky(t).map(function(t){return t.left()})},findPositionOfValue:yw,setPositionFromValue:function(t,n,e,r){var o=Qy(e),i=yw(t,r.getSpectrum(t),o.x(),r.getLeftEdge(t),r.getRightEdge(t),e),u=ca(n.element())/2;Zi(n.element(),"left",i-u+"px")},onLeft:ww,onRight:xw,onUp:Sw,onDown:Cw,edgeActions:Ow}),Tw=function(t,n){No(t,Oy(),{value:n})},Ew=function(t){return{y:o(t)}},Dw=function(t,n,e){var r={min:Ny(n),max:Fy(n),range:zy(n),value:e,step:Wy(n),snap:Gy(n),snapStart:qy(n),rounded:$y(n),hasMinEdge:Jy(n),hasMaxEdge:Zy(n),minBound:cw(t),maxBound:sw(t),screenRange:fw(t)};return Ay(r)},Aw=function(t){return function(n,e){return function(t,n,e){var r=(t>0?Ey:Ty)(Qy(e).y(),Ny(e),Fy(e),Wy(e));return Tw(n,Ew(r)),b.some(r)}(t,n,e).map(function(){return!0})}},Rw=function(t,n,e,r,o,i){var u=function(t,n,e,r,o){var i=fw(t),u=r.bind(function(n){return b.some(gw(n,t))}).getOr(0),a=o.bind(function(n){return b.some(gw(n,t))}).getOr(i),c={min:Ny(n),max:Fy(n),range:zy(n),value:e,hasMinEdge:Jy(n),hasMaxEdge:Zy(n),minBound:cw(t),minOffset:0,maxBound:sw(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return Ry(c)}(n,i,e,r,o);return cw(n)-cw(t)+u},Bw=b.none,Nw=b.none,_w=Aw(-1),Iw=Aw(1),Mw={"top-left":b.none(),top:b.some(function(t,n){rw(t,nw(Iy(n)))}),"top-right":b.none(),right:b.none(),"bottom-right":b.none(),bottom:b.some(function(t,n){rw(t,nw(Ly(n)))}),"bottom-left":b.none(),left:b.none()},Fw=Object.freeze({setValueFrom:function(t,n,e){var r=Dw(t,n,e),o=Ew(r);return Tw(t,o),r},setToMin:function(t,n){var e=Ny(n);Tw(t,Ew(e))},setToMax:function(t,n){var e=Fy(n);Tw(t,Ew(e))},findValueOfOffset:Dw,getValueFromEvent:function(t){return ky(t).map(function(t){return t.top()})},findPositionOfValue:Rw,setPositionFromValue:function(t,n,e,r){var o=Qy(e),i=Rw(t,r.getSpectrum(t),o.y(),r.getTopEdge(t),r.getBottomEdge(t),e),u=fa(n.element())/2;Zi(n.element(),"top",i-u+"px")},onLeft:Bw,onRight:Nw,onUp:_w,onDown:Iw,edgeActions:Mw}),Pw=function(t,n){No(t,Oy(),{value:n})},Lw=function(t,n){return{x:o(t),y:o(n)}},Hw=function(t,n){return function(e,r){return function(t,n,e,r){var o=t>0?Ey:Ty,i=n?Qy(r).x():o(Qy(r).x(),By(r),My(r),Wy(r)),u=n?o(Qy(r).y(),Ny(r),Fy(r),Wy(r)):Qy(r).y();return Pw(e,Lw(i,u)),b.some(i)}(t,n,e,r).map(function(){return!0})}},Vw=Hw(-1,!1),zw=Hw(1,!1),jw=Hw(-1,!0),Uw=Hw(1,!0),Ww={"top-left":b.some(function(t,n){rw(t,ew(_y(n),Iy(n)))}),top:b.some(function(t,n){rw(t,ew(jy(n),Iy(n)))}),"top-right":b.some(function(t,n){rw(t,ew(Py(n),Iy(n)))}),right:b.some(function(t,n){rw(t,ew(Py(n),Uy(n)))}),"bottom-right":b.some(function(t,n){rw(t,ew(Py(n),Ly(n)))}),bottom:b.some(function(t,n){rw(t,ew(jy(n),Ly(n)))}),"bottom-left":b.some(function(t,n){rw(t,ew(_y(n),Ly(n)))}),left:b.some(function(t,n){rw(t,ew(_y(n),Uy(n)))})},Gw=Object.freeze({setValueFrom:function(t,n,e){var r=vw(t,n,e.left()),o=Dw(t,n,e.top()),i=Lw(r,o);return Pw(t,i),i},setToMin:function(t,n){var e=By(n),r=Ny(n);Pw(t,Lw(e,r))},setToMax:function(t,n){var e=My(n),r=Fy(n);Pw(t,Lw(e,r))},getValueFromEvent:function(t){return ky(t)},setPositionFromValue:function(t,n,e,r){var o=Qy(e),i=yw(t,r.getSpectrum(t),o.x(),r.getLeftEdge(t),r.getRightEdge(t),e),u=Rw(t,r.getSpectrum(t),o.y(),r.getTopEdge(t),r.getBottomEdge(t),e),a=ca(n.element())/2,c=fa(n.element())/2;Zi(n.element(),"left",i-a+"px"),Zi(n.element(),"top",u-c+"px")},onLeft:Vw,onRight:zw,onUp:jw,onDown:Uw,edgeActions:Ww}),qw=hn.detect().deviceType.isTouch(),$w=[yo("stepSize",1),yo("onChange",n),yo("onChoose",n),yo("onInit",n),yo("onDragStart",n),yo("onDragEnd",n),yo("snapToGrid",!1),yo("rounded",!0),mo("snapStart"),io("model",Kr("mode",{x:[yo("minX",0),yo("maxX",100),Eo("value",function(t){return Dt(t.mode.minX)}),oo("getInitialValue"),Pu("manager",kw)],y:[yo("minY",0),yo("maxY",100),Eo("value",function(t){return Dt(t.mode.minY)}),oo("getInitialValue"),Pu("manager",Fw)],xy:[yo("minX",0),yo("maxX",100),yo("minY",0),yo("maxY",100),Eo("value",function(t){return Dt({x:o(t.mode.minX),y:o(t.mode.minY)})}),oo("getInitialValue"),Pu("manager",Gw)]})),Ls("sliderBehaviours",[Qd,vm])].concat(qw?[]:[Eo("mouseIsDown",function(){return Dt(!1)})]),Xw=hn.detect().deviceType.isTouch(),Yw=jl({name:"Slider",configFields:$w,partFields:Sy,factory:function(t,n,e,r){var i=function(n){return Tl(n,t,"thumb")},u=function(n){return Tl(n,t,"spectrum")},a=function(n){return kl(n,t,"left-edge")},c=function(n){return kl(n,t,"right-edge")},s=function(n){return kl(n,t,"top-edge")},l=function(n){return kl(n,t,"bottom-edge")},f=t.model,d=f.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:l,getSpectrum:u})},g=function(n,e){f.value.set(e);var r=i(n);return m(n,r),t.onChange(n,r,e),b.some(!0)},p=[Yo(Nt(),function(n,e){t.onDragStart(n,i(n))}),Yo(It(),function(n,e){t.onDragEnd(n,i(n))})],h=[Yo(Mt(),function(n,e){e.stop(),t.onDragStart(n,i(n)),t.mouseIsDown.set(!0)}),Yo(Lt(),function(n,e){t.onDragEnd(n,i(n))})],v=Xw?p:h;return{uid:t.uid,dom:t.dom,components:n,behaviours:Vs(t.sliderBehaviours,j([Xw?[]:[Qd.config({mode:"special",focusIn:function(n){return kl(n,t,"spectrum").map(Qd.focusIn).map(o(!0))}})],[vm.config({store:{mode:"manual",getValue:function(t){return f.value.get()}}}),Zu.config({channels:{"mouse.released":{onReceive:function(n,e){var r=t.mouseIsDown.get();t.mouseIsDown.set(!1),r&&kl(n,t,"thumb").each(function(e){var r=f.value.get();t.onChoose(n,e,r)})}}}})]])),events:Go([Yo(Oy(),function(t,n){g(t,n.event().value())}),oi(function(n,e){var r=f.getInitialValue();f.value.set(r);var o=i(n);m(n,o);var a=u(n);t.onInit(n,o,a,f.value.get())})].concat(v)),apis:{resetToMin:function(n){d.setToMin(n,t)},resetToMax:function(n){d.setToMax(n,t)},changeValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),Kw=function(t,n){var e=Yw.parts().spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=Yw.parts().thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return Yw.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:o({y:o(0)})},components:[e,r],sliderBehaviours:Wu([Sm.config({})]),onChange:function(t,n,e){No(t,sy(),{value:e})}})},Jw=[Ls("formBehaviours",[vm])],Zw=function(t){return"<alloy.field."+t+">"},Qw=function(t,n,e){return{uid:t.uid,dom:t.dom,components:n,behaviours:Vs(t.formBehaviours,[vm.config({store:{mode:"manual",getValue:function(n){var e=Dl(n,t);return et(e,function(t,n){return t().bind(function(t){var n,e=ql.getCurrent(t);return n="missing current",e.fold(function(){return gt.error(n)},gt.value)}).map(vm.getValue)})},setValue:function(n,e){nt(e,function(e,r){kl(n,t,r).each(function(t){ql.getCurrent(t).each(function(t){vm.setValue(t,e)})})})}}})]),apis:{getField:function(n,e){return kl(n,t,e).bind(ql.getCurrent)}}}},tx={getField:Ti(function(t,n,e){return t.getField(n,e)}),sketch:function(t){var n=function(){var t=[];return{field:function(n,e){return t.push(n),wl("form",Zw(n),e)},record:function(){return t}}}(),e=t(n),r=n.record(),o=B(r,function(t){return fl({name:t,pname:Zw(t)})});return Ml("form",Jw,o,Qw,e)}},nx=Ge("valid-input"),ex=Ge("invalid-input"),rx=Ge("validating-input"),ox=function(t,e,r,i){var u=function(n,r){return cb.config({invalidClass:e("invalid"),notify:{onValidate:function(t){No(t,rx,{type:n})},onValid:function(t){No(t,nx,{type:n,value:vm.getValue(t)})},onInvalid:function(t){No(t,ex,{type:n,value:vm.getValue(t)})}},validator:{validate:function(n){var e=vm.getValue(n),o=r(e)?gt.value(!0):gt.error(t("aria.input.invalid"));return gv.pure(o)},validateOnLoad:!1}})},a=function(r,o,i,a,c){var s=t("colorcustom.rgb.range"),l=[ev.parts().label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":a}}}),ev.parts().field({data:c,factory:Xv,inputAttributes:$e({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:Wu([u(o,r),fb.config({})]),onSetValue:function(t){cb.isInvalid(t)&&cb.run(t).get(n)}})],f="hex"!==o?[ev.parts()["aria-descriptor"]({text:s})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:l.concat(f)}},c=function(t,n){var e=n.red(),r=n.green(),o=n.blue();vm.setValue(t,{red:e,green:r,blue:o})},s=rg({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),l=function(t,n){s.getOpt(t).each(function(t){Zi(t.element(),"background-color","#"+n.value())})};return zl({factory:function(){var n={red:o(Dt(b.some(255))),green:o(Dt(b.some(255))),blue:o(Dt(b.some(255))),hex:o(Dt(b.some("ffffff")))},u=function(t){return n[t]().get()},f=function(t,e){n[t]().set(e)},d=function(t){var n=t.red(),e=t.green(),r=t.blue();f("red",b.some(n)),f("green",b.some(e)),f("blue",b.some(r))},m=function(t,n){var e=n.event();"hex"!==e.type()?f(e.type(),b.none()):i(t)},g=function(t,n,e){var r=parseInt(e,10);f(n,b.some(r)),u("red").bind(function(t){return u("green").bind(function(n){return u("blue").map(function(e){return Ob(t,n,e,1)})})}).each(function(n){var e=function(t,n){var e=bb(n);return tx.getField(t,"hex").each(function(n){Sm.isFocused(n)||vm.setValue(t,{hex:e.value()})}),e}(t,n);l(t,e)})},p=function(t,n){var e=n.event();!function(t){return"hex"===t.type()}(e)?g(t,e.type(),e.value()):function(t,n){r(t);var e=db(n);f("hex",b.some(n));var o=Eb(e);c(t,o),d(o),No(t,cy(),{hex:e}),l(t,e)}(t,e.value())},h=function(n){return{label:t("colorcustom.rgb."+n+".label"),description:t("colorcustom.rgb."+n+".description")}},v=h("red"),y=h("green"),w=h("blue"),x=h("hex");return bt(tx.sketch(function(n){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[n.field("red",ev.sketch(a(kb,"red",v.label,v.description,255))),n.field("green",ev.sketch(a(kb,"green",y.label,y.description,255))),n.field("blue",ev.sketch(a(kb,"blue",w.label,w.description,255))),n.field("hex",ev.sketch(a(pb,"hex",x.label,x.description,"ffffff"))),s.asSpec()],formBehaviours:Wu([cb.config({invalidClass:e("form-invalid")}),Hm("rgb-form-events",[Yo(nx,p),Yo(ex,m),Yo(rx,m)])])}}),{apis:{updateHex:function(t,n){vm.setValue(t,{hex:n.value()}),function(t,n){var e=Eb(n);c(t,e),d(e)}(t,n),l(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},ix=function(t,n){var e=Yw.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),r=Yw.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(t,n){var e=t.width,r=t.height,o=t.getContext("2d");if(null!==o){o.fillStyle=n,o.fillRect(0,0,e,r);var i=o.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=i,o.fillRect(0,0,e,r);var u=o.createLinearGradient(0,0,0,r);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),o.fillStyle=u,o.fillRect(0,0,e,r)}};return zl({factory:function(t){var u=o({x:o(0),y:o(0)}),a=Wu([ql.config({find:b.some}),Sm.config({})]);return Yw.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[e,r],onChange:function(t,n,e){No(t,ly(),{value:e})},onInit:function(t,n,e,r){i(e.element().dom(),Ab(Rb()))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){!function(t,n){var e=t.components()[0].element().dom();i(e,Ab(n))}(n,e)}},extraApis:{}})},ux=function(t,e){return zl({name:"ColourPicker",configFields:[oo("dom"),yo("onValidHex",n),yo("onInvalidHex",n)],factory:function(n){var r,i=ox(t,e,n.onValidHex,n.onInvalidHex),u=ix(t,e),a={paletteRgba:o(Dt(Rb()))},c=rg(u.sketch({})),s=rg(i.sketch({})),l=function(t,n){c.getOpt(t).each(function(t){var e=Eb(n);a.paletteRgba().set(e),u.setRgba(t,e)})},f=function(t,n){s.getOpt(t).each(function(t){i.updateHex(t,n)})},d=function(t,n,e){N(e,function(e){e(t,n)})};return{uid:n.uid,dom:n.dom,components:[c.asSpec(),Kw(t,e),s.asSpec()],behaviours:Wu([Hm("colour-picker-events",[Yo(ly(),(r=[f],function(t,n){var e=n.event().value(),o=function(t){var n,e=0,r=0,o=t.red()/255,i=t.green()/255,u=t.blue()/255,a=Math.min(o,Math.min(i,u)),c=Math.max(o,Math.max(i,u));return a===c?ay(0,0,100*(r=a)):(e=60*((e=o===a?3:u===a?1:5)-(o===a?i-u:u===a?o-i:u-o)/(c-a)),n=(c-a)/c,r=c,ay(Math.round(e),Math.round(100*n),Math.round(100*r)))}(a.paletteRgba().get()),i=ay(o.hue(),e.x(),100-e.y()),u=Tb(i),c=bb(u);d(t,c,r)})),Yo(sy(),function(){var t=[l,f];return function(n,e){var r=function(t){var n=ay((100-t)/100*360,100,100),e=Tb(n);return bb(e)}(e.event().value().y());d(n,r,t)}}())]),ql.config({find:function(t){return s.getOpt(t)}}),Qd.config({mode:"acyclic"})])}}})},ax=function(){return ql.config({find:b.some})},cx=function(t){return ql.config({find:t.getOpt})},sx=function(t){return ql.config({find:function(n){return fe(n.element(),t).bind(function(t){return n.getSystem().getByDom(t).toOption()})}})},lx={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},fx=function(t){return function(t){return lx[t]}(t)},dx=Br([yo("preprocess",i),yo("postprocess",i)]),mx=function(t,n,e){return vm.config(bt({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},gx=function(t,n,e){return mx(t,function(t){return n(t.element())},function(t,n){return e(t.element(),n)})},px=function(t,n){var e=Xr("RepresentingConfigs.memento processors",dx,n);return vm.config({store:{mode:"manual",getValue:function(n){var r=t.get(n),o=vm.getValue(r);return e.postprocess(o)},setValue:function(n,r){var o=e.preprocess(r),i=t.get(n);vm.setValue(i,o)}}})},hx=mx,vx=function(t){return gx(t,ye,we)},bx=function(t){return vm.config({store:{mode:"memory",initialValue:t}})},yx=function(t,n){var e=function(t,n){n.stop()},r=function(t){return function(n,e){N(t,function(t){t(n,e)})}},o=function(t,n){if(!mp.isDisabled(t)){var e=n.event().raw();u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event().raw().target.files;u(t,e)},u=function(n,e){vm.setValue(n,function(t){var n=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i");return M(Z(t),function(t){return n.test(t.name)})}(e)),No(n,Gh,{name:t.name})},a=rg({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Wu([Hm("input-file-events",[ni(kn())])])}),c=t.label.map(function(t){return zv(t,n)}),s=ev.parts().field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Wu([bx([]),ax(),mp.config({}),Im.config({toggleClass:"dragenter",toggleOnExecute:!1}),Hm("dropzone-events",[Yo("dragenter",r([e,Im.toggle])),Yo("dragleave",r([e,Im.toggle])),Yo("dragover",e),Yo("drop",r([e,o])),Yo(Gt(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},eg.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element().dom().click()},buttonBehaviours:Wu([fb.config({})])})]}]}}}});return Pv(c,s,["tox-form__group--stretched"])},wx=Ge("alloy-fake-before-tabstop"),xx=Ge("alloy-fake-after-tabstop"),Sx=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Wu([Sm.config({ignore:!0}),fb.config({})])}},Cx=function(t,n){No(t,jt(),{raw:{which:9,shiftKey:n}})},Ox=function(t){return hh(t,["."+wx,"."+xx].join(","),o(!1))},kx=function(t,n){var e=n.element();qi(e,wx)?Cx(t,!0):qi(e,xx)&&Cx(t,!1)},Tx=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Sx([wx]),t,Sx([xx])],behaviours:Wu([sx(1)])}},Ex=!(hn.detect().browser.isIE()||hn.detect().browser.isEdge()),Dx=function(t,n){var e=Ex&&t.sandboxed,r=$e({},t.label.map(function(t){return{title:t}}).getOr({}),e?{sandbox:"allow-scripts allow-same-origin"}:{}),o=function(t){var n=Dt("");return{getValue:function(t){return n.get()},setValue:function(e,r){if(t)De(e.element(),"src","data:text/html;charset=utf-8,"+encodeURIComponent(r));else{De(e.element(),"src","javascript:''");var o=e.element().dom().contentWindow.document;o.open(),o.write(r),o.close()}n.set(r)}}}(e),i=t.label.map(function(t){return zv(t,n)}),u=ev.parts().field({factory:{sketch:function(t){return Tx({uid:t.uid,dom:{tag:"iframe",attributes:r},behaviours:Wu([fb.config({}),Sm.config({}),hx(b.none(),o.getValue,o.setValue)])})}}});return Pv(i,u,["tox-form__group--stretched"])};function Ax(n,e){return Bx(t.document.createElement("canvas"),n,e)}function Rx(t){return t.getContext("2d")}function Bx(t,n,e){return t.width=n,t.height=e,t}var Nx={create:Ax,clone:function(t){var n;return Rx(n=Ax(t.width,t.height)).drawImage(t,0,0),n},resize:Bx,get2dContext:Rx,get3dContext:function(t){var n=null;try{n=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(t){}return n||(n=null),n}},_x={getWidth:function(t){return t.naturalWidth||t.width},getHeight:function(t){return t.naturalHeight||t.height}},Ix=window.Promise?window.Promise:function(){var n=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(t,r(u,this),r(a,this))},e=n.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(n){t.setTimeout(n,1)};function r(t,n){return function(){t.apply(n,arguments)}}var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t){var n=this;null!==this._state?e(function(){var e=n._state?t.onFulfilled:t.onRejected;if(null!==e){var r;try{r=e(n._value)}catch(n){return void t.reject(n)}t.resolve(r)}else(n._state?t.resolve:t.reject)(n._value)}):this._deferreds.push(t)}function u(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void l(r(n,t),r(u,this),r(a,this))}this._state=!0,this._value=t,c.call(this)}catch(t){a.call(this,t)}}function a(t){this._state=!1,this._value=t,c.call(this)}function c(){for(var t=0,n=this._deferreds.length;t<n;t++)i.call(this,this._deferreds[t]);this._deferreds=null}function s(t,n,e,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=r}function l(t,n,e){var r=!1;try{t(function(t){r||(r=!0,n(t))},function(t){r||(r=!0,e(t))})}catch(t){if(r)return;r=!0,e(t)}}return n.prototype.catch=function(t){return this.then(null,t)},n.prototype.then=function(t,e){var r=this;return new n(function(n,o){i.call(r,new s(t,e,n,o))})},n.all=function(){var t=Array.prototype.slice.call(1===arguments.length&&o(arguments[0])?arguments[0]:arguments);return new n(function(n,e){if(0===t.length)return n([]);var r=t.length;function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,function(t){o(i,t)},e)}t[i]=u,0==--r&&n(t)}catch(t){e(t)}}for(var i=0;i<t.length;i++)o(i,t[i])})},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n(function(n){n(t)})},n.reject=function(t){return new n(function(n,e){e(t)})},n.race=function(t){return new n(function(n,e){for(var r=0,o=t.length;r<o;r++)t[r].then(n,e)})},n}();function Mx(){return new(Yn.getOrDie("FileReader"))}var Fx={atob:function(t){return Yn.getOrDie("atob")(t)},requestAnimationFrame:function(t){Yn.getOrDie("requestAnimationFrame")(t)}};function Px(n){return new Ix(function(e,r){var o=t.URL.createObjectURL(n),i=new t.Image,u=function(){i.removeEventListener("load",a),i.removeEventListener("error",c)};function a(){u(),e(i)}function c(){u(),r("Unable to load data of type "+n.type+": "+o)}i.addEventListener("load",a),i.addEventListener("error",c),i.src=o,i.complete&&a()})}function Lx(n){return new Ix(function(e,r){var o=new t.XMLHttpRequest;o.open("GET",n,!0),o.responseType="blob",o.onload=function(){200==this.status&&e(this.response)},o.onerror=function(){var t,n=this;r(0===this.status?((t=new Error("No access to download image")).code=18,t.name="SecurityError",t):new Error("Error "+n.status+" downloading image"))},o.send()})}function Hx(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return b.none();for(var r,o=e[1],i=n[1],u=Fx.atob(i),a=u.length,c=Math.ceil(a/1024),s=new Array(c),l=0;l<c;++l){for(var f=1024*l,d=Math.min(f+1024,a),m=new Array(d-f),g=f,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[l]=(r=m,new(Yn.getOrDie("Uint8Array"))(r))}return b.some(function(t,n){return new(Yn.getOrDie("Blob"))(t,n)}(s,{type:o}))}function Vx(t){return new Ix(function(n,e){Hx(t).fold(function(){e("uri is not base64: "+t)},n)})}function zx(t){return new Ix(function(n){var e=Mx();e.onloadend=function(){n(e.result)},e.readAsDataURL(t)})}var jx={blobToImage:Px,imageToBlob:function(t){var n=t.src;return 0===n.indexOf("data:")?Vx(n):Lx(n)},blobToArrayBuffer:function(t){return new Ix(function(n){var e=Mx();e.onloadend=function(){n(e.result)},e.readAsArrayBuffer(t)})},blobToDataUri:zx,blobToBase64:function(t){return zx(t).then(function(t){return t.split(",")[1]})},dataUriToBlobSync:Hx,canvasToBlob:function(n,e,r){return e=e||"image/png",t.HTMLCanvasElement.prototype.toBlob?new Ix(function(t){n.toBlob(function(n){t(n)},e,r)}):Vx(n.toDataURL(e,r))},canvasToDataURL:function(t,n,e){return n=n||"image/png",t.then(function(t){return t.toDataURL(n,e)})},blobToCanvas:function(n){return Px(n).then(function(n){var e;return function(n){t.URL.revokeObjectURL(n.src)}(n),e=Nx.create(_x.getWidth(n),_x.getHeight(n)),Nx.get2dContext(e).drawImage(n,0,0),e})},uriToBlob:function(t){return 0===t.indexOf("blob:")?Lx(t):0===t.indexOf("data:")?Vx(t):null}};function Ux(t,n,e){var r=n.type;function i(n,e){return t.then(function(t){return jx.canvasToDataURL(t,n,e)})}return{getType:o(r),toBlob:function(){return Ix.resolve(n)},toDataURL:function(){return e},toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then(function(t){return jx.canvasToBlob(t,n,e)})},toAdjustedDataURL:i,toAdjustedBase64:function(t,n){return i(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(Nx.clone)}}}function Wx(t){return jx.blobToDataUri(t).then(function(n){return Ux(jx.blobToCanvas(t),t,n)})}var Gx={fromBlob:Wx,fromCanvas:function(t,n){return jx.canvasToBlob(t,n).then(function(n){return Ux(Ix.resolve(t),n,t.toDataURL())})},fromImage:function(t){return jx.imageToBlob(t).then(function(t){return Wx(t)})},fromBlobAndUrlSync:function(t,n){return Ux(jx.blobToCanvas(t),t,n)}},qx=function(t){return Gx.fromBlob(t)};function $x(t,n,e){return(t=parseFloat(t))>e?t=e:t<n&&(t=n),t}var Xx=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function Yx(t,n){var e,r,o,i,u=[],a=new Array(10);for(e=0;e<5;e++){for(r=0;r<5;r++)u[r]=n[r+5*e];for(r=0;r<5;r++){for(i=0,o=0;o<5;o++)i+=t[r+5*o]*u[o];a[r+5*e]=i}}return a}function Kx(t,n){return n=$x(n,0,1),t.map(function(t,e){return e%6==0?t=1-(1-t)*n:t*=n,$x(t,0,1)})}var Jx={identity:function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},adjust:Kx,multiply:Yx,adjustContrast:function(t,n){var e;return n=$x(n,-1,1),Yx(t,[(e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?Xx[n]:Xx[Math.floor(n)]*(1-e)+Xx[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])},adjustBrightness:function(t,n){return Yx(t,[1,0,0,0,n=$x(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])},adjustSaturation:function(t,n){var e;return Yx(t,[.3086*(1-(e=1+((n=$x(n,-1,1))>0?3*n:n)))+e,.6094*(1-e),.082*(1-e),0,0,.3086*(1-e),.6094*(1-e)+e,.082*(1-e),0,0,.3086*(1-e),.6094*(1-e),.082*(1-e)+e,0,0,0,0,0,1,0,0,0,0,0,1])},adjustHue:function(t,n){var e,r;return n=$x(n,-180,180)/180*Math.PI,Yx(t,[.213+.787*(e=Math.cos(n))+-.213*(r=Math.sin(n)),.715+-.715*e+-.715*r,.072+-.072*e+.928*r,0,0,.213+-.213*e+.143*r,.715+e*(1-.715)+.14*r,.072+-.072*e+-.283*r,0,0,.213+-.213*e+-.787*r,.715+-.715*e+.715*r,.072+.928*e+.072*r,0,0,0,0,0,1,0,0,0,0,0,1])},adjustColors:function(t,n,e,r){return Yx(t,[n=$x(n,0,2),0,0,0,0,0,e=$x(e,0,2),0,0,0,0,0,r=$x(r,0,2),0,0,0,0,0,1,0,0,0,0,0,1])},adjustSepia:function(t,n){return Yx(t,Kx([.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0,0,0,0,0,1],n=$x(n,0,1)))},adjustGrayscale:function(t,n){return Yx(t,Kx([.33,.34,.33,0,0,.33,.34,.33,0,0,.33,.34,.33,0,0,0,0,0,1,0,0,0,0,0,1],n=$x(n,0,1)))}};function Zx(t,n){return t.toCanvas().then(function(e){return function(t,n,e){var r,o=Nx.get2dContext(t);return r=function(t,n){var e,r,o,i,u,a=t.data,c=n[0],s=n[1],l=n[2],f=n[3],d=n[4],m=n[5],g=n[6],p=n[7],h=n[8],v=n[9],b=n[10],y=n[11],w=n[12],x=n[13],S=n[14],C=n[15],O=n[16],k=n[17],T=n[18],E=n[19];for(u=0;u<a.length;u+=4)e=a[u],r=a[u+1],o=a[u+2],i=a[u+3],a[u]=e*c+r*s+o*l+i*f+d,a[u+1]=e*m+r*g+o*p+i*h+v,a[u+2]=e*b+r*y+o*w+i*x+S,a[u+3]=e*C+r*O+o*k+i*T+E;return t}(o.getImageData(0,0,t.width,t.height),e),o.putImageData(r,0,0),Gx.fromCanvas(t,n)}(e,t.getType(),n)})}function Qx(t,n){return t.toCanvas().then(function(e){return function(t,n,e){var r,o,i=Nx.get2dContext(t);return r=i.getImageData(0,0,t.width,t.height),o=i.getImageData(0,0,t.width,t.height),o=function(t,n,e){var r,o,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y;function w(t,n,e){return t>e?t=e:t<n&&(t=n),t}for(i=Math.round(Math.sqrt(e.length)),u=Math.floor(i/2),r=t.data,o=n.data,b=t.width,y=t.height,c=0;c<y;c++)for(a=0;a<b;a++){for(s=l=f=0,m=0;m<i;m++)for(d=0;d<i;d++)g=w(a+d-u,0,b-1),p=w(c+m-u,0,y-1),h=4*(p*b+g),v=e[m*i+d],s+=r[h]*v,l+=r[h+1]*v,f+=r[h+2]*v;o[h=4*(c*b+a)]=w(s,0,255),o[h+1]=w(l,0,255),o[h+2]=w(f,0,255)}return n}(r,o,e),i.putImageData(o,0,0),Gx.fromCanvas(t,n)}(e,t.getType(),n)})}function tS(t){return function(n,e){return n.toCanvas().then(function(r){return function(n,e,r){var o,i,u=Nx.get2dContext(n),a=new Array(256);for(i=0;i<a.length;i++)a[i]=t(i,r);return o=function(t,n){var e,r=t.data;for(e=0;e<r.length;e+=4)r[e]=n[r[e]],r[e+1]=n[r[e+1]],r[e+2]=n[r[e+2]];return t}(u.getImageData(0,0,n.width,n.height),a),u.putImageData(o,0,0),Gx.fromCanvas(n,e)}(r,n.getType(),e)})}}function nS(t){return function(n,e){return Zx(n,t(Jx.identity(),e))}}function eS(t){return function(n){return Qx(n,t)}}var rS={invert:function(t){return function(n){return Zx(n,t)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]),brightness:nS(Jx.adjustBrightness),hue:nS(Jx.adjustHue),saturate:nS(Jx.adjustSaturation),contrast:nS(Jx.adjustContrast),grayscale:nS(Jx.adjustGrayscale),sepia:nS(Jx.adjustSepia),colorize:function(t,n,e,r){return Zx(t,Jx.adjustColors(Jx.identity(),n,e,r))},sharpen:eS([0,-1,0,-1,5,-1,0,-1,0]),emboss:eS([-2,-1,0,-1,1,1,0,1,2]),gamma:tS(function(t,n){return 255*Math.pow(t/255,1-n)}),exposure:tS(function(t,n){return 255*(1-Math.exp(-t/255*n))}),colorFilter:Zx,convoluteFilter:Qx},oS={scale:function t(n,e,r){var o=_x.getWidth(n),i=_x.getHeight(n),u=e/o,a=r/i,c=!1;(u<.5||u>2)&&(u=u<.5?.5:2,c=!0),(a<.5||a>2)&&(a=a<.5?.5:2,c=!0);var s=function(t,n,e){return new Ix(function(r){var o=_x.getWidth(t),i=_x.getHeight(t),u=Math.floor(o*n),a=Math.floor(i*e),c=Nx.create(u,a),s=Nx.get2dContext(c);s.drawImage(t,0,0,o,i,0,0,u,a),r(c)})}(n,u,a);return c?s.then(function(n){return t(n,e,r)}):s}},iS={rotate:function(t,n){return t.toCanvas().then(function(e){return function(t,n,e){var r=Nx.create(t.width,t.height),o=Nx.get2dContext(r),i=0,u=0;return 90!=(e=e<0?360+e:e)&&270!=e||Nx.resize(r,r.height,r.width),90!=e&&180!=e||(i=r.width),270!=e&&180!=e||(u=r.height),o.translate(i,u),o.rotate(e*Math.PI/180),o.drawImage(t,0,0),Gx.fromCanvas(r,n)}(e,t.getType(),n)})},flip:function(t,n){return t.toCanvas().then(function(e){return function(t,n,e){var r=Nx.create(t.width,t.height),o=Nx.get2dContext(r);return"v"==e?(o.scale(1,-1),o.drawImage(t,0,-r.height)):(o.scale(-1,1),o.drawImage(t,-r.width,0)),Gx.fromCanvas(r,n)}(e,t.getType(),n)})},crop:function(t,n,e,r,o){return t.toCanvas().then(function(i){return function(t,n,e,r,o,i){var u=Nx.create(o,i);return Nx.get2dContext(u).drawImage(t,-e,-r),Gx.fromCanvas(u,n)}(i,t.getType(),n,e,r,o)})},resize:function(t,n,e){return t.toCanvas().then(function(r){return oS.scale(r,n,e).then(function(n){return Gx.fromCanvas(n,t.getType())})})}},uS=function(){function t(t){this.littleEndian=!1,this._dv=new DataView(t)}return t.prototype.readByteAt=function(t){return this._dv.getUint8(t)},t.prototype.read=function(t,n){if(t+n>this.length())return null;for(var e=this.littleEndian?0:-8*(n-1),r=0,o=0;r<n;r++)o|=this.readByteAt(t+r)<<Math.abs(e+8*r);return o},t.prototype.BYTE=function(t){return this.read(t,1)},t.prototype.SHORT=function(t){return this.read(t,2)},t.prototype.LONG=function(t){return this.read(t,4)},t.prototype.SLONG=function(t){var n=this.read(t,4);return n>2147483647?n-4294967296:n},t.prototype.CHAR=function(t){return String.fromCharCode(this.read(t,1))},t.prototype.STRING=function(t,n){return this.asArray("CHAR",t,n).join("")},t.prototype.SEGMENT=function(t,n){var e=this._dv.buffer;switch(arguments.length){case 2:return e.slice(t,t+n);case 1:return e.slice(t);default:return e}},t.prototype.asArray=function(t,n,e){for(var r=[],o=0;o<e;o++)r[o]=this[t](n+o);return r},t.prototype.length=function(){return this._dv?this._dv.byteLength:0},t}(),aS={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},cS={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},sS=(function(){function t(t){if(this._offsets={tiffHeader:10,IFD0:null,IFD1:null,exifIFD:null,gpsIFD:null},this._tiffTags={},this._reader=new uS(t),this._idx=this._offsets.tiffHeader,65505!==this.SHORT(0)||"EXIF\0"!==this.STRING(4,5).toUpperCase())throw new Error("Exif data cannot be read or not available.");if(this._reader.littleEndian=18761==this.SHORT(this._idx),42!==this.SHORT(this._idx+=2))throw new Error("Invalid Exif data.");this._offsets.IFD0=this._offsets.tiffHeader+this.LONG(this._idx+=2),this._tiffTags=this.extractTags(this._offsets.IFD0,aS.tiff),"ExifIFDPointer"in this._tiffTags&&(this._offsets.exifIFD=this._offsets.tiffHeader+this._tiffTags.ExifIFDPointer,delete this._tiffTags.ExifIFDPointer),"GPSInfoIFDPointer"in this._tiffTags&&(this._offsets.gpsIFD=this._offsets.tiffHeader+this._tiffTags.GPSInfoIFDPointer,delete this._tiffTags.GPSInfoIFDPointer);var n=this.LONG(this._offsets.IFD0+12*this.SHORT(this._offsets.IFD0)+2);n&&(this._offsets.IFD1=this._offsets.tiffHeader+n)}t.prototype.BYTE=function(t){return this._reader.BYTE(t)},t.prototype.SHORT=function(t){return this._reader.SHORT(t)},t.prototype.LONG=function(t){return this._reader.LONG(t)},t.prototype.SLONG=function(t){return this._reader.SLONG(t)},t.prototype.CHAR=function(t){return this._reader.CHAR(t)},t.prototype.STRING=function(t,n){return this._reader.STRING(t,n)},t.prototype.SEGMENT=function(t,n){return this._reader.SEGMENT(t,n)},t.prototype.asArray=function(t,n,e){for(var r=[],o=0;o<e;o++)r[o]=this[t](n+o);return r},t.prototype.length=function(){return this._reader.length()},t.prototype.UNDEFINED=function(){return this.BYTE.apply(this,arguments)},t.prototype.RATIONAL=function(t){return this.LONG(t)/this.LONG(t+4)},t.prototype.SRATIONAL=function(t){return this.SLONG(t)/this.SLONG(t+4)},t.prototype.ASCII=function(t){return this.CHAR(t)},t.prototype.TIFF=function(){return this._tiffTags},t.prototype.EXIF=function(){var t=null;if(this._offsets.exifIFD){try{t=this.extractTags(this._offsets.exifIFD,aS.exif)}catch(t){return null}if(t.ExifVersion&&Array.isArray(t.ExifVersion)){for(var n=0,e="";n<t.ExifVersion.length;n++)e+=String.fromCharCode(t.ExifVersion[n]);t.ExifVersion=e}}return t},t.prototype.GPS=function(){var t=null;if(this._offsets.gpsIFD){try{t=this.extractTags(this._offsets.gpsIFD,aS.gps)}catch(t){return null}t.GPSVersionID&&Array.isArray(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join("."))}return t},t.prototype.thumb=function(){if(this._offsets.IFD1)try{var t=this.extractTags(this._offsets.IFD1,aS.thumb);if("JPEGInterchangeFormat"in t)return this.SEGMENT(this._offsets.tiffHeader+t.JPEGInterchangeFormat,t.JPEGInterchangeFormatLength)}catch(t){}return null},t.prototype.extractTags=function(t,n){var e,r,o,i,u,a,c,s,l=[],f={},d={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},m={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(e=this.SHORT(t),r=0;r<e;r++)if(l=[],c=t+2+12*r,void 0!==(o=n[this.SHORT(c)])){if(i=d[this.SHORT(c+=2)],u=this.LONG(c+=2),!(a=m[i]))throw new Error("Invalid Exif data.");if(c+=4,a*u>4&&(c=this.LONG(c)+this._offsets.tiffHeader),c+a*u>=this.length())throw new Error("Invalid Exif data.");"ASCII"!==i?(l=this.asArray(i,c,u),s=1==u?l[0]:l,cS.hasOwnProperty(o)&&"object"!=typeof s?f[o]=cS[o][s]:f[o]=s):f[o]=this.STRING(c,u).replace(/\0$/,"").trim()}return f}}(),function(t,n){return iS.rotate(t,n)}),lS=function(t){return rS.invert(t)},fS=function(t){return rS.sharpen(t)},dS=function(t,n){return rS.brightness(t,n)},mS=function(t,n){return rS.contrast(t,n)},gS=function(t,n,e,r){return rS.colorize(t,n,e,r)},pS=function(t,n){return rS.gamma(t,n)},hS=function(t,n){return iS.flip(t,n)},vS=function(t,n,e,r,o){return iS.crop(t,n,e,r,o)},bS=function(t,n,e){return iS.resize(t,n,e)},yS=sS,wS=function(t,n){return $e({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},xS=function(t,n){return wS(ig(t,n),{})},SS=function(t,n){return wS(ig(t,n),{behaviours:Wu([om.config({})])})},CS=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Wu([om.config({})])}},OS=function(t,n,e,r,o){void 0===e&&(e=[]);var i=n.fold(function(){return{}},function(t){return{action:t}}),u=$e({buttonBehaviours:Wu([pp(t.disabled),fb.config({}),Hm("button press",[Xo("click"),Xo("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},i),a=bt(u,{dom:r});return bt(a,{components:o})},kS=function(t,n,e,r){void 0===r&&(r=[]);var o={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})},i=t.icon.map(function(t){return xS(t,e.icons)}),u=Op([i]);return OS(t,n,r,o,u)},TS=function(t,n,e,r){void 0===r&&(r=[]);var o=kS(t,b.some(n),e,r);return eg.sketch(o)},ES=function(t,n,e,r){void 0===r&&(r=[]);var o=e.translate(t.text),i=t.icon?t.icon.map(function(t){return xS(t,e.icons)}):b.none(),u=i.isSome()?Op([i]):[],a=i.isSome()?{}:{innerHtml:o},c=(t.primary?["tox-button"]:["tox-button","tox-button--secondary"]).concat(i.isSome()?["tox-button--icon"]:[]);return function(t,n,e,r,o){void 0===e&&(e=[]);var i=OS(t,b.some(n),e,r,o);return eg.sketch(i)}(t,n,r,$e({tag:"button",classes:c},a,{attributes:{title:o}}),u)},DS=function(n,e){return function(r){"custom"===e?No(r,Xh,{name:n,value:{}}):"submit"===e?Bo(r,Yh):"cancel"===e?Bo(r,$h):t.console.error("Unknown button type: ",e)}},AS=function(t,n,e){var r=DS(t.name,n);return ES(t,r,e,[])},RS=o([yo("field1Name","field1"),yo("field2Name","field2"),Mu("onLockedChange"),Bu(["lockClass"]),yo("locked",!1),zs.field("coupledFieldBehaviours",[ql,vm])]),BS=function(t,n){return fl({factory:ev,name:t,overrides:function(t){return{fieldBehaviours:Wu([Hm("coupled-input-behaviour",[Yo(Wt(),function(e){(function(t,n,e){return kl(t,n,e).bind(ql.getCurrent)})(e,t,n).each(function(n){kl(e,t,"lock").each(function(r){Im.isOn(r)&&t.onLockedChange(e,n,r)})})})])])}}})},NS=o([BS("field1","field2"),BS("field2","field1"),fl({factory:eg,schema:[oo("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Wu([Im.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),_S=jl({name:"FormCoupledInputs",configFields:RS(),partFields:NS(),factory:function(t,n,e,r){return{uid:t.uid,dom:t.dom,components:n,behaviours:zs.augment(t.coupledFieldBehaviours,[ql.config({find:b.some}),vm.config({store:{mode:"manual",getValue:function(n){var e,r=Rl(n,t,["field1","field2"]);return(e={})[t.field1Name]=vm.getValue(r.field1()),e[t.field2Name]=vm.getValue(r.field2()),e},setValue:function(n,e){var r=Rl(n,t,["field1","field2"]);Et(e,t.field1Name)&&vm.setValue(r.field1(),e[t.field1Name]),Et(e,t.field2Name)&&vm.setValue(r.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return kl(n,t,"field1")},getField2:function(n){return kl(n,t,"field2")},getLock:function(n){return kl(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),IS=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null!==n){var e=parseFloat(n[1]),r=n[2];return gt.value({value:e,unit:r})}return gt.error(t)},MS=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},r=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?b.some(t.value):r(t.unit)&&r(n)?e[t.unit]===e[n]?b.some(t.value):b.some(t.value/e[t.unit]*e[n]):b.none()},FS=function(t){return b.none()},PS=function(t,n){var e=IS(t).toOption(),r=IS(n).toOption();return Bt([e,r],function(t,n){return MS(t,n.unit).map(function(t){return n.value/t}).map(function(t){return function(t,n){return function(e){return MS(e,n).map(function(e){return{value:e*t,unit:n}})}}(t,n.unit)}).getOr(FS)}).getOr(FS)},LS=function(t,n){var e=FS,r=Ge("ratio-event"),o=_S.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:ig("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:ig("unlock",n.icons)}}],buttonBehaviours:Wu([fb.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(n){return ev.parts().field({factory:Xv,inputClasses:["tox-textfield"],inputBehaviours:Wu([fb.config({}),Hm("size-input-events",[Yo(Vt(),function(t,e){No(t,r,{isField1:n})}),Yo(Gt(),function(n,e){No(n,Gh,{name:t.name})})])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=_S.parts().field1(i([ev.parts().label(a("Width")),u(!0)])),s=_S.parts().field2(i([ev.parts().label(a("Height")),u(!1)]));return _S.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),o])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,r){IS(vm.getValue(t)).each(function(t){e(t).each(function(t){vm.setValue(n,function(t){var n,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},r=t.value.toFixed((n=t.unit)in e?e[n]:1);return-1!==r.indexOf(".")&&(r=r.replace(/\.?0*$/,"")),r+t.unit}(t))})})},coupledFieldBehaviours:Wu([mp.config({}),Hm("size-input-events2",[Yo(r,function(t,n){var r=n.event().isField1(),o=r?_S.getField1(t):_S.getField2(t),i=r?_S.getField2(t):_S.getField1(t),u=o.map(vm.getValue).getOr(""),a=i.map(vm.getValue).getOr("");e=PS(u,a)})])])})},HS={undo:o(Ge("undo")),redo:o(Ge("redo")),zoom:o(Ge("zoom")),back:o(Ge("back")),apply:o(Ge("apply")),swap:o(Ge("swap")),transform:o(Ge("transform")),tempTransform:o(Ge("temp-transform")),transformApply:o(Ge("transform-apply"))},VS=o("save-state"),zS=o("disable"),jS=o("enable"),US={formActionEvent:Xh,saveState:VS,disable:zS,enable:jS},WS=function(t,e){var r=function(t,n,r,o){return rg(ES({name:t,text:t,disabled:r,primary:o},n,e))},i=function(t,n,r,o){return rg(TS({name:t,icon:b.some(t),tooltip:b.some(n),disabled:o},r,e))},u=function(t,n){t.map(function(t){var e=t.get(n);e.hasConfigured(mp)&&mp.disable(e)})},a=function(t,n){t.map(function(t){var e=t.get(n);e.hasConfigured(mp)&&mp.enable(e)})},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=b.none(),l=n,f=function(t,n,e){No(t,n,e)},d=function(t){return Bo(t,US.disable())},m=function(t){return Bo(t,US.enable())},g=function(t,n){d(t),f(t,HS.transform(),{transform:n}),m(t)},p=function(t){return function(){tt.getOpt(t).each(function(t){om.set(t,[Z])})}},h=function(t,n){d(t),f(t,HS.transformApply(),{transform:n,swap:p(t)}),m(t)},v=function(){return r("Back",function(t){return f(t,HS.back(),{swap:p(t)})},!1,!1)},y=function(){return rg({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Wu([mp.config({})])})},w=function(){return r("Apply",function(t){return f(t,HS.apply(),{swap:p(t)})},!0,!0)},x=[v(),y(),r("Apply",function(n){h(n,function(n){var e=t.getRect();return vS(n,e.x,e.y,e.w,e.h)}),t.hideCrop()},!1,!0)],S=Ih.sketch({dom:c,components:x.map(function(t){return t.asSpec()}),containerBehaviours:Wu([Hm("image-tools-crop-buttons-events",[Yo(US.disable(),function(t,n){u(x,t)}),Yo(US.enable(),function(t,n){a(x,t)})])])}),C=rg(LS({name:"size",label:s,type:"sizeinput",constrain:!0},e)),O=[v(),y(),C,y(),r("Apply",function(t){C.getOpt(t).each(function(n){var e=vm.getValue(n),r=function(t,n){return function(e){return bS(e,t,n)}}(parseInt(e.width,10),parseInt(e.height,10));h(t,r)})},!1,!0)],k=Ih.sketch({dom:c,components:O.map(function(t){return t.asSpec()}),containerBehaviours:Wu([Hm("image-tools-resize-buttons-events",[Yo(US.disable(),function(t,n){u(O,t)}),Yo(US.enable(),function(t,n){a(O,t)})])])}),T=function(t,n){return function(e){return t(e,n)}},E=T(hS,"h"),D=T(hS,"v"),A=T(yS,-90),R=T(yS,90),B=function(t,n){!function(t,n){d(t),f(t,HS.tempTransform(),{transform:n}),m(t)}(t,n)},N=[v(),y(),i("flip-horizontally","Flip horizontally",function(t){B(t,E)},!1),i("flip-vertically","Flip vertically",function(t){B(t,D)},!1),i("rotate-left","Rotate counterclockwise",function(t){B(t,A)},!1),i("rotate-right","Rotate clockwise",function(t){B(t,R)},!1),y(),w()],_=Ih.sketch({dom:c,components:N.map(function(t){return t.asSpec()}),containerBehaviours:Wu([Hm("image-tools-fliprotate-buttons-events",[Yo(US.disable(),function(t,n){u(N,t)}),Yo(US.enable(),function(t,n){a(N,t)})])])}),I=function(t,n,r,i,u){var a=Yw.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(t)}}),c=Yw.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=Yw.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return rg(Yw.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:o({x:o(i)})},components:[a,c,s],sliderBehaviours:Wu([Sm.config({})]),onChoose:n}))},M=function(t,n,e,r,o){return I(t,function(t,e,r){var o=T(n,r.x()/100);g(t,o)},e,r,o)},F=function(t,n,e,r,o){var i=function(t,n,e,r,o){return[v(),M(t,n,e,r,o),w()]}(t,n,e,r,o);return Ih.sketch({dom:c,components:i.map(function(t){return t.asSpec()}),containerBehaviours:Wu([Hm("image-tools-filter-panel-buttons-events",[Yo(US.disable(),function(t,n){u(i,t)}),Yo(US.enable(),function(t,n){a(i,t)})])])})},P=[v(),y(),w()],L=Ih.sketch({dom:c,components:P.map(function(t){return t.asSpec()})}),H=F("Brightness",dS,-100,0,100),V=F("Contrast",mS,-100,0,100),z=F("Gamma",pS,-100,0,100),j=function(t){return I(t,function(t,n,e){var r=U.getOpt(t),o=G.getOpt(t),i=W.getOpt(t);r.each(function(n){o.each(function(e){i.each(function(r){var o=function(t,n,e){return function(r){return gS(r,t,n,e)}}(vm.getValue(n).x()/100,vm.getValue(r).x()/100,vm.getValue(e).x()/100);g(t,o)})})})},0,100,200)},U=j("R"),W=j("G"),G=j("B"),q=[v(),U,W,G,w()],$=Ih.sketch({dom:c,components:q.map(function(t){return t.asSpec()})}),X=function(t,n,e){return function(r){f(r,HS.swap(),{transform:n,swap:function(){tt.getOpt(r).each(function(n){om.set(n,[t]),e(n)})}})}},Y=b.some(fS),K=b.some(lS),J=[i("crop","Crop",X(S,s,function(n){t.showCrop()}),!1),i("resize","Resize",X(k,s,function(n){C.getOpt(n).each(function(n){var e=t.getMeasurements(),r=e.width,o=e.height;vm.setValue(n,{width:r,height:o})})}),!1),i("orientation","Orientation",X(_,s,l),!1),i("brightness","Brightness",X(H,s,l),!1),i("sharpen","Sharpen",X(L,Y,l),!1),i("contrast","Contrast",X(V,s,l),!1),i("color-levels","Color levels",X($,s,l),!1),i("gamma","Gamma",X(z,s,l),!1),i("invert","Invert",X(L,K,l),!1)],Z=Ih.sketch({dom:c,components:J.map(function(t){return t.asSpec()})}),Q=Ih.sketch({dom:{tag:"div"},components:[Z],containerBehaviours:Wu([om.config({})])}),tt=rg(Q);return{memContainer:tt,getApplyButton:function(t){return tt.getOpt(t).map(function(t){var n=t.components()[0];return n.components()[n.components().length-1]})}}},GS=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),qS=tinymce.util.Tools.resolve("tinymce.geom.Rect"),$S=tinymce.util.Tools.resolve("tinymce.util.Observable"),XS=tinymce.util.Tools.resolve("tinymce.util.Tools"),YS=tinymce.util.Tools.resolve("tinymce.util.VK");function KS(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function JS(n,e){var r,o,i,u,a,c,s,l=e.document||t.document;e=e||{};var f=l.getElementById(e.handle||n);i=function(n){var i,d,m=function(t){var n,e,r,o,i,u,a,c=Math.max;return n=t.documentElement,e=t.body,r=c(n.scrollWidth,e.scrollWidth),o=c(n.clientWidth,e.clientWidth),i=c(n.offsetWidth,e.offsetWidth),u=c(n.scrollHeight,e.scrollHeight),a=c(n.clientHeight,e.clientHeight),{width:r<i?o:r,height:u<c(n.offsetHeight,e.offsetHeight)?a:u}}(l);KS(n),n.preventDefault(),o=n.button,i=f,c=n.screenX,s=n.screenY,d=t.window.getComputedStyle?t.window.getComputedStyle(i,null).getPropertyValue("cursor"):i.runtimeStyle.cursor,r=GS("<div></div>").css({position:"absolute",top:0,left:0,width:m.width,height:m.height,zIndex:2147483647,opacity:1e-4,cursor:d}).appendTo(l.body),GS(l).on("mousemove touchmove",a).on("mouseup touchend",u),e.start(n)},a=function(t){if(KS(t),t.button!==o)return u(t);t.deltaX=t.screenX-c,t.deltaY=t.screenY-s,t.preventDefault(),e.drag(t)},u=function(t){KS(t),GS(l).off("mousemove touchmove",a).off("mouseup touchend",u),r.remove(),e.stop&&e.stop(t)},this.destroy=function(){GS(f).off()},GS(f).on("mousedown touchstart",i)}var ZS,QS=0,tC=function(t){var n=rg({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=Dt(1),r=Dt(b.none()),o=Dt({x:0,y:0,w:1,h:1}),i=Dt({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each(function(t){var u=e.get(),a=ca(t.element()),c=fa(t.element()),s=i.dom().naturalWidth*u,l=i.dom().naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};Qi(i,m),n.getOpt(t).each(function(t){Qi(t.element(),m)}),r.get().each(function(t){var n=o.get();t.setRect({x:n.x*u+f,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})})})},a=function(t,n){var r,a=jn.fromTag("img");return De(a,"src",n),(r=a.dom(),new hg(function(t){var n=function(){r.removeEventListener("load",n),t(r)};r.complete?t(r):r.addEventListener("load",n)})).then(function(){return s.getOpt(t).map(function(t){var n=hu({element:a});om.replaceAt(t,1,b.some(n));var r=i.get(),c={x:0,y:0,w:a.dom().naturalWidth,h:a.dom().naturalHeight};i.set(c);var l=qS.inflate(c,-20,-20);return o.set(l),r.w===c.w&&r.h===c.h||function(t,n){s.getOpt(t).each(function(t){var r=ca(t.element()),o=fa(t.element()),i=n.dom().naturalWidth,u=n.dom().naturalHeight,a=Math.min(r/i,o/u);a>=1?e.set(1):e.set(a)})}(t,a),u(t,a),a})})},c=Ih.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:Wu([Hm("image-panel-crop-events",[oi(function(t){s.getOpt(t).each(function(t){var n=function(t,n,e,r,o){var i,u,a,c,s="tox-",l=s+"crid-"+QS++;function f(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}}function d(n,r,o,u){var a,c,s,l,d;a=r.x,c=r.y,s=r.w,l=r.h,a+=o*n.deltaX,c+=u*n.deltaY,(s+=o*n.deltaW)<20&&(s=20),(l+=u*n.deltaH)<20&&(l=20),d=t=qS.clamp({x:a,y:c,w:s,h:l},e,"move"===n.name),d=f(e,d),i.fire("updateRect",{rect:d}),p(d)}function m(t){function e(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),GS("#"+l+"-"+t,r).css({left:n.x,top:n.y,width:n.w,height:n.h})}XS.each(u,function(n){GS("#"+l+"-"+n.name,r).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})}),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)}function g(n){m(t=n)}function p(t){var n,r;g((n=e,{x:(r=t).x+n.x,y:r.y+n.y,w:r.w,h:r.h}))}return u=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],c=["top","right","bottom","left"],GS('<div id="'+l+'" class="'+s+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(r),XS.each(c,function(t){GS("#"+l,r).append('<div id="'+l+"-"+t+'"class="'+s+'croprect-block" style="display: none" data-mce-bogus="all">')}),XS.each(u,function(t){GS("#"+l,r).append('<div id="'+l+"-"+t.name+'" class="'+s+"croprect-handle "+s+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')}),a=XS.map(u,function(n){var e;return new JS(l,{document:r.ownerDocument,handle:l+"-"+n.name,start:function(){e=t},drag:function(t){d(n,e,t.deltaX,t.deltaY)}})}),m(t),GS(r).on("focusin focusout",function(t){GS(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")}),GS(r).on("keydown",function(n){var e;function r(t,n,r,o,i){t.stopPropagation(),t.preventDefault(),d(e,r,o,i)}switch(XS.each(u,function(t){if(n.target.id===l+"-"+t.name)return e=t,!1}),n.keyCode){case YS.LEFT:r(n,0,t,-10,0);break;case YS.RIGHT:r(n,0,t,10,0);break;case YS.UP:r(n,0,t,0,-10);break;case YS.DOWN:r(n,0,t,0,10);break;case YS.ENTER:case YS.SPACEBAR:n.preventDefault(),o()}}),i=XS.extend({toggleVisibility:function(t){var n;n=XS.map(u,function(t){return"#"+l+"-"+t.name}).concat(XS.map(c,function(t){return"#"+l+"-"+t})).join(","),t?GS(n,r).show():GS(n,r).hide()},setClampRect:function(n){e=n,m(t)},setRect:g,getInnerRect:function(){return f(e,t)},setInnerRect:p,setViewPortRect:function(e){n=e,m(t)},destroy:function(){XS.each(a,function(t){t.destroy()}),a=[]}},$S)}({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t.element().dom(),function(){});n.toggleVisibility(!1),n.on("updateRect",function(t){var n=t.rect,r=e.get(),i={x:Math.round(n.x/r),y:Math.round(n.y/r),w:Math.round(n.w/r),h:Math.round(n.h/r)};o.set(i)}),r.set(b.some(n))})})])])}],containerBehaviours:Wu([om.config({}),Hm("image-panel-events",[oi(function(n){a(n,t)})])])}),s=rg(c);return{memContainer:s,updateSrc:a,zoom:function(t,n){var r=e.get(),o=n>0?Math.min(2,r+.1):Math.max(.1,r-.1);e.set(o),s.getOpt(t).each(function(t){var n=t.components()[1].element();u(t,n)})},showCrop:function(){r.get().each(function(t){t.toggleVisibility(!0)})},hideCrop:function(){r.get().each(function(t){t.toggleVisibility(!1)})},getRect:function(){return o.get()},getMeasurements:function(){var t=i.get();return{width:t.w,height:t.h}}}},nC=function(t,n,e,r,o){return TS({name:t,icon:b.some(n),disabled:e,tooltip:b.some(t)},r,o)},eC=function(t,n){n?mp.enable(t):mp.disable(t)},rC=function(t){var n=rg(nC("Undo","undo",!0,function(t){No(t,HS.undo(),{direction:1})},t)),e=rg(nC("Redo","redo",!0,function(t){No(t,HS.redo(),{direction:1})},t));return{container:Ih.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),e.asSpec(),nC("Zoom in","zoom-in",!1,function(t){No(t,HS.zoom(),{direction:1})},t),nC("Zoom out","zoom-out",!1,function(t){No(t,HS.zoom(),{direction:-1})},t)]}),updateButtonUndoStates:function(t,r,o){n.getOpt(t).each(function(t){eC(t,r)}),e.getOpt(t).each(function(t){eC(t,o)})}}},oC=function(){return Yn.getOrDie("URL")},iC=function(t){return oC().createObjectURL(t)},uC=function(t){oC().revokeObjectURL(t)},aC=function(t){var n=Dt(t),e=Dt(b.none()),r=function(){var t=[],n=-1;function e(){return n>0}function r(){return-1!==n&&n<t.length-1}return{data:t,add:function(e){var r;return r=t.splice(++n),t.push(e),{state:e,removed:r}},undo:function(){if(e())return t[--n]},redo:function(){if(r())return t[++n]},canUndo:e,canRedo:r}}();r.add(t);var o=function(t){n.set(t)},i=function(t){return{blob:t,url:iC(t)}},u=function(t){uC(t.url)},a=function(){e.get().each(u),e.set(b.none())},c=function(t){var n=i(t);o(n);var e,a=r.add(n).removed;return e=a,XS.each(e,u),n.url};return{getBlobState:function(){return n.get()},setBlobState:o,addBlobState:c,getTempState:function(){return e.get().fold(function(){return n.get()},function(t){return t})},updateTempState:function(t){var n=i(t);return a(),e.set(b.some(n)),n.url},addTempState:function(t){var n=i(t);return e.set(b.some(n)),n.url},applyTempState:function(t){return e.get().fold(function(){},function(n){c(n.blob),t()})},destroyTempState:a,undo:function(){var t=r.undo();return o(t),t.url},redo:function(){var t=r.redo();return o(t),t.url},getHistoryStates:function(){return{undoEnabled:r.canUndo(),redoEnabled:r.canRedo()}}}},cC=function(e,r){var o=aC(e.currentState),i=function(t){var n=o.getHistoryStates();g.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),No(t,US.formActionEvent,{name:US.saveState(),value:n.undoEnabled})},u=function(t){return t.toBlob()},a=function(t){No(t,US.formActionEvent,{name:US.disable(),value:{}})},c=function(t){p.getApplyButton(t).each(function(t){mp.enable(t)}),No(t,US.formActionEvent,{name:US.enable(),value:{}})},s=function(t,n){return a(t),m.updateSrc(t,n)},l=function(n,e,r,o,l){return a(n),qx(e).then(r).then(u).then(o).then(function(t){return s(n,t).then(function(t){return i(n),l(),c(n),t})}).catch(function(e){t.console.log(e),c(n)})},f=function(t,n,e){var r=o.getBlobState().blob;l(t,r,n,function(t){return o.updateTempState(t)},e)},d=function(t){var n=o.getBlobState().url;return o.destroyTempState(),i(t),n},m=tC(e.currentState.url),g=rC(r),p=WS(m,r);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[p.memContainer.asSpec(),m.memContainer.asSpec(),g.container],behaviours:Wu([vm.config({store:{mode:"manual",getValue:function(){return o.getBlobState()}}}),Hm("image-tools-events",[Yo(HS.undo(),function(t,n){var e=o.undo();s(t,e).then(function(n){c(t),i(t)})}),Yo(HS.redo(),function(t,n){var e=o.redo();s(t,e).then(function(n){c(t),i(t)})}),Yo(HS.zoom(),function(t,n){var e=n.event().direction();m.zoom(t,e)}),Yo(HS.back(),function(t,n){!function(t){var n=d(t);s(t,n).then(function(n){c(t)})}(t),n.event().swap()(),m.hideCrop()}),Yo(HS.apply(),function(t,n){o.applyTempState(function(){d(t),n.event().swap()()})}),Yo(HS.transform(),function(t,e){return f(t,e.event().transform(),n)}),Yo(HS.tempTransform(),function(t,e){return function(t,e){var r=o.getTempState().blob;l(t,r,e,function(t){return o.addTempState(t)},n)}(t,e.event().transform())}),Yo(HS.transformApply(),function(t,n){return function(t,n,e){var r=o.getBlobState().blob;l(t,r,n,function(n){var e=o.addBlobState(n);return d(t),e},e)}(t,n.event().transform(),n.event().swap())}),Yo(HS.swap(),function(t,n){!function(t){g.updateButtonUndoStates(t,!1,!1)}(t);var e=n.event().transform(),r=n.event().swap();e.fold(function(){r()},function(n){f(t,n,r)})})]),ax()])}},sC=zl({name:"HtmlSelect",configFields:[oo("options"),Ls("selectBehaviours",[Sm,vm]),yo("selectClasses",[]),yo("selectAttributes",{}),mo("data")],factory:function(t,n){var e=B(t.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),r=t.data.map(function(t){return Ot("initialValue",t)}).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:Vs(t.selectBehaviours,[Sm.config({}),vm.config({store:$e({mode:"manual",getValue:function(t){return au(t.element())},setValue:function(n,e){L(t.options,function(t){return t.value===e}).isSome()&&cu(n.element(),e)}},r)})])}}}),lC=function(t,n){var e=t.label.map(function(t){return zv(t,n)}),r=[Qd.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Bo(t,Yh),b.some(!0)}}),Hm("textfield-change",[Yo(Wt(),function(n,e){No(n,Gh,{name:t.name})}),Yo(wn(),function(n,e){No(n,Gh,{name:t.name})})]),fb.config({})],o=t.validation.map(function(t){return cb.config({getRoot:function(t){return ce(t.element())},invalidClass:"tox-invalid",validator:{validate:function(n){var e=vm.getValue(n),r=t.validator(e);return gv.pure(!0===r?gt.value(e):gt.error(r))},validateOnLoad:t.validateOnLoad}})}).toArray(),i=ev.parts().field({tag:!0===t.multiline?"textarea":"input",inputAttributes:t.placeholder.fold(function(){},function(t){return{placeholder:n.translate(t)}}),inputClasses:[t.classname],inputBehaviours:Wu(j([r,o])),selectOnFocus:!1,factory:Xv}),u=t.flex?["tox-form__group--stretched"]:[];return Pv(e,i,u)},fC=function(n){return $e({},n,{toCached:function(){return fC(n.toCached())},bindFuture:function(t){return fC(n.bind(function(n){return n.fold(function(t){return gv.pure(gt.error(t))},function(n){return t(n)})}))},bindResult:function(t){return fC(n.map(function(n){return n.bind(t)}))},mapResult:function(t){return fC(n.map(function(n){return n.map(t)}))},mapError:function(t){return fC(n.map(function(n){return n.mapError(t)}))},foldResult:function(t,e){return n.map(function(n){return n.fold(t,e)})},withTimeout:function(e,r){return fC(gv.nu(function(o){var i=!1,u=t.setTimeout(function(){i=!0,o(gt.error(r()))},e);n.get(function(n){i||(t.clearTimeout(u),o(n))})}))}})},dC=function(t){return fC(gv.nu(t))},mC=dC,gC={type:"separator"},pC=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}},hC=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:function(){}}},vC=function(t,n){return function(t){return B(t,pC)}(function(t,n){return M(n,function(n){return n.type===t})}(t,n))},bC=function(t){return vC("header",t.targets)},yC=function(t){return vC("anchor",t.targets)},wC=function(t){return b.from(t.anchorTop).map(function(t){return hC("<top>",t)}).toArray()},xC=function(t){return b.from(t.anchorBottom).map(function(t){return hC("<bottom>",t)}).toArray()},SC=function(t,n){var e=t.toLowerCase();return M(n,function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return sn(n.toLowerCase(),e)||sn(t.value.toLowerCase(),e)})},CC=function(t,n,e){var r=vm.getValue(n),o=void 0!==r.meta.text?r.meta.text:r.value;return e.getLinkInformation().fold(function(){return[]},function(n){var r,i=SC(o,function(t){return B(t,function(t){return hC(t,t)})}(e.getHistory(t)));return"file"===t?(r=[i,SC(o,bC(n)),SC(o,j([wC(n),yC(n),xC(n)]))],P(r,function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(gC,n)},[])):i})},OC=function(t,e,r){var o,i=function(n){var e=vm.getValue(n);r.addToHistory(e.value,t.filetype)},u=ev.parts().field({factory:Fv,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],minChars:0,responseTime:0,fetch:function(n){var o=CC(t.filetype,n,r),i=$v(o,xp.BUBBLE_TO_SANDBOX,e.providers);return gv.pure(i)},getHotspot:function(t){return d.getOpt(t)},onSetValue:function(t,e){t.hasConfigured(cb)&&cb.run(t).get(n)},typeaheadBehaviours:Wu(j([r.getValidationHandler().map(function(n){return cb.config({getRoot:function(t){return ce(t.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{},validator:{validate:function(e){var r=vm.getValue(e);return mC(function(o){n({type:t.filetype,url:r.value},function(t){d.getOpt(e).each(function(n){var e=function(t,n,e){(e?Wi:Gi)(t.element(),n)};e(n,"tox-control-wrap--status-valid","valid"===t.status),e(n,"tox-control-wrap--status-unknown","unknown"===t.status)}),o(("invalid"===t.status?gt.error:gt.value)(t.message))})})},validateOnLoad:!1}})}).toArray(),[fb.config({}),Hm("urlinput-events",j(["file"===t.filetype?[Yo(Wt(),function(n){No(n,Gh,{name:t.name})})]:[],[Yo(Gt(),function(n){No(n,Gh,{name:t.name}),i(n)}),Yo(wn(),function(n){No(n,Gh,{name:t.name}),i(n)})]]))]])),eventOrder:(o={},o[Wt()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"dog"},lazySink:e.getSink,parts:{menu:Yp(0,0,"normal")},onExecute:function(t,n,e){No(n,Yh,{})},onItemExecute:function(n,e,r,o){i(n),No(n,Gh,{name:t.name})}}),a=t.label.map(function(t){return zv(t,e.providers)}),c=function(t,n,r){return void 0===n&&(n=t),void 0===r&&(r=t),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],innerHtml:ig(n,e.providers.icons),attributes:{title:e.providers.translate(r)}}}},s=rg({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[c("valid","checkmark","valid"),c("unknown","warning"),c("invalid","warning")]}),l=r.getUrlPicker(t.filetype),f=Ge("browser.url.event"),d=rg({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,s.asSpec()]});return ev.sketch({dom:Vv([]),components:a.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:j([[d.asSpec()],l.map(function(){return n=t.label,r=f,o="tox-browse-url",i="browse",u=e.providers,eg.sketch({dom:{tag:"button",classes:["tox-tbtn",o],innerHtml:ig(i,u.icons),attributes:{title:u.translate(n.getOr(""))}},buttonBehaviours:Wu([fb.config({})]),action:function(t){Bo(t,r)}});var n,r,o,i,u}).toArray()])}]),fieldBehaviours:Wu([Hm("url-input-events",[Yo(f,function(n){ql.getCurrent(n).each(function(e){var r=vm.getValue(e);l.each(function(o){o(r).get(function(r){vm.setValue(e,r),No(n,Gh,{name:t.name})})})})})])])})},kC=function(t,n){var e,r,o=t.label.map(function(t){return zv(t,n)}),u=function(t){return function(n,e){Cu(e.event().target(),"[data-collection-item-value]").each(function(e){t(n,e,Re(e,"data-collection-item-value"))})}},a=[Yo(Ht(),u(function(t,n){bf(n)})),Yo(kn(),u(function(n,e,r){No(n,Xh,{name:t.name,value:r})})),Yo(Vt(),u(function(t,n,e){Su(t.element(),"."+Wg).each(function(t){Gi(t,Wg)}),Wi(n,Wg)})),Yo(zt(),u(function(t,n,e){Su(t.element(),"."+Wg).each(function(t){Gi(t,Wg)})})),ai(u(function(n,e,r){No(n,Xh,{name:t.name,value:r})}))],c=ev.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:i},behaviours:Wu([om.config({}),vm.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){!function(n,e){var r=B(e,function(n){var e,r=1===t.columns?'<div class="tox-collection__item-label">'+n.text+"</div>":"",o='<div class="tox-collection__item-icon">'+n.icon+"</div>",i={_:" "," - ":" ","-":" "},u=n.text.replace(/\_| \- |\-/g,function(t){return i[t]});return'<div class="tox-collection__item" tabindex="-1" data-collection-item-value="'+('"'===(e=n.value)?"&quot;":e)+'" title="'+u+'" aria-label="'+u+'">'+o+r+"</div>"}),o=t.columns>1&&"auto"!==t.columns?R(r,t.columns):[r],i=B(o,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"});we(n.element(),i.join(""))}(n,e),"auto"===t.columns&&Ag(n,5,"tox-collection__item").each(function(t){var e=t.numRows,r=t.numColumns;Qd.setGridSize(n,e,r)}),Bo(n,Qh)}}),fb.config({}),Qd.config((e=t.columns,r="normal",1===e?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===r?".tox-swatches__row":".tox-collection__group",cell:"color"===r?".tox-swatch":".tox-collection__item"}})),Hm("collection-events",a)])});return Pv(o,c,["tox-form__group--collection"])},TC=function(t){return function(n,e,r){return Ct(e,"name").fold(function(){return t(e,r)},function(o){return n.field(o,t(e,r))})}},EC={bar:TC(function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-bar"]},components:B(t.items,n.interpreter)}}(t,n.shared)}),collection:TC(function(t,n){return kC(t,n.shared.providers)}),alloy:TC(i),alertbanner:TC(function(t,n){return function(t,n){return Ih.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[eg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:ig(t.icon,n.icons),attributes:{title:n.translate(t.actionLabel)}},action:function(n){No(n,Xh,{name:"alert-banner",value:t.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})}(t,n.shared.providers)}),input:TC(function(t,n){return function(t,n){return lC({name:t.name,multiline:!1,label:t.label,placeholder:t.placeholder,flex:!1,classname:"tox-textfield",validation:b.none()},n)}(t,n.shared.providers)}),textarea:TC(function(t,n){return function(t,n){return lC({name:t.name,multiline:!0,label:t.label,placeholder:t.placeholder,flex:!0,classname:"tox-textarea",validation:b.none()},n)}(t,n.shared.providers)}),listbox:TC(function(t,n){return function(t,n){var e=zv(t.label,n),r=ev.parts().field({factory:sC,dom:{classes:["mce-select-field"]},selectBehaviours:Wu([fb.config({})]),options:t.values,data:t.initialValue.getOr(void 0)});return Lv(b.some(e),r)}(t,n.shared.providers)}),label:TC(function(t,n){return function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},r=B(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(r),behaviours:Wu([ax(),om.config({}),vx(b.none()),Qd.config({mode:"acyclic"})])}}(t,n.shared)}),iframe:function(t){return function(n,e,r){var o=bt(e,{source:"dynamic"});return TC(t)(n,o,r)}}(function(t,n){return Dx(t,n.shared.providers)}),autocomplete:TC(function(t,n){return function(t,n){var e=zv(t.label.getOr("?"),n.providers),r=ev.parts().field({factory:Fv,dismissOnBlur:!1,inputClasses:["tox-textfield"],minChars:1,fetch:function(e){var r=vm.getValue(e),o=t.getItems(r),i=$v(o,xp.BUBBLE_TO_SANDBOX,n.providers);return gv.pure(i)},markers:{openClass:"dog"},lazySink:n.getSink,parts:{menu:Yp(0,0,"normal")}});return Lv(b.some(e),r)}(t,n.shared)}),button:TC(function(t,n){return function(t,n){var e=DS(t.name,"custom");return ES(t,e,n,[bx(""),ax()])}(t,n.shared.providers)}),checkbox:TC(function(t,n){return function(t,n){var e=vm.config({store:{mode:"manual",getValue:function(t){return t.element().dom().checked},setValue:function(t,n){t.element().dom().checked=n}}}),r=function(t){return t.element().dom().click(),b.some(!0)},o=ev.parts().field({factory:{sketch:i},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Wu([ax(),fb.config({}),Sm.config({}),e,Qd.config({mode:"special",onEnter:r,onSpace:r,stopSpaceKeyup:!0}),Hm("checkbox-events",[Yo(Gt(),function(n,e){No(n,Gh,{name:t.name})})])])}),u=ev.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:Wu([ey.config({})])}),a=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:ig("checked"===t?"selected":"unselected",n.icons)}}},c=rg({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return ev.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[o,c.asSpec(),u]})}(t,n.shared.providers)}),colorinput:TC(function(t,n){return uy(t,n.shared,n.colorinput)}),colorpicker:TC(function(n){var e=function(t){return"tox-"+t},r=ux(fx,e),o=rg(r.sketch({dom:{tag:"div",classes:[e("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){No(t,Xh,{name:"hex-valid",value:!0})},onInvalidHex:function(t){No(t,Xh,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:Wu([vm.config({store:{mode:"manual",getValue:function(t){var n=o.get(t);return ql.getCurrent(n).bind(function(t){return vm.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(n,e){var r=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(e),i=o.get(n);ql.getCurrent(i).fold(function(){t.console.log("Can not find form")},function(t){vm.setValue(t,{hex:b.from(r[1]).getOr("")}),tx.getField(t,"hex").each(function(t){Bo(t,Wt())})})}}}),ax()])}}),dropzone:TC(function(t,n){return yx(t,n.shared.providers)}),grid:TC(function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:B(t.items,n.interpreter)}}(t,n.shared)}),selectbox:TC(function(t,n){return function(t,n){var e=B(t.items,function(t){return{text:n.translate(t.text),value:t.value}}),r=t.label.map(function(t){return zv(t,n)}),o=ev.parts().field({dom:{},selectAttributes:{size:t.size},options:e,factory:sC,selectBehaviours:Wu([fb.config({}),Hm("selectbox-change",[Yo(Gt(),function(n,e){No(n,Gh,{name:t.name})})])])}),i=t.size>1?b.none():b.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:ig("chevron-down",n.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:j([[o],i.toArray()])};return ev.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:j([r.toArray(),[u]])})}(t,n.shared.providers)}),sizeinput:TC(function(t,n){return LS(t,n.shared.providers)}),urlinput:TC(function(t,n){return OC(t,n.shared,n.urlinput)}),customeditor:TC(function(t){var n=Dt(b.none()),e=rg({dom:{tag:t.tag}}),r=Dt(b.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Wu([Hm("editor-foo-events",[oi(function(o){e.getOpt(o).each(function(e){t.init(e.element().dom()).then(function(t){r.get().each(function(n){t.setValue(n)}),r.set(b.none()),n.set(b.some(t))})})})]),vm.config({store:{mode:"manual",getValue:function(){return n.get().fold(function(){return r.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,e){n.get().fold(function(){r.set(b.some(e))},function(t){return t.setValue(e)})}}}),ax()]),components:[e.asSpec()]}}),htmlpanel:TC(function(t){return"presentation"===t.presets?Ih.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):Ih.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Wu([fb.config({}),Sm.config({})])})}),imagetools:TC(function(t,n){return cC(t,n.shared.providers)}),table:TC(function(t,n){return function(t,n){var e,r,o=function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}},i=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}},u=function(t){return{dom:{tag:"tr"},components:B(t,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(r=t.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:B(r,o)}]}),(e=t.cells,{dom:{tag:"tbody"},components:B(e,u)})],behaviours:Wu([fb.config({}),Sm.config({})])}}(t,n.shared.providers)})},DC={field:function(t,n){return n}},AC=function(t,n,e){var r=bt(e,{shared:{interpreter:function(n){return RC(t,n,r)}}});return RC(t,n,r)},RC=function(n,e,r){return Ct(EC,e.type).fold(function(){return t.console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e},function(t){return t(n,e,r)})},BC=function(t){return t.y()},NC=function(t,n,e){return Za(function(t){return t.x()}(t),BC(t),e.northeast(),ba(),"layout-ne")},_C=function(t,n,e){return Za(function(t,n){return t.x()+t.width()-n.width()}(t,n),BC(t),e.northwest(),ya(),"layout-nw")},IC=function(t,n,e){return Za(function(t,n){return t.x()+t.width()/2-n.width()/2}(t,n),BC(t),e.north(),xa(),"layout-n")},MC={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},FC=function(t,n,e){return e?function(){return{anchor:"node",root:t(),node:b.from(t()),bubble:Ka(-12,-12,MC),layouts:{onRtl:function(){return[NC]},onLtr:function(){return[_C]}}}}:function(){return{anchor:"hotspot",hotspot:n(),bubble:Ka(-12,12,MC),layouts:{onRtl:function(){return[ic]},onLtr:function(){return[uc]}}}}},PC=function(t,n,e){return e?function(){return{anchor:"node",root:t(),node:b.from(t()),layouts:{onRtl:function(){return[IC]},onLtr:function(){return[IC]}}}}:function(){return{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[lc]},onLtr:function(){return[lc]}}}}},LC=function(t){return function(){return{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[ic]},onLtr:function(){return[uc]}}}}},HC=function(t,n){return function(){return{anchor:"selection",root:n(),getSelection:function(){var n=t.selection.getRng();return b.some(Cc(jn.fromDom(n.startContainer),n.startOffset,jn.fromDom(n.endContainer),n.endOffset))}}}},VC=function(t){return function(n){return{anchor:"node",root:t(),node:n}}},zC=function(t,n,e){var r=Wh(t),o=function(){return jn.fromDom(t.getBody())};return{toolbar:FC(o,n,r),toolbarOverflow:LC(e),banner:PC(o,n,e),cursor:HC(t,o),node:VC(o)}},jC=function(t){return function(n,e){Jb.colorPickerDialog(t)(n,e)}},UC=function(t){return function(){return Hb(t)}},WC=function(t){return function(){return Vb(t)}},GC=function(t){return{colorPicker:jC(t),hasCustomColors:UC(t),getColors:WC(t)}},qC=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strike-through",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}]}],$C=function(t){return P(t,function(t,n){if(ct(n,"items")){var e=$C(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(function(t){return ct(t,"inline")}(n)||function(t){return ct(t,"block")}(n)||function(t){return ct(t,"selector")}(n)){var r="custom-"+n.title.toLowerCase();return{customFormats:t.customFormats.concat([{name:r,format:n}]),formats:t.formats.concat([{title:n.title,format:r,icon:n.icon}])}}return $e({},t,{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},XC=function(t){return function(t){return b.from(t.getParam("style_formats")).filter(S)}(t).map(function(n){var e=function(t,n){var e=$C(n),r=function(n){N(n,function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)})};return t.formatter?r(e.customFormats):t.on("init",function(){r(e.customFormats)}),e.formats}(t,n);return function(t){return t.getParam("style_formats_merge",!1,"boolean")}(t)?qC.concat(e):e}).getOr(qC)},YC=function(t,n,e){var r={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return bt(t,r)},KC=function(t,n,e,r){var i=function(n){return B(n,function(n){var u=Q(n);if(Et(n,"items")){var a=i(n.items);return bt(function(t){var n={type:"submenu",isSelected:o(!1),getStylePreview:function(){return b.none()}};return bt(t,n)}(n),{getStyleItems:function(){return a}})}return Et(n,"format")?function(t){return YC(t,e,r)}(n):1===u.length&&D(u,"title")?bt(n,{type:"separator"}):function(n){var o=Ge(n.title),i={type:"formatter",format:o,isSelected:e(o),getStylePreview:r(o)},u=bt(n,i);return t.formatter.register(o,u),u}(n)})};return i(n)},JC=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?b.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)}):b.none()}},r=function(t){var n=t.items;return void 0!==n&&n.length>0?U(n,r):[t.format]},o=Dt([]),i=Dt([]),u=Dt([]),a=Dt([]),c=Dt(!1);return t.on("init",function(){var u=XC(t),a=KC(t,u,n,e);o.set(a),i.set(U(a,r))}),t.on("addStyleModifications",function(o){var i=KC(t,o.items,n,e);u.set(i),c.set(o.replace),a.set(U(i,r))}),{getData:function(){var t=c.get()?[]:o.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}},ZC=XS.trim,QC=function(t){return function(n){if(n&&1===n.nodeType){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},tO=QC("true"),nO=QC("false"),eO=function(t,n,e,r,o){return{type:t,title:n,url:e,level:r,attach:o}},rO=function(t){return t.innerText||t.textContent},oO=function(t){return function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)}(t)&&uO(t)},iO=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},uO=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return tO(t)}return!1}(t)&&!nO(t)},aO=function(t){return iO(t)&&uO(t)},cO=function(t){var n=function(t){return t.id?t.id:Ge("h")}(t);return eO("header",rO(t),"#"+n,function(t){return iO(t)?parseInt(t.nodeName.substr(1),10):0}(t),function(){t.id=n})},sO=function(t){var e=t.id||t.name,r=rO(t);return eO("anchor",r||"#"+e,"#"+e,0,n)},lO=function(t){var n,e;return n="h1,h2,h3,h4,h5,h6,a:not([href])",e=t,B(Ic(jn.fromDom(e),n),function(t){return t.dom()})},fO=function(t){return ZC(t.title).length>0},dO=function(t){var n=lO(t);return M(function(t){return B(M(t,aO),cO)}(n).concat(function(t){return B(M(t,oO),sO)}(n)),fO)},mO="tinymce-url-history",gO=function(t){return w(t)&&/^https?/.test(t)},pO=function(t){return x(t)&&it(t,function(t){return!(S(n=t)&&n.length<=5&&W(n,gO));var n}).isNone()},hO=function(){var n,e=t.localStorage.getItem(mO);if(null===e)return{};try{n=JSON.parse(e)}catch(n){if(n instanceof SyntaxError)return t.console.log("Local storage "+mO+" was not valid JSON",n),{};throw n}return pO(n)?n:(t.console.log("Local storage "+mO+" was not valid format",n),{})},vO=function(t){var n=hO();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},bO=function(n,e){if(gO(n)){var r=hO(),o=Object.prototype.hasOwnProperty.call(r,e)?r[e]:[],i=M(o,function(t){return t!==n});r[e]=[n].concat(i).slice(0,5),function(n){if(!pO(n))throw new Error("Bad format for history:\n"+JSON.stringify(n));t.localStorage.setItem(mO,JSON.stringify(n))}(r)}},yO=Object.prototype.hasOwnProperty,wO=function(t){return!!t},xO=function(t){return et(XS.makeMap(t,/[, ]/),wO)},SO=function(t,n,e){var r,o,i=(r=t,o=n,yO.call(r,o)?b.some(r[o]):b.none()).getOr(e);return w(i)?b.some(i):b.none()},CO=function(t){return b.some(t.file_picker_callback).filter(O)},OO=function(t,n){var e=function(t){var n=b.some(t.file_picker_types).filter(wO),e=b.some(t.file_browser_callback_types).filter(wO),r=n.or(e).map(xO);return CO(t).fold(function(){return!1},function(t){return r.fold(function(){return!0},function(t){return Q(t).length>0&&t})})}(t);return C(e)?e?CO(t):b.none():e[n]?CO(t):b.none()},kO=function(t){return{getHistory:vO,addToHistory:bO,getLinkInformation:function(){return function(t){return!1===t.settings.typeahead_urls?b.none():b.some({targets:dO(t.getBody()),anchorTop:SO(t.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:SO(t.settings,"anchor_bottom","#bottom").getOrUndefined()})}(t)},getValidationHandler:function(){return function(t){var n=t.settings.filepicker_validator_handler;return O(n)?b.some(n):b.none()}(t)},getUrlPicker:function(n){return function(t,n){return OO(t.settings,n).map(function(e){return function(r){return gv.nu(function(o){var i=XS.extend({filetype:n},b.from(r.meta).getOr({}));e.call(t,function(t,n){if(!w(t))throw new Error("Expected value to be string");if(void 0!==n&&!x(n))throw new Error("Expected meta to be a object");o({value:t,meta:n})},r.value,i)})}})}(t,n)}}},TO=function(t,n,e,r){var o={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:zg.translate},interpreter:function(t){return function(t,n){return RC(DC,t,n)}(t,o)},anchors:zC(n,e,r),getSink:function(){return gt.value(t)}},urlinput:kO(n),styleselect:JC(n),colorinput:GC(n)};return o},EO=Un("within","extra","withinWidth"),DO=function(t,n,e){var r,i=(r=function(t,n){var r=e(t);return b.some({element:o(t),start:o(n),finish:o(n+r),width:o(r)})},P(t,function(t,n){return r(n,t.len).fold(o(t),function(n){return{len:n.finish(),list:t.list.concat([n])}})},{len:0,list:[]}).list),u=M(i,function(t){return t.finish()<=n}),a=F(u,function(t,n){return t+n.width()},0),c=i.slice(u.length);return{within:o(u),extra:o(c),withinWidth:o(a)}},AO=function(t){return B(t,function(t){return t.element()})},RO=function(t,n,e,r){var o=function(t,n,e){var r=DO(n,t,e);return 0===r.extra().length?b.some(r):b.none()}(t,n,e).getOrThunk(function(){return DO(n,t-e(r),e)}),i=o.within(),u=o.extra(),a=o.withinWidth();return 1===u.length&&u[0].width()<=e(r)?function(t,n,e){var r=AO(t.concat(n));return EO(r,[],e)}(i,u,a):u.length>=1?function(t,n,e,r){var o=AO(t).concat([e]);return EO(o,AO(n),r)}(i,u,r,a):function(t,n,e){return EO(AO(t),[],e)}(i,0,a)},BO=function(t,n){return n.getAnimationRoot.fold(function(){return t.element()},function(n){return n(t)})},NO=function(t){return t.dimension.property},_O=function(t,n){return t.dimension.getDimension(n)},IO=function(t,n){var e=BO(t,n);Xi(e,[n.shrinkingClass,n.growingClass])},MO=function(t,n){Gi(t.element(),n.openClass),Wi(t.element(),n.closedClass),Zi(t.element(),NO(n),"0px"),uu(t.element())},FO=function(t,n){Gi(t.element(),n.closedClass),Wi(t.element(),n.openClass),iu(t.element(),NO(n))},PO=function(t,n,e,r){e.setCollapsed(),Zi(t.element(),NO(n),_O(n,t.element())),uu(t.element()),IO(t,n),MO(t,n),n.onStartShrink(t),n.onShrunk(t)},LO=function(t,n,e,r){var o=r.getOrThunk(function(){return _O(n,t.element())});e.setCollapsed(),Zi(t.element(),NO(n),o),uu(t.element());var i=BO(t,n);Gi(i,n.growingClass),Wi(i,n.shrinkingClass),MO(t,n),n.onStartShrink(t)},HO=function(t,n,e){var r=_O(n,t.element());("0px"===r?PO:LO)(t,n,e,b.some(r))},VO=function(t,n,e){var r=BO(t,n),o=qi(r,n.shrinkingClass),i=_O(n,t.element());FO(t,n);var u=_O(n,t.element());(o?function(){Zi(t.element(),NO(n),i),uu(t.element())}:function(){MO(t,n)})(),Gi(r,n.shrinkingClass),Wi(r,n.growingClass),FO(t,n),Zi(t.element(),NO(n),u),e.setExpanded(),n.onStartGrow(t)},zO=function(t,n,e){var r=BO(t,n);return!0===qi(r,n.growingClass)},jO=function(t,n,e){var r=BO(t,n);return!0===qi(r,n.shrinkingClass)},UO=Object.freeze({refresh:function(t,n,e){if(e.isExpanded()){iu(t.element(),NO(n));var r=_O(n,t.element());Zi(t.element(),NO(n),r)}},grow:function(t,n,e){e.isExpanded()||VO(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&HO(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&PO(t,n,e,b.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:zO,isShrinking:jO,isTransitioning:function(t,n,e){return!0===zO(t,n)||!0===jO(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?HO:VO)(t,n,e)},disableTransitions:IO}),WO=Object.freeze({exhibit:function(t,n){var e=n.expanded;return Ri(e?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Ot(n.dimension.property,"0px")})},events:function(t,n){return Go([ri($t(),function(e,r){r.event().raw().propertyName===t.dimension.property&&(IO(e,t),n.isExpanded()&&iu(e.element(),t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))})])}}),GO=[oo("closedClass"),oo("openClass"),oo("shrinkingClass"),oo("growingClass"),mo("getAnimationRoot"),_u("onShrunk"),_u("onStartShrink"),_u("onGrown"),_u("onStartGrow"),yo("expanded",!1),io("dimension",Kr("property",{width:[Pu("property","width"),Pu("getDimension",function(t){return ca(t)+"px"})],height:[Pu("property","height"),Pu("getDimension",function(t){return fa(t)+"px"})]}))],qO=qu({fields:GO,name:"sliding",active:WO,apis:UO,state:Object.freeze({init:function(t){var n=Dt(t.expanded);return Di({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:u(n.set,!1),setExpanded:u(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),$O=o([yo("shell",!0),Ls("toolbarBehaviours",[om])]),XO=o([ml({name:"groups",overrides:function(t){return{behaviours:Wu([om.config({})])}}})]),YO=jl({name:"Toolbar",configFields:$O(),partFields:XO(),factory:function(n,e,r,o){var i=function(t){return n.shell?b.some(t):kl(t,n,"groups")},u=n.shell?{behaviours:[om.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:u.components,behaviours:Vs(n.toolbarBehaviours,u.behaviours),apis:{setGroups:function(n,e){i(n).fold(function(){throw t.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){om.set(t,e)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),KO=o([Bu(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Ls("splitToolbarBehaviours",[]),Eo("builtGroups",function(){return Dt([])}),yo("overflow",function(t){return b.none()}),Oo("floating",!1)]),JO=[oo("dom"),yo("overflow",function(t){return b.none()}),Oo("floating",!1)],ZO=o([fl({factory:YO,schema:JO,name:"primary"}),ml({factory:YO,schema:JO,name:"overflow",overrides:function(t){return{toolbarBehaviours:Wu([qO.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass}),Qd.config({mode:"acyclic",onEscape:function(n){return kl(n,t,"overflow-button").each(Qd.focusIn),b.some(!0)}})])}}}),dl({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Wu([Im.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"}})])}}}),dl({name:"overflow-group"})]),QO=o([oo("items"),Bu(["itemSelector"]),Ls("tgroupBehaviours",[Qd])]),tk=o([gl({name:"items",unit:"item"})]),nk=jl({name:"ToolbarGroup",configFields:QO(),partFields:tk(),factory:function(t,n,e,r){return{uid:t.uid,dom:t.dom,components:n,behaviours:Vs(t.tgroupBehaviours,[Qd.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),ek=function(t,n){var e=B(n,function(t){return yu(t)});YO.setGroups(t,e)},rk=function(t,n,e,r){var o=Tl(t,n,"primary"),i=kl(t,n,"overflow").orThunk(function(){return n.overflow(t)});Zi(o.element(),"visibility","hidden"),i.each(function(t){YO.setGroups(t,[])});var u=n.builtGroups.get(),a=nk.sketch($e({},e["overflow-group"](),{items:[eg.sketch($e({},e["overflow-button"](),{action:function(e){!0===n.floating?Bo(t,r):i.each(function(t){qO.toggleGrow(t)})}}))]})),c=t.getSystem().build(a);ek(o,u.concat([c]));var s=ca(o.element()),l=RO(s,u,function(t){return ca(t.element())},c);0===l.extra().length?(om.remove(o,c),i.each(function(t){YO.setGroups(t,[])})):(ek(o,l.within()),i.each(function(t){ek(t,l.extra())})),iu(o.element(),"visibility"),uu(o.element()),i.each(function(e){n.floating||qO.refresh(e),kl(t,n,"overflow-button").each(function(t){n.floating?Im.set(t,e.getSystem().isConnected()):(Im.set(t,qO.hasGrown(e)),Qd.focusIn(e))})})},ok=jl({name:"SplitToolbar",configFields:KO(),partFields:ZO(),factory:function(t,n,e,r){return{uid:t.uid,dom:t.dom,components:n,behaviours:Vs(t.splitToolbarBehaviours,[]),apis:{setGroups:function(n,e){!function(n,e){var r=B(e,n.getSystem().build);t.builtGroups.set(r)}(n,e),rk(n,t,r,"alloy.toolbar.toggle")},refresh:function(n){rk(n,t,r,"alloy.toolbar.toggle")},getMoreButton:function(n){return function(n){return kl(n,t,"overflow-button")}(n)},getOverflow:function(n){return function(n){return kl(n,t,"overflow").orThunk(function(){return t.overflow(n)})}(n)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},getMoreButton:function(t,n){return t.getMoreButton(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),ik=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:$e({tag:"div",classes:["tox-toolbar__group"]},n),components:[nk.parts().items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Wu([fb.config({}),Sm.config({})])}},uk=function(t){return nk.sketch(ik(t))},ak=function(t,n,e){var r=oi(function(n){var e=B(t.initGroups,uk);YO.setGroups(n,e)}),o=e.fold(function(){return[r]},function(n){return[r,Yo("alloy.toolbar.toggle",function(e,r){t.getSink().toOption().each(function(r){n.getOpt(r).fold(function(){var o=bu(n.asSpec());hs(r,o),ms.position(r,t.backstage.shared.anchors.toolbarOverflow(),o),ok.refresh(e),ok.getMoreButton(e).each(Sm.focus),Qd.focusIn(o)},function(t){ys(t)})})})]});return Wu([Qd.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),Hm("toolbar-events",o)])},ck=function(t){var n=t.cyclicKeying?"cyclic":"acyclic",e=rg(YO.sketch({dom:{tag:"div",classes:["tox-toolbar__overflow"]},toolbarBehaviours:Wu([Qd.config({mode:"cyclic",onEscape:function(){return Bo(t.moreDrawerData.lazyToolbar(),"alloy.toolbar.toggle"),Qd.focusIn(t.moreDrawerData.lazyMoreButton()),b.some(!0)}})])})),r=ok.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),o=t.moreDrawerData.floating?[r]:[r,ok.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}})];return ok.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},floating:t.moreDrawerData.floating,overflow:function(n){return t.getSink().toOption().bind(function(r){return e.getOpt(r).bind(function(e){return ok.getMoreButton(n).bind(function(n){return e.getSystem().isConnected()?(ms.position(r,t.backstage.shared.anchors.toolbarOverflow(),e),b.some(e)):b.none()})})})},parts:{"overflow-group":ik({title:b.none(),items:[]}),"overflow-button":kS({name:"more",icon:b.some("more-drawer"),disabled:!1,tooltip:b.some("More...")},b.none(),t.backstage.shared.providers)},components:o,markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},splitToolbarBehaviours:ak(t,n,b.some(e))})},sk=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return YO.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"]},components:[YO.parts().groups({})],toolbarBehaviours:ak(t,n,b.none())})},lk=[Oo("disabled",!1),ho("tooltip"),ho("icon"),ho("text"),ko("onSetup",function(){return n})],fk=Br([uo("type"),co("onAction")].concat(lk)),dk=function(t){return qr("toolbarbutton",fk,t)},mk=Br([uo("type"),ho("tooltip"),ho("icon"),ho("text"),co("fetch"),ko("onSetup",function(){return n})]),gk=function(t){return qr("menubutton",mk,t)},pk=Br([uo("type"),ho("tooltip"),ho("icon"),ho("text"),vo("select"),co("fetch"),ko("onSetup",function(){return n}),Co("presets","normal",["normal","color","listpreview"]),yo("columns",1),co("onAction"),co("onItemAction")]),hk=[Oo("active",!1)].concat(lk),vk=Br(hk.concat([uo("type"),co("onAction")])),bk=function(t){return qr("ToggleButton",vk,t)},yk=[ko("predicate",function(){return!1}),Co("scope","node",["node","editor"]),Co("position","selection",["node","selection","line"])],wk=lk.concat([yo("type","contextformbutton"),yo("primary",!1),co("onAction"),Eo("original",i)]),xk=hk.concat([yo("type","contextformbutton"),yo("primary",!1),co("onAction"),Eo("original",i)]),Sk=lk.concat([yo("type","contextformbutton")]),Ck=hk.concat([yo("type","contextformtogglebutton")]),Ok=Kr("type",{contextformbutton:wk,contextformtogglebutton:xk}),kk=Br([yo("type","contextform"),ko("initValue",function(){return""}),ho("label"),fo("commands",Ok),go("launch",Kr("type",{contextformbutton:Sk,contextformtogglebutton:Ck}))].concat(yk)),Tk=Br([yo("type","contexttoolbar"),uo("items")].concat(yk)),Ek=Ge("toolbar.button.execute"),Dk={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},Ak=Object.freeze({getState:function(t,n,e){return e}}),Rk=Object.freeze({events:function(t,n){var e=function(e,r){t.updateState.each(function(t){var o=t(e,r);n.set(o)}),t.renderComponents.each(function(t){var o=t(r,n.get());ws(e),N(o,function(t){hs(e,e.getSystem().build(t))})})};return Go([Yo(xn(),function(n,r){var o=t.channel;D(r.channels(),o)&&e(n,r.data())}),oi(function(n,r){t.initialData.each(function(t){e(n,t)})})])}}),Bk=Object.freeze({init:function(t){var n=Dt(b.none());return{readState:function(){return n.get().getOr("none")},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(b.none())}}}}),Nk=[oo("channel"),mo("renderComponents"),mo("updateState"),mo("initialData")],_k=qu({fields:Nk,name:"reflecting",active:Rk,apis:Ak,state:Bk}),Ik=o([oo("toggleClass"),oo("fetch"),Mu("onExecute"),yo("getHotspot",b.some),yo("layouts",b.none()),Mu("onItemExecute"),mo("lazySink"),oo("dom"),_u("onOpen"),Ls("splitDropdownBehaviours",[iv,Qd,Sm]),yo("matchWidth",!1),yo("useMinWidth",!1),yo("eventOrder",{}),mo("role")].concat(_v())),Mk=fl({factory:eg,schema:[oo("dom")],name:"arrow",defaults:function(t){return{buttonBehaviours:Wu([Sm.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(_o)},buttonBehaviours:Wu([Im.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),Fk=fl({factory:eg,schema:[oo("dom")],name:"button",defaults:function(t){return{buttonBehaviours:Wu([Sm.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(function(e){t.onExecute(e,n)})}}}}),Pk=o([Mk,Fk,ml({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[oo("text")],name:"aria-descriptor"}),dl({schema:[Ru()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each(function(r){t.onItemExecute(r,n,e)})}}}}),hv()]),Lk=jl({name:"SplitDropdown",configFields:Ik(),partFields:Pk(),factory:function(t,e,r,o){var i=function(t){ql.getCurrent(t).each(function(t){uf.highlightFirst(t),Qd.focusIn(t)})},u=function(e){wv(t,function(t){return t},e,o,i,zh.HighlightFirst).get(n)},a=function(n){var e=Tl(n,t,"button");return _o(e),b.some(!0)},c=yt(Go([oi(function(n,e){kl(n,t,"aria-descriptor").each(function(t){var e=Ge("aria");De(t.element(),"id",e),De(n.element(),"aria-describedby",e)})})]),ng(b.some(u)));return{uid:t.uid,dom:t.dom,components:e,eventOrder:$e({},t.eventOrder,{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:c,behaviours:Vs(t.splitDropdownBehaviours,[iv.config({others:{sandbox:function(n){var e=Tl(n,t,"arrow");return Cv(t,n,{onOpen:function(){Im.on(e),Im.on(n)},onClose:function(){Im.off(e),Im.off(n)}})}}}),Qd.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),b.some(!0)}}),Sm.config({}),Im.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}}}),Hk=Ge("update-menu-text"),Vk=Ge("update-menu-icon"),zk=function(t,e,r){var o=Dt(n),i=t.text.map(function(t){return rg(CS(t,e,r.providers))}),u=t.icon.map(function(t){return rg(SS(t,r.providers.icons))}),a=function(t,n){var e=vm.getValue(t);return Sm.focus(e),No(e,"keydown",{raw:n.event().raw()}),ty.close(e),b.some(!0)},c=t.role.fold(function(){return{}},function(t){return{role:t}}),s=t.tooltip.fold(function(){return{}},function(t){var n=r.providers.translate(t);return{title:n,"aria-label":n}});return rg(ty.sketch($e({},c,{dom:{tag:"button",classes:[e,e+"--select"].concat(B(t.classes,function(t){return e+"--"+t})),attributes:$e({},s)},components:Op([u.map(function(t){return t.asSpec()}),i.map(function(t){return t.asSpec()}),b.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:ig("chevron-down",r.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Wu(t.dropdownBehaviours.concat([pp(t.disabled),ey.config({}),om.config({}),Hm("dropdown-events",[bp(t,o),yp(t,o)]),Hm("menubutton-update-display-text",[Yo(Hk,function(t,n){i.bind(function(n){return n.getOpt(t)}).each(function(t){om.set(t,[pu(r.providers.translate(n.event().text()))])})}),Yo(Vk,function(t,n){u.bind(function(n){return n.getOpt(t)}).each(function(t){om.set(t,[SS(n.event().icon(),r.providers.icons)])})})])])),eventOrder:bt(Dk,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Wu([Qd.config({mode:"special",onLeft:a,onRight:a})]),lazySink:r.getSink,toggleClass:e+"--active",parts:{menu:Yp(0,t.columns,t.presets)},fetch:function(){return gv.nu(t.fetch)}}))).asSpec()},jk=function(t){return{isDisabled:function(){return mp.isDisabled(t)},setDisabled:function(n){return mp.set(t,n)}}},Uk=function(t){return{setActive:function(n){Im.set(t,n)},isActive:function(){return Im.isOn(t)},isDisabled:function(){return mp.isDisabled(t)},setDisabled:function(n){return mp.set(t,n)}}},Wk=function(t){return{isDisabled:function(){return mp.isDisabled(t)},setDisabled:function(n){return mp.set(t,n)},setActive:function(n){var e=t.element();n?(Wi(e,"tox-tbtn--enabled"),De(e,"aria-pressed",!0)):(Gi(e,"tox-tbtn--enabled"),Ne(e,"aria-pressed"))},isActive:function(){return qi(t.element(),"tox-tbtn--enabled")}}},Gk=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},qk=Ge("focus-button"),$k=function(t,n,e,r,o,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:Gk(e,i)},components:Op([t.map(function(t){return xS(t,i.icons)}),n.map(function(t){return CS(t,"tox-tbtn",i)})]),eventOrder:(u={},u[Mt()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:Wu([Hm("common-button-display-events",[Yo(Mt(),function(t,n){n.event().prevent(),Bo(t,qk)})])].concat(r.map(function(e){return _k.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return Op([t.icon.map(function(t){return xS(t,i.icons)}),t.text.map(function(t){return CS(t,"tox-tbtn",i)})])}})}).toArray()).concat(o.getOr([])))}},Xk=function(t,e,r){var o,i=Dt(n),u=$k(t.icon,t.text,t.tooltip,b.none(),b.none(),r);return eg.sketch({dom:u.dom,components:u.components,eventOrder:Dk,buttonBehaviours:Wu([Hm("toolbar-button-events",[(o={onAction:t.onAction,getApi:e.getApi},ai(function(t,n){vp(o,t)(function(n){No(t,Ek,{buttonApi:n}),o.onAction(n)})})),bp(e,i),yp(e,i)]),pp(t.disabled)].concat(e.toolbarButtonBehaviours))})},Yk=function(t,n,e){return Xk(t,{toolbarButtonBehaviours:[].concat(e.length>0?[Hm("toolbarButtonWith",e)]:[]),getApi:jk,onSetup:t.onSetup},n)},Kk=function(t,n,e){return bt(Xk(t,{toolbarButtonBehaviours:[om.config({}),Im.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[Hm("toolbarToggleButtonWith",e)]:[]),getApi:Uk,onSetup:t.onSetup},n))},Jk=function(t,n,e){return function(r){return gv.nu(function(t){return n.fetch(t)}).map(function(o){return b.from(ch(bt(uh(Ge("menu-value"),o,function(e){n.onItemAction(t(r),e)},n.columns,n.presets,xp.CLOSE_ON_EXECUTE,n.select.getOr(function(){return!1}),e),{movement:Kp(n.columns,n.presets),menuBehaviours:Bg("auto"!==n.columns?[]:[oi(function(t,e){Ag(t,4,Gg(n.presets)).each(function(n){var e=n.numRows,r=n.numColumns;Qd.setGridSize(t,e,r)})})])})))})}},Zk=function(t,n,e,r){return zk({text:t.text,icon:t.icon,tooltip:t.tooltip,role:r,fetch:function(n){t.fetch(function(t){n($v(t,xp.CLOSE_ON_EXECUTE,e.providers))})},onSetup:t.onSetup,getApi:Wk,columns:1,presets:"normal",classes:[],dropdownBehaviours:[]},n,e)},Qk=function(t,n){return Yo(Ek,function(e,r){var o=function(t){return{hide:function(){return Bo(t,En())},getValue:function(){return vm.getValue(t)}}}(t.get(e));n.onAction(o,r.event().buttonApi())})},tT=function(t,n,e){var r={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?function(t,n,e){var r=n.original,o=(r.primary,Xe(r,["primary"])),i=$r(bk($e({},o,{type:"togglebutton",onAction:function(){}})));return Kk(i,e.backstage.shared.providers,[Qk(t,n)])}(t,n,r):function(t,n,e){var r=n.original,o=(r.primary,Xe(r,["primary"])),i=$r(dk($e({},o,{type:"button",onAction:function(){}})));return Yk(i,e.backstage.shared.providers,[Qk(t,n)])}(t,n,r)},nT=function(t,n){var e=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),r=rg(Xv.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:Wu([Qd.config({mode:"special",onEnter:function(t){return o.findPrimary(t).map(function(t){return _o(t),!0})},onLeft:function(t,n){return n.cut(),b.none()},onRight:function(t,n){return n.cut(),b.none()}})])})),o=function(t,n,e){var r=B(n,function(n){return rg(tT(t,n,e))});return{asSpecs:function(){return B(r,function(t){return t.asSpec()})},findPrimary:function(t){return Rt(n,function(n,e){return n.primary?b.from(r[e]).bind(function(n){return n.getOpt(t)}).filter(s(mp.isDisabled)):b.none()})}}}(r,t.commands,n.shared.providers);return sk({uid:Ge("context-toolbar"),initGroups:[{title:b.none(),items:[r.asSpec()]},{title:b.none(),items:o.asSpecs()}],onEscape:b.none,cyclicKeying:!0,backstage:n,getSink:function(){return gt.error("")}})},eT=Ge("forward-slide"),rT=Ge("backward-slide"),oT=Ge("change-slide-event"),iT=function(t,n){return Rt(n,function(n){return n.predicate(t.dom())?b.some({toolbarApi:n,elem:t}):b.none()})},uT=function(t,n){var e=function(t){return t.dom()===n.getBody()},r=jn.fromDom(n.selection.getNode());return iT(r,t.inNodeScope).orThunk(function(){return iT(r,t.inEditorScope).orThunk(function(){return function(t,n,e){for(var r=t.dom(),i=O(e)?e:o(!1);r.parentNode;){r=r.parentNode;var u=jn.fromDom(r),a=n(u);if(a.isSome())return a;if(i(u))break}return b.none()}(r,function(n){return iT(n,t.inNodeScope)},e)})})},aT=function(t,n){var e={},r=[],o=[],i={},u={},a=function(t,a){var c=$r(qr("ContextForm",kk,a));e[t]=c,c.launch.map(function(e){i["form:"+t]=$e({},a.launch,{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})}),"editor"===c.scope?o.push(c):r.push(c),u[t]=c},c=function(t,n){var e;(e=n,qr("ContextToolbar",Tk,e)).each(function(e){"editor"===n.scope?o.push(e):r.push(e),u[t]=e})},s=Q(t);return N(s,function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)}),{forms:e,inNodeScope:r,inEditorScope:o,lookupTable:u,formNavigators:i}},cT=function(t,n){return function(e){var r=Dt(b.none()),o=function(){e.setActive(t.formatter.match(n));var o=t.formatter.formatChanged(n,e.setActive).unbind;r.set(b.some(o))};return t.initialized?o():t.on("init",o),function(){return r.get().each(function(t){return t()})}}},sT=function(t){return function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)})}}},lT=function(t,n,e){var r=function(t,r,i){var u=n.shared.providers.translate(t.title);if("separator"===t.type)return b.some({type:"separator",text:u});if("submenu"===t.type){var a=U(t.getStyleItems(),function(t){return o(t,r)});return 0===r&&a.length<=0?b.none():b.some({type:"nestedmenuitem",text:u,disabled:a.length<=0,getSubmenuItems:function(){return U(t.getStyleItems(),function(t){return o(t,r)})}})}return b.some($e({type:"togglemenuitem",text:u,active:t.isSelected(),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}})))},o=function(t,n){var o="formatter"===t.type&&e.isInvalid(t);return 0===n?o?[]:r(t,n,!1).toArray():r(t,n,o).toArray()},i=function(t){var n=e.shouldHide?0:1;return U(t,function(t){return o(t,n)})};return{validateItems:i,getFetch:function(t,n){return function(e){var r=n(),o=i(r);e($v(o,xp.CLOSE_ON_EXECUTE,t.shared.providers))}}}},fT=function(t,n,e,r){var o="basic"===e.type?function(){return B(e.data,function(t){return YC(t,r.isSelectedFor,r.getPreviewFor)})}:e.getData;return{items:lT(0,n,r),getStyleItems:o}},dT=function(t,e,r,o){var i=fT(0,e,r,o),u=i.items,a=i.getStyleItems;return zk({text:o.icon.isSome()?b.none():b.some(""),icon:o.icon,tooltip:b.from(o.tooltip),role:b.none(),fetch:u.getFetch(e,a),onSetup:function(e){return o.nodeChangeHandler.map(function(n){var r=n(e.getComponent());return t.on("NodeChange",r),function(){t.off("NodeChange",r)}}).getOr(n)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)};!function(t){t[t.SemiColon=0]="SemiColon",t[t.Space=1]="Space"}(ZS||(ZS={}));var mT,gT=function(t,n,e,r){return{type:"basic",data:function(t){return B(t,function(t){var n=t,e=t,r=t.split("=");return r.length>1&&(n=r[0],e=r[1]),{title:n,format:e}})}(function(t,n){return n===ZS.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")}(Ct(t.settings,n).getOr(e),r))}},pT=[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}],hT=function(t){var n=b.some(function(n){return function(){var e=L(pT,function(n){return t.formatter.match(n.format)}).fold(function(){return"left"},function(t){return t.title.toLowerCase()});No(n,Vk,{icon:"align-"+e})}}),e={type:"basic",data:pT};return{tooltip:"Align",icon:b.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getPreviewFor:function(t){return function(){return b.none()}},onAction:sT(t),nodeChangeHandler:n,dataset:e,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},vT=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],bT=function(t){var n=function(){var n=function(t){return t?t.split(",")[0]:""},e=t.queryCommandValue("FontName"),o=r.data,i=e?e.toLowerCase():"";return L(o,function(t){var e=t.format;return e.toLowerCase()===i||n(e).toLowerCase()===n(i).toLowerCase()}).orThunk(function(){return function(t){var n;return 0===t.indexOf("-apple-system")&&(n=t.toLowerCase().split(/['"]?\s*,\s*['"]?/),W(vT,function(t){return n.indexOf(t.toLowerCase())>-1}))}(i)?b.from({title:"System Font",format:i}):b.none()})},e=b.some(function(e){return function(){var r=t.queryCommandValue("FontName"),o=n().fold(function(){return r},function(t){return t.title});No(e,Hk,{text:o})}}),r=gT(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",ZS.SemiColon);return{tooltip:"Fonts",icon:b.none(),isSelectedFor:function(t){return function(){return n().exists(function(n){return n.format===t})}},getPreviewFor:function(t){return function(){return b.some({tag:"div",styleAttr:-1===t.indexOf("dings")?"font-family:"+t:""})}},onAction:function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("FontName",!1,n.format)})}},nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(){return!1}}},yT=function(t,n){return/[0-9.]+px$/.test(t)?function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e}(72*parseInt(t,10)/96,n||0)+"pt":t},wT=function(t){var n=function(){var n=b.none(),e=r.data,o=t.queryCommandValue("FontSize");if(o)for(var i=function(t){var r=yT(o,t);n=L(e,function(t){return t.format===o||t.format===r})},u=3;n.isNone()&&u>=0;u--)i(u);return{matchOpt:n,px:o}},e=b.some(function(t){return function(){var e=n(),r=e.matchOpt,o=e.px,i=r.fold(function(){return o},function(t){return t.title});No(t,Hk,{text:i})}}),r=gT(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",ZS.Space);return{tooltip:"Font sizes",icon:b.none(),isSelectedFor:function(t){return function(){return n().matchOpt.exists(function(n){return n.format===t})}},getPreviewFor:function(){return function(){return b.none()}},onAction:function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("FontSize",!1,n.format)})}},nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(){return!1}}},xT=function(t,n,e){var r=e.parents,o=n();return Rt(r,function(n){return L(o,function(e){return t.formatter.matchNode(n,e.format)})}).orThunk(function(){return t.formatter.match("p")?b.some({title:"Paragraph",format:"p"}):b.none()})},ST=function(t){var n=b.some(function(n){return function(r){var o=xT(t,function(){return e.data},r).fold(function(){return"Paragraph"},function(t){return t.title});No(n,Hk,{text:o})}}),e=gT(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",ZS.SemiColon);return{tooltip:"Blocks",icon:b.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return b.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)})}},onAction:sT(t),nodeChangeHandler:n,dataset:e,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},CT=function(t){var n=b.some(function(n){var e=function(t){var n=t.items;return void 0!==n&&n.length>0?U(n,e):[{title:t.title,format:t.format}]},r=U(XC(t),e);return function(e){var o=xT(t,function(){return r},e).fold(function(){return"Paragraph"},function(t){return t.title});No(n,Hk,{text:o})}});return{tooltip:"Formats",icon:b.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?b.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)}):b.none()}},onAction:sT(t),nodeChangeHandler:n,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)}}},OT=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],kT=function(t,n){return function(e,r){var o=t(e).mapError(function(t){return Yr(t)}).getOrDie();return n(o,r)}},TT={button:kT(dk,function(t,n){return e=t,r=n.backstage.shared.providers,Yk(e,r,[]);var e,r}),togglebutton:kT(bk,function(t,n){return e=t,r=n.backstage.shared.providers,Kk(e,r,[]);var e,r}),menubutton:kT(gk,function(t,n){return Zk(t,"tox-tbtn",n.backstage.shared,b.none())}),splitbutton:kT(function(t){return qr("SplitButton",pk,t)},function(t,e){return function(t,e){var r,o=Ge("channel-update-split-dropdown-display"),i=function(t){return{isDisabled:function(){return mp.isDisabled(t)},setDisabled:function(n){return mp.set(t,n)},setIconFill:function(n,e){Su(t.element(),'svg path[id="'+n+'"], rect[id="'+n+'"]').each(function(t){De(t,"fill",e)})},setIconStroke:function(n,e){Su(t.element(),'svg path[id="'+n+'"], rect[id="'+n+'"]').each(function(t){De(t,"stroke",e)})},setActive:function(n){De(t.element(),"aria-pressed",n),Su(t.element(),"span").each(function(e){t.getSystem().getByDom(e).each(function(t){return Im.set(t,n)})})},isActive:function(){return Su(t.element(),"span").exists(function(n){return t.getSystem().getByDom(n).exists(Im.isOn)})}}},u=Dt(n),a={getApi:i,onSetup:t.onSetup};return Lk.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:yt({"aria-pressed":!1},Gk(t.tooltip,e.providers))},onExecute:function(n){t.onAction(i(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:Wu([hp(!1),Hm("split-dropdown-events",[Yo(qk,Sm.focus),bp(a,u),yp(a,u)])]),eventOrder:(r={},r[Nn()]=["alloy.base.behaviour","split-dropdown-events"],r),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:Jk(i,t,e.providers),parts:{menu:Yp(0,t.columns,t.presets)},components:[Lk.parts().button($k(t.icon,t.text,b.none(),b.some(o),b.some([Im.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),Lk.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:ig("chevron-down",e.providers.icons)}}),Lk.parts()["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}(t,e.backstage.shared)}),styleSelectButton:function(t,n){return function(t,n){var e=n.styleselect;return dT(t,n,e,CT(t))}(t,n.backstage)},fontsizeSelectButton:function(t,n){return function(t,n){var e=wT(t);return dT(t,n,e.dataset,e)}(t,n.backstage)},fontSelectButton:function(t,n){return function(t,n){var e=bT(t);return dT(t,n,e.dataset,e)}(t,n.backstage)},formatButton:function(t,n){return function(t,n){var e=ST(t);return dT(t,n,e.dataset,e)}(t,n.backstage)},alignMenuButton:function(t,n){return function(t,n){var e=hT(t);return dT(t,n,e.dataset,e)}(t,n.backstage)}},ET={styleselect:TT.styleSelectButton,fontsizeselect:TT.fontsizeSelectButton,fontselect:TT.fontSelectButton,formatselect:TT.formatButton,align:TT.alignMenuButton},DT=function(t){var n=t.split("|");return B(n,function(t){return{items:t.trim().split(" ")}})},AT=function(t){return!1===t.toolbar?[]:void 0===t.toolbar||!0===t.toolbar?(n=t.buttons,e=B(OT,function(t){var e=M(t.items,function(t){return ct(n,t)||ct(ET,t)});return{name:t.name,items:e}}),M(e,function(t){return t.items.length>0})):w(t.toolbar)?DT(t.toolbar):S(t.toolbar)&&w(t.toolbar[0])?DT(t.toolbar.join(" | ")):t.toolbar;var n,e},RT=function(n,e,r,o,i){return at(e,r.toLowerCase()).orThunk(function(){return i.bind(function(t){return Rt(t,function(t){return at(e,t+r.toLowerCase())})})}).fold(function(){return at(ET,r.toLowerCase()).map(function(t){return t(n,o)}).orThunk(function(){return b.none()})},function(n){return function(n,e){return at(TT,n.type).fold(function(){return t.console.error("skipping button defined by",n),b.none()},function(t){return b.some(t(n,e))})}(n,o)})},BT=function(t,n,e,r){var o=AT(n),i=B(o,function(o){var i=U(o.items,function(o){return 0===o.trim().length?[]:RT(t,n.buttons,o,e,r).toArray()});return{title:b.from(t.translate(o.name)),items:i}});return M(i,function(t){return t.items.length>0})},NT=function(t,n,e,r){var o,i,u=bu((o={sink:e,onEscape:function(){return t.focus(),b.some(!0)}},i=Dt([]),tg.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){i.set([]),tg.getContent(t).each(function(t){iu(t.element(),"visibility")}),Gi(t.element(),"tox-pop--resizing"),iu(t.element(),"width")},inlineBehaviours:Wu([Hm("context-toolbar-events",[ri($t(),function(t,n){tg.getContent(t).each(function(t){}),Gi(t.element(),"tox-pop--resizing"),iu(t.element(),"width")}),Yo(oT,function(t,n){iu(t.element(),"width");var e=ca(t.element());tg.setContent(t,n.event().contents()),Wi(t.element(),"tox-pop--resizing");var r=ca(t.element());Zi(t.element(),"width",e+"px"),tg.getContent(t).each(function(e){n.event().focus().bind(function(n){return bf(n),wf(t.element())}).orThunk(function(){return Qd.focusIn(e),yf()})}),sg.setTimeout(function(){Zi(t.element(),"width",r+"px")},0)}),Yo(eT,function(t,n){tg.getContent(t).each(function(t){i.set(i.get().concat([{bar:t,focus:yf()}]))}),No(t,oT,{contents:n.event().forwardContents(),focus:b.none()})}),Yo(rT,function(t,n){J(i.get()).each(function(n){i.set(i.get().slice(0,i.get().length-1)),No(t,oT,{contents:yu(n.bar),focus:n.focus})})})]),Qd.config({mode:"special",onEscape:function(t){return J(i.get()).fold(function(){return o.onEscape()},function(n){return Bo(t,rT),b.some(!0)})}})]),lazySink:function(){return gt.value(o.sink)}}))),a=function(){return b.some(jn.fromDom(t.contentAreaContainer))};t.on("init",function(){var n=t.getBody().ownerDocument.defaultView,r=gh(jn.fromDom(n),"scroll",function(){c.get().each(function(n){var r=s.get().getOr(t.selection.getNode()).getBoundingClientRect(),o=t.contentAreaContainer.getBoundingClientRect(),i=r.bottom<0,c=r.top>o.height;i||c?Zi(u.element(),"display","none"):(iu(u.element(),"display"),ms.positionWithin(e,n,u,a()))})});t.on("remove",function(){r.unbind()})});var c=Dt(b.none()),s=Dt(b.none()),l=Dt(null),f=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:Wu([Qd.config({mode:"acyclic"}),Hm("pop-dialog-wrap-events",[oi(function(n){t.shortcuts.add("ctrl+F9","focus statusbar",function(){return Qd.focusIn(n)})}),ii(function(n){t.shortcuts.remove("ctrl+F9")})])])}},d=Yt(function(){return aT(n,function(t){var n=m(t);No(u,eT,{forwardContents:f(n)})})}),m=function(n){var e,o,i=t.ui.registry.getAll().buttons,u=d();return"contexttoolbar"===n.type?(e=yt(i,u.formNavigators),o=BT(t,{buttons:e,toolbar:n.items},r,b.some(["form:"])),sk({uid:Ge("context-toolbar"),initGroups:o,onEscape:b.none,cyclicKeying:!0,backstage:r.backstage,getSink:function(){return gt.error("")}})):nT(n,r.backstage)};t.on("contexttoolbar-show",function(n){var e=d();Ct(e.lookupTable,n.toolbarKey).each(function(e){y(e,n.target===t?b.none():b.some(n)),tg.getContent(u).each(Qd.focusIn)})});var g={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},p={maxHeightFunction:qa()},h={bubble:Ka(12,0,g),layouts:{onLtr:function(){return[fc]},onRtl:function(){return[dc]}},overrides:p},v={bubble:Ka(0,12,g),layouts:{onLtr:function(){return[sc,lc,ac,ic,cc,uc]},onRtl:function(){return[sc,lc,cc,uc,ac,ic]}},overrides:p},y=function(t,n){x();var e=m(t),o=n.map(jn.fromDom),i=function(t,n){var e="node"===t?r.backstage.shared.anchors.node(n):r.backstage.shared.anchors.cursor();return bt(e,"line"===t?h:v)}(t.position,o);c.set(b.some(i)),s.set(n),tg.showWithin(u,i,f(e),a()),iu(u.element(),"display")},w=function(){var n=d();uT(n,t).fold(function(){c.set(b.none()),tg.hide(u)},function(t){y(t.toolbarApi,b.some(t.elem.dom()))})},x=function(){var t=l.get();null!==t&&(sg.clearTimeout(t),l.set(null))},S=function(t){x(),l.set(t)};t.on("init",function(){t.on("click keyup SetContent ObjectResized ResizeEditor",function(n){S(sg.setEditorTimeout(t,w,0))}),t.on("focusout",function(n){sg.setEditorTimeout(t,function(){wf(e.element()).isNone()&&wf(u.element()).isNone()&&(c.set(b.none()),tg.hide(u))},0)}),t.on("NodeChange",function(n){wf(u.element()).fold(function(){S(sg.setEditorTimeout(t,w,0))},function(t){})})})},_T=function(n,e,r){var o=gh(jn.fromDom(t.document),"mousedown",function(t){N([e,r],function(n){n.broadcastOn([_s()],{target:t.target()})})}),i=gh(jn.fromDom(t.document),"touchstart",function(t){N([e,r],function(n){n.broadcastOn([_s()],{target:t.target()})})}),u=gh(jn.fromDom(t.document),"mouseup",function(t){0===t.raw().button&&N([e,r],function(n){n.broadcastOn([Is()],{target:t.target()})})}),a=function(t){N([e,r],function(n){n.broadcastOn([_s()],{target:jn.fromDom(t.target)})})};n.on("mousedown",a),n.on("touchstart",a);var c=function(t){0===t.button&&N([e,r],function(n){n.broadcastOn([Is()],{target:jn.fromDom(t.target)})})};n.on("mouseup",c);var s=function(t){N([e,r],function(n){n.broadcastEvent(Rn(),t)})};n.on("ScrollWindow",s);var l=function(t){N([e,r],function(n){n.broadcastEvent(Bn(),t)})};n.on("ResizeWindow",l),n.on("remove",function(){n.off("mousedown",a),n.off("touchstart",a),n.off("mouseup",c),n.off("ResizeWindow",l),n.off("ScrollWindow",s),o.unbind(),i.unbind(),u.unbind()}),n.on("detach",function(){Cs(e),Cs(r),e.destroy(),r.destroy()})},IT=_l,MT=hl,FT=zl({factory:function(t,n){var e={focus:Qd.focusIn,setMenus:function(n,e){var r=B(e,function(n){var e={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},r=gk(e).mapError(function(t){return Yr(t)}).getOrDie();return Zk(r,"tox-mbtn",{getSink:t.getSink,providers:t.providers},b.some("menuitem"))});om.set(n,r)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:Wu([om.config({}),Hm("menubar-events",[oi(function(n){t.onSetup(n)}),Yo(Ht(),function(t,n){Su(t.element(),".tox-mbtn--active").each(function(e){Cu(n.event().target(),".tox-mbtn").each(function(n){ie(e,n)||t.getSystem().getByDom(e).each(function(e){t.getSystem().getByDom(n).each(function(t){ty.expand(t),ty.close(e),Sm.focus(t)})})})})}),Yo(Mn(),function(t,n){n.event().prevFocus().bind(function(n){return t.getSystem().getByDom(n).toOption()}).each(function(e){n.event().newFocus().bind(function(n){return t.getSystem().getByDom(n).toOption()}).each(function(t){ty.isOpen(e)&&(ty.expand(t),ty.close(e))})})})]),Qd.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),b.some(!0)}}),fb.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[oo("dom"),oo("uid"),oo("onEscape"),oo("getSink"),oo("providers"),yo("onSetup",n)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),PT=[Ls("slotBehaviours",[])],LT=function(t){return"<alloy.field."+t+">"},HT=function(t,n,e){var r,o=function(n){return Al(t)},i=function(n,e){return void 0===e&&(e=void 0),function(r,o){return kl(r,t,o).map(function(t){return n(t,o)}).getOr(e)}},u=function(t,n){return"true"!==Re(t.element(),"aria-hidden")},a=i(u,!1),c=i(function(t,n){if(u(t)){var e=t.element();Zi(e,"display","none"),De(e,"aria-hidden","true"),No(t,Fn(),{name:n,visible:!1})}}),s=(r=c,function(t,n){N(n,function(n){return r(t,n)})}),l=i(function(t,n){if(!u(t)){var e=t.element();iu(e,"display"),Ne(e,"aria-hidden"),No(t,Fn(),{name:n,visible:!0})}}),f={getSlotNames:o,getSlot:function(n,e){return kl(n,t,e)},isShowing:a,hideSlot:c,hideAllSlots:function(t){return s(t,o())},showSlot:l};return{uid:t.uid,dom:t.dom,components:n,behaviours:Hs(t.slotBehaviours),apis:f}},VT=et({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},Ti),zT=$e({},VT,{sketch:function(t){var n=function(){var t=[];return{slot:function(n,e){return t.push(n),wl("container",LT(n),e)},record:function(){return t}}}(),e=t(n),r=n.record(),o=B(r,function(t){return fl({name:t,pname:LT(t)})});return Ml("container",PT,o,HT,e)}}),jT=Br([ho("icon"),ho("tooltip"),ko("onShow",n),ko("onHide",n),ko("onSetup",function(){return n})]),UT=function(t){return{element:function(){return t.element().dom()}}},WT=function(t,e){var r=B(Q(e),function(t){var n=e[t],r=$r(function(t){return qr("sidebar",jT,t)}(n));return{name:t,getApi:UT,onSetup:r.onSetup,onShow:r.onShow,onHide:r.onHide}});return B(r,function(e){var o=Dt(n);return t.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Bg([bp(e,o),yp(e,o),Yo(Fn(),function(t,n){var e=n.event();L(r,function(t){return t.name===e.name()}).each(function(n){(e.visible()?n.onShow:n.onHide)(n.getApi(t))})})])})})},GT=function(t){return zT.sketch(function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:WT(n,t),slotBehaviours:Bg([oi(function(t){return zT.hideAllSlots(t)})])}})},qT=function(t){return ql.getCurrent(t).bind(function(t){return qO.isGrowing(t)||qO.hasGrown(t)?ql.getCurrent(t).bind(function(t){return L(zT.getSlotNames(t),function(n){return zT.isShowing(t,n)})}):b.none()})},$T=Ge("FixSizeEvent"),XT=Ge("AutoSizeEvent"),YT=function(t){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:Vg('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Wu([Qd.config({mode:"special",onTab:function(){return b.some(!0)},onShiftTab:function(){return b.some(!0)}}),Sm.config({})])}},KT=function(t,n,e){var r=Dt(!1),o=Dt(b.none()),i=function(t){t!==r.get()&&(function(t,n,e){var r=t.element();!0===n?(om.set(t,[YT(e)]),iu(r,"display"),Ne(r,"aria-hidden")):(om.set(t,[]),Zi(r,"display","none"),De(r,"aria-hidden","true"))}(n(),t,e.providers),r.set(t))};t.on("ProgressState",function(n){if(o.get().each(sg.clearTimeout),k(n.time)){var e=sg.setEditorTimeout(t,function(){return i(n.state)},n.time);o.set(b.some(e))}else i(n.state),o.set(b.none())})},JT=MT.optional({factory:FT,name:"menubar",schema:[oo("dom"),oo("getSink")]}),ZT=MT.optional({factory:{sketch:function(t){return(t.split===_h.sliding||t.split===_h.floating?ck:sk)({uid:t.uid,onEscape:function(){return t.onEscape(),b.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,backstage:t.backstage,moreDrawerData:{floating:t.split===_h.floating,lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton}})}},name:"toolbar",schema:[oo("dom"),oo("onEscape"),oo("getSink")]}),QT=MT.optional({name:"socket",schema:[oo("dom")]}),tE=MT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Wu([fb.config({}),Sm.config({}),qO.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){ql.getCurrent(t).each(zT.hideAllSlots),Bo(t,XT)},onGrown:function(t){Bo(t,XT)},onStartGrow:function(t){No(t,$T,{width:ru(t.element(),"width").getOr("")})},onStartShrink:function(t){No(t,$T,{width:ca(t.element())+"px"})}}),om.config({}),ql.config({find:function(t){var n=om.contents(t);return K(n)}})])}],behaviours:Wu([sx(0),Hm("sidebar-sliding-events",[Yo($T,function(t,n){Zi(t.element(),"width",n.event().width())}),Yo(XT,function(t,n){iu(t.element(),"width")})])])}}},name:"sidebar",schema:[oo("dom")]}),nE=MT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Wu([om.config({})]),components:[]}}},name:"throbber",schema:[oo("dom")]}),eE=jl({name:"OuterContainer",factory:function(t,n,e){var r={getSocket:function(n){return IT.getPart(n,t,"socket")},setSidebar:function(n,e){IT.getPart(n,t,"sidebar").each(function(t){return function(t,n){ql.getCurrent(t).each(function(t){return om.set(t,[GT(n)])})}(t,e)})},toggleSidebar:function(n,e){IT.getPart(n,t,"sidebar").each(function(t){return function(t,n){ql.getCurrent(t).each(function(t){ql.getCurrent(t).each(function(e){qO.hasGrown(t)?zT.isShowing(e,n)?qO.shrink(t):(zT.hideAllSlots(e),zT.showSlot(e,n)):(zT.hideAllSlots(e),zT.showSlot(e,n),qO.grow(t))})})}(t,e)})},whichSidebar:function(n){return IT.getPart(n,t,"sidebar").bind(qT).getOrNull()},getToolbar:function(n){return IT.getPart(n,t,"toolbar")},setToolbar:function(n,e){IT.getPart(n,t,"toolbar").each(function(t){YO.setGroups(t,e)})},getMoreButton:function(n){return IT.getPart(n,t,"toolbar").bind(function(t){return ok.getMoreButton(t)})},getThrobber:function(n){return IT.getPart(n,t,"throbber")},focusToolbar:function(n){IT.getPart(n,t,"toolbar").each(function(t){Qd.focusIn(t)})},setMenubar:function(n,e){IT.getPart(n,t,"menubar").each(function(t){FT.setMenus(t,e)})},focusMenubar:function(n){IT.getPart(n,t,"menubar").each(function(t){FT.focus(t)})}};return{uid:t.uid,dom:t.dom,components:n,apis:r,behaviours:t.behaviours}},configFields:[oo("dom"),oo("behaviours")],partFields:[JT,ZT,QT,tE,nE],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var r=B(e,function(t){return uk(t)});t.setToolbar(n,r)},getMoreButton:function(t,n){return t.getMoreButton(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),rE={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable tableprops deletetable row column cell"},help:{title:"Help",items:"help"}},oE=function(t){return"string"==typeof t?t.split(" "):t},iE=function(t,n){var e=yt(rE,n.menus),r=Q(n.menus).length>0,o=void 0===n.menubar||!0===n.menubar?oE("file edit view insert format tools table help"):oE(!1===n.menubar?"":n.menubar),i=M(o,function(t){return r&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||rE.hasOwnProperty(t)}),u=B(i,function(r){var o=e[r];return function(t,n,e){var r=function(t){return t.getParam("removed_menuitems","")}(e).split(/[ ,]/);return{text:t.title,getItems:function(){return U(t.items,function(t){var e=t.toLowerCase();return 0===e.trim().length?[]:A(r,function(t){return t===e})?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]})}}}({title:o.title,items:oE(o.items)},n,t)});return M(u,function(t){return t.getItems().length>0&&A(t.getItems(),function(t){return"separator"!==t.type})})},uE=function(t){return t.fire("SkinLoaded")},aE=function(t){return t.fire("ResizeEditor")},cE=function(t){return t.fire("ResizeContent")},sE=function(t){var n=function(){t._skinLoaded=!0,uE(t)};return function(){t.initialized?n():t.on("init",n)}},lE=function(t,n){var e,r=function(t){var n=t.settings,e=n.skin,r=n.skin_url;if(!1!==e){var o=e||"oxide";r=r?t.documentBaseURI.toAbsolute(r):Ph.baseURL+"/skins/ui/"+o}return r}(n);r&&(e=r+"/skin.min.css",n.contentCSS.push(r+(t?"/content.inline":"/content")+".min.css")),!1===function(t){return!1===t.getParam("skin")}(n)&&e?Fh.DOM.styleSheetLoader.load(e,sE(n)):sE(n)()},fE=u(lE,!1),dE=u(lE,!0),mE=Fh.DOM,gE=function(t){return function(n){var e=t.outerContainer;re("*",e.element()).forEach(function(t){e.getSystem().getByDom(t).each(function(t){t.hasConfigured(mp)&&("readonly"===n.mode?mp.disable(t):mp.enable(t))})})}},pE={render:function(t,n,e,r,o){fE(t),function(t,n){Ss(t,n,me)}(jn.fromDom(o.targetNode),n.mothership),xs(Ho(),n.uiMothership),t.on("init",function(){eE.setToolbar(n.outerContainer,BT(t,e,{backstage:r},b.none())),eE.setMenubar(n.outerContainer,iE(t,e)),eE.setSidebar(n.outerContainer,e.sidebar),t.readonly&&gE(n)({mode:"readonly"});var o=Dt(na(0,0)),i=t.contentWindow,u=function(){var n=o.get();if(n.left()!==i.innerWidth||n.top()!==i.innerHeight){var e=na(i.innerWidth,i.innerHeight);o.set(e),cE(t)}};mE.bind(i,"resize",u),t.on("remove",function(){mE.unbind(i,"resize",u)})});var i=eE.getSocket(n.outerContainer).getOrDie("Could not find expected socket element");t.on("SwitchMode",gE(n)),function(t){return t.getParam("readonly",!1,"boolean")}(t)&&t.setMode("readonly"),t.addCommand("ToggleSidebar",function(e,r){eE.toggleSidebar(n.outerContainer,r),t.fire("ToggleSidebar")}),t.addQueryValueHandler("ToggleSidebar",function(){return eE.whichSidebar(n.outerContainer)});var u=jh(t);return u!==_h.sliding&&u!==_h.floating||t.on("ResizeContent",function(){eE.getToolbar(n.outerContainer).each(ok.refresh)}),{iframeContainer:i.element().dom(),editorContainer:n.outerContainer.element().dom()}},getBehaviours:function(t){return[]}},hE=function(t,n){return se(t).orThunk(function(){var n=jn.fromTag("span");de(t,n);var e=se(n);return be(n),e}).map(function(t){return ra(t).translate(-n.left(),-n.top())}).getOrThunk(function(){return na(0,0)})},vE=pt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),bE=function(t){return function(n){return n.translate(-t.left(),-t.top())}},yE=function(t){return function(n){return n.translate(t.left(),t.top())}},wE=function(t){return function(n,e){return P(t,function(t,n){return n(t)},na(n,e))}},xE=function(t,n,e){return t.fold(wE([yE(e),bE(n)]),wE([bE(n)]),wE([]))},SE=function(t,n,e){return t.fold(wE([yE(e)]),wE([]),wE([yE(n)]))},CE=function(t,n,e){return t.fold(wE([]),wE([bE(e)]),wE([yE(n),bE(e)]))},OE=function(t,n,e){return t.fold(function(t,n){return{position:"absolute",left:t+"px",top:n+"px"}},function(t,n){return{position:"absolute",left:t-e.left()+"px",top:n-e.top()+"px"}},function(t,n){return{position:"fixed",left:t+"px",top:n+"px"}})},kE=function(t,n,e,r){var o=function(t,o){return function(i,u){var a=t(n,e,r);return o(i.getOr(a.left()),u.getOr(a.top()))}};return t.fold(o(CE,vE.offset),o(SE,vE.absolute),o(xE,vE.fixed))},TE=vE.offset,EE=vE.absolute,DE=vE.fixed,AE=function(t,n){Wi(t.element(),n.transitionClass),Gi(t.element(),n.fadeOutClass),Wi(t.element(),n.fadeInClass)},RE=function(t,n){Wi(t.element(),n.transitionClass),Gi(t.element(),n.fadeInClass),Wi(t.element(),n.fadeOutClass)},BE=function(t,n){return t.y()>=n.y()&&t.bottom()<=n.bottom()},NE=function(t,n){return Be(t,n)?b.some(parseInt(Re(t,n),10)):b.none()},_E=function(t,n,e){return function(t,n){var e=t.element();return NE(e,n.leftAttr).bind(function(r){return NE(e,n.topAttr).map(function(n){var e=ca(t.element()),o=fa(t.element());return Ta(r,n,e,o)})})}(t,n).bind(function(r){return BE(r,e)?(function(t,n){var e=t.element();Ne(e,n.leftAttr),Ne(e,n.topAttr)}(t,n),b.some(EE(r.x(),r.y()))):b.none()})},IE=function(t,n,e,r,o){var i=ra(t.element()),u=Ta(i.left(),i.top(),ca(t.element()),fa(t.element()));if(BE(u,e))return b.none();!function(t,n,e,r){var o=t.element();De(o,n.leftAttr,e),De(o,n.topAttr,r)}(t,n,i.left(),i.top());var a=EE(i.left(),i.top()),c=xE(a,r,o),s=EE(e.x(),e.y()),l=xE(s,r,o),f=u.y()<=e.y()?l.top():l.top()+e.height()-u.height();return b.some(DE(c.left(),f))},ME=function(t,n,e){var r=n.lazyViewport(t);n.contextual.each(function(n){n.lazyContext(t).each(function(e){(!function(t,n){return t.y()<n.bottom()&&t.bottom()>n.y()}(Ea(e),r)?RE:AE)(t,n)})});var o=ue(t.element()),i=ia(o),u=hE(t.element(),i);(function(t,n,e,r,o){return ru(t.element(),"position").is("fixed")?_E(t,n,e):IE(t,n,e,r,o)})(t,n,r,i,u).each(function(n){var e=OE(n,0,u);Qi(t.element(),e)})},FE=Object.freeze({refresh:ME}),PE=Object.freeze({events:function(t,n){return Go([Yo($t(),function(n,e){t.contextual.each(function(t){ie(n.element(),e.event().target())&&(Gi(n.element(),t.transitionClass),e.stop())})}),Yo(Rn(),function(n,e){ME(n,t)})])}}),LE=[bo("contextual",[oo("fadeInClass"),oo("fadeOutClass"),oo("transitionClass"),oo("lazyContext")]),yo("lazyViewport",function(n){var e=ia();return Ta(e.left(),e.top(),t.window.innerWidth,t.window.innerHeight)}),oo("leftAttr"),oo("topAttr")],HE=qu({fields:LE,name:"docking",active:PE,apis:FE}),VE={render:function(t,n,e,r,o){var i,u=Fh.DOM,a=Wh(t),c=jh(t),s=c===_h.sliding||c===_h.floating,l=c===_h.floating;dE(t);var f=function(n){var e=s?n.fold(function(){return 0},function(t){return t.components().length>1?fa(t.components()[1].element()):0}):0;Qi(i.element(),function(n){void 0===n&&(n=0);var e=ra(jn.fromDom(t.getBody()));return{top:Math.round(e.top()-fa(i.element()))+n+"px",left:Math.round(e.left())+"px"}}(e)),HE.refresh(i)},d=function(){var t=eE.getToolbar(n.outerContainer);s&&t.each(ok.refresh),a||f(t)},m=function(){Zi(n.outerContainer.element(),"display","flex"),u.addClass(t.getBody(),"mce-edit-focus"),d(),l&&eE.getToolbar(n.outerContainer).each(function(t){ok.getOverflow(t).each(function(t){Gi(t.element(),"tox-toolbar__overflow--closed")})})},g=function(){n.outerContainer&&(Zi(n.outerContainer.element(),"display","none"),u.removeClass(t.getBody(),"mce-edit-focus"),l&&eE.getToolbar(n.outerContainer).each(function(t){ok.getOverflow(t).each(function(t){Wi(t.element(),"tox-toolbar__overflow--closed")})}))},p=function(){if(i)m();else{i=n.outerContainer;var o=function(t){return Uh(t).getOr(Ho())}(t);xs(o,n.mothership),xs(o,n.uiMothership),eE.setToolbar(n.outerContainer,BT(t,e,{backstage:r},b.none())),eE.setMenubar(n.outerContainer,iE(t,e)),a||Zi(i.element(),"position","absolute"),d(),m(),t.on("NodeChange ResizeWindow",d),t.on("activate",m),t.on("deactivate",g),t.nodeChanged()}};return t.on("focus",p),t.on("blur hide",g),t.on("init",function(){t.hasFocus()&&p()}),{editorContainer:n.outerContainer.element().dom()}},getBehaviours:function(t){return Wh(t)?[]:[HE.config({leftAttr:"data-dock-left",topAttr:"data-dock-top",contextual:{lazyContext:function(n){return b.from(t).map(function(t){return jn.fromDom(t.getBody())})},fadeInClass:"tox-toolbar-dock-fadein",fadeOutClass:"tox-toolbar-dock-fadeout",transitionClass:"tox-toolbar-dock-transition"}}),Sm.config({})]}},zE=function(t,n){return{anchor:"makeshift",x:t,y:n}},jE=function(t,n){var e=Fh.DOM.getPos(t);return function(t,n,e){return zE(t.x+n,t.y+e)}(n,e.x,e.y)},UE=function(t,n){return"contextmenu"===n.type?t.inline?function(t){return zE(t.pageX,t.pageY)}(n):jE(t.getContentAreaContainer(),function(t){return zE(t.clientX,t.clientY)}(n)):WE(t)},WE=function(t){return{anchor:"selection",root:jn.fromDom(t.selection.getNode())}},GE=function(t){return"string"==typeof t?t.split(/[ ,]/):t},qE=function(t){return t.settings.contextmenu_never_use_native||!1},$E=function(t){return function(t,n,e){var r=t.ui.registry.getAll().contextMenus;return at(t.settings,n).map(GE).getOrThunk(function(){return M(GE(e),function(t){return ct(r,t)})})}(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},XE=function(t){return w(t)?"|"===t:"separator"===t.type},YE={type:"separator"},KE=function(t){if(w(t))return t;switch(t.type){case"separator":return YE;case"submenu":return{type:"nestedmenuitem",text:t.text,icon:t.icon,getSubmenuItems:function(){var n=t.getSubmenuItems();return w(n)?n:B(n,KE)}};default:return{type:"menuitem",text:t.text,icon:t.icon,onAction:e(t.onAction)}}},JE=function(t,n){if(0===n.length)return t;var e=J(t).filter(function(t){return!XE(t)}).fold(function(){return[]},function(t){return[YE]});return t.concat(e).concat(n).concat([YE])},ZE=function(t,n,e){var r=bu(tg.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},fireDismissalEventInstead:{},inlineBehaviours:Wu([Hm("dismissContextMenu",[Yo(In(),function(n,e){Ns.close(n),t.focus()})])])}));t.on("init",function(){t.on("contextmenu",function(n){if(!function(t,n){return n.ctrlKey&&!qE(t)}(t,n)){var o=2!==n.button||n.target===t.getBody(),i=o?function(t){return{anchor:"node",node:b.some(jn.fromDom(t.selection.getNode())),root:jn.fromDom(t.getBody())}}(t):UE(t,n),u=t.ui.registry.getAll(),a=$E(t),c=o?t.selection.getStart(!0):n.target,s=function(t,n,e){var r=P(n,function(n,r){if(ct(t,r)){var o=t[r].update(e);if(w(o))return JE(n,o.split(" "));if(o.length>0){var i=B(o,KE);return JE(n,i)}return n}return n.concat([r])},[]);return r.length>0&&XE(r[r.length-1])&&r.pop(),r}(u.contextMenus,a,c);$v(s,xp.CLOSE_ON_EXECUTE,e.providers).map(function(t){n.preventDefault(),tg.showMenuAt(r,i,{menu:{markers:qp("normal")},data:t})})}})})},QE=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?b.some(parseInt(t,10)):b.none()},tD=function(t){return k(t)?t+"px":t},nD=function(t,n){t.getSystem().addToGui(n),function(t){ce(t.element()).each(function(n){ru(n,"z-index").each(function(t){De(n,"data-initial-z-index",t)}),Zi(n,"z-index",nu(t.element(),"z-index"))})}(n)},eD=function(t){!function(t){ce(t.element()).each(function(t){var n=Re(t,"data-initial-z-index");Be(t,"data-initial-z-index")?Zi(t,"z-index",n):iu(t,"z-index"),Ne(t,"data-initial-z-index")})}(t),t.getSystem().removeFromGui(t)},rD=function(t,n,e,r){return function(t,n){var e=t.element(),r=parseInt(Re(e,n.leftAttr),10),o=parseInt(Re(e,n.topAttr),10);return isNaN(r)||isNaN(o)?b.none():b.some(na(r,o))}(t,n).fold(function(){return e},function(t){return DE(t.left()+r.left(),t.top()+r.top())})},oD=function(t,n,e,r,o,i){var u=rD(t,n,e,r),a=uD(t,n,u,o,i),c=xE(u,o,i);return function(t,n,e){var r=t.element();De(r,n.leftAttr,e.left()+"px"),De(r,n.topAttr,e.top()+"px")}(t,n,c),a.fold(function(){return{coord:DE(c.left(),c.top()),extra:b.none()}},function(t){return{coord:t.output(),extra:t.extra()}})},iD=function(t,n){!function(t,n){var e=t.element();Ne(e,n.leftAttr),Ne(e,n.topAttr)}(t,n)},uD=function(t,n,e,r,i){var u=n.getSnapPoints(t);return Rt(u,function(t){var n=t.sensor();return function(t,n,e,r,o,i){var u=SE(t,o,i),a=SE(n,o,i);return Math.abs(u.left()-a.left())<=e&&Math.abs(u.top()-a.top())<=r}(e,n,t.range().left(),t.range().top(),r,i)?b.some({output:o(kE(t.output(),e,r,i)),extra:t.extra}):b.none()})},aD=function(t,n,e,r,o,i){return n.fold(function(){var t,n,u,a=(t=e,n=i.left(),u=i.top(),t.fold(function(t,e){return vE.offset(t+n,e+u)},function(t,e){return vE.absolute(t+n,e+u)},function(t,e){return vE.fixed(t+n,e+u)})),c=xE(a,r,o);return DE(c.left(),c.top())},function(n){var u=oD(t,n,e,i,r,o);return u.extra.each(function(e){n.onSensor(t,e)}),u.coord})},cD=function(t,n,e){var r=n.getTarget(t.element());if(n.repositionTarget){var o=ue(t.element()),i=ia(o),u=hE(r,i),a=function(t){return ru(t,"left").bind(function(n){return ru(t,"top").bind(function(e){return ru(t,"position").map(function(t){return("fixed"===t?DE:TE)(parseInt(n,10),parseInt(e,10))})})}).getOrThunk(function(){var n=ra(t);return EE(n.left(),n.top())})}(r),c=aD(t,n.snaps,a,i,u,e),s=OE(c,0,u);Qi(r,s)}n.onDrag(t,r,e)},sD=bo("snaps",[oo("getSnapPoints"),_u("onSensor"),oo("leftAttr"),oo("topAttr"),yo("lazyViewport",function(){var n=ia();return{x:n.left,y:n.top,width:o(t.window.innerWidth),height:o(t.window.innerHeight),bottom:o(n.top()+t.window.innerHeight),right:o(n.left()+t.window.innerWidth)}})]),lD=function(t){return Go([Yo(Mt(),t.forceDrop),Yo(Lt(),t.drop),Yo(Ft(),function(n,e){t.move(e.event())}),Yo(Pt(),t.delayDrop)])},fD=Object.freeze({getData:function(t){return b.from(na(t.x(),t.y()))},getDelta:function(t,n){return na(n.left()-t.left(),n.top()-t.top())}}),dD=[yo("useFixed",!1),oo("blockerClass"),yo("getTarget",i),yo("onDrag",n),yo("repositionTarget",!0),_u("onDrop"),sD,Pu("dragger",{handlers:function(t,n){return Go([Yo(Mt(),function(e,r){if(0===r.event().raw().button){r.stop();var o={drop:function(){u()},delayDrop:function(){a.schedule()},forceDrop:function(){u()},move:function(r){a.cancel(),n.update(fD,r).each(function(n){cD(e,t,n)})}},i=e.getSystem().build(Ih.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t.blockerClass]},events:lD(o)})),u=function(){eD(i),t.snaps.each(function(t){iD(e,t)});var n=t.getTarget(e.element());t.onDrop(e,n)},a=vh(u,200);n.reset(),nD(e,i)}})])}})],mD=Object.freeze({getData:function(t){var n=t.raw().touches;return 1===n.length?function(t){var n=t[0];return b.some(na(n.clientX,n.clientY))}(n):b.none()},getDelta:function(t,n){return na(n.left()-t.left(),n.top()-t.top())}}),gD=dD,pD=[yo("useFixed",!1),yo("getTarget",i),yo("onDrag",n),yo("repositionTarget",!0),yo("onDrop",n),sD,Pu("dragger",{handlers:function(t,n){return Go([ei(Nt()),Yo(_t(),function(e,r){r.stop(),n.update(mD,r.event()).each(function(n){cD(e,t,n)})}),Yo(It(),function(e,r){t.snaps.each(function(t){iD(e,t)});var o=t.getTarget(e.element());n.reset(),t.onDrop(e,o)})])}})],hD=Object.freeze({mouse:gD,touch:pD}),vD=Object.freeze({init:function(){var t=b.none(),n=o({});return Di({readState:n,reset:function(){t=b.none()},update:function(n,e){return n.getData(e).bind(function(e){return function(n,e){var r=t.map(function(t){return n.getDelta(t,e)});return t=b.some(e),r}(n,e)})}})}}),bD=Xu({branchKey:"mode",branches:hD,name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:qn(["sensor","range","output"],["extra"])},state:vD});!function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Vertical=2]="Vertical"}(mT||(mT={}));var yD,wD=function(t,n,e,r){var o=t+n,i=e.filter(function(t){return o<t}),u=r.filter(function(t){return o>t});return i.or(u).getOr(o)},xD=function(t,n,e,r,o){var i={};return i.height=wD(r,n.top(),Hh(t),function(t){return b.from(t.getParam("max_height")).filter(k)}(t)),e===mT.Both&&(i.width=wD(o,n.left(),Lh(t),function(t){return b.from(t.getParam("max_width")).filter(k)}(t))),i},SD=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},CD=function(t,n){return n.delimiter||(n.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Wu([Qd.config({mode:"flow",selector:"div[role=button]"}),fb.config({}),om.config({}),Hm("elementPathEvents",[oi(function(e,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return Qd.focusIn(e)}),t.on("NodeChange",function(r){var o,i,u=function(n){for(var e=[],r=n.length;r-- >0;){var o=n[r];if(1===o.nodeType&&!SD(o)){var i=t.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(i.isDefaultPrevented()||e.push({name:i.name,element:o}),i.isPropagationStopped())break}}return e}(r.parents);u.length>0&&om.set(e,(o=B(u||[],function(n,e){return eg.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":e,"tab-index":-1,"aria-level":e+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()}})}),i={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},P(o.slice(1),function(t,n){var e=t;return e.push(i),e.push(n),e},[o[0]])))})})])]),components:[]}},OD=function(t,n){var e=function(e){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},innerHtml:ig("resize-handle",n.icons)},behaviours:Wu([bD.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,r,o){!function(t,n,e){var r=jn.fromDom(t.getContainer()),o=xD(t,n,e,fa(r),ca(r));nt(o,function(t,n){return Zi(r,n,tD(t))}),aE(t)}(t,o,e)},blockerClass:"tox-blocker"})])}},r=function(){var e,r=[];return t.getParam("elementpath",!0,"boolean")&&r.push(CD(t,{})),sn(t.settings.plugins,"wordcount")&&r.push(function(t,n){var e,r=function(t,e,r){return om.set(t,[pu(n.translate(["{0} "+r,e[r]]))])};return eg.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Wu([fb.config({}),om.config({}),vm.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Hm("wordcount-events",[Yo(kn(),function(t){var n=vm.getValue(t),e="words"===n.mode?"characters":"words";vm.setValue(t,{mode:e,count:n.count}),r(t,n.count,e)}),oi(function(n){t.on("wordCountUpdate",function(t){var e=vm.getValue(n).mode;vm.setValue(n,{mode:e,count:t.wordCount}),r(n,t.wordCount,e)})})])]),eventOrder:(e={},e[kn()]=["wordcount-events","alloy.base.behaviour"],e)})}(t,n)),t.getParam("branding",!0,"boolean")&&r.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(e=zg.translate(["Powered by {0}","Tiny"]))+'">'+e+"</a>"}}),r.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:r}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var n=r(),o=function(t){var n=!sn(t.settings.plugins,"autoresize"),e=t.getParam("resize",n);return!1===e?mT.None:"both"===e?mT.Both:mT.Vertical}(t);return o!==mT.None&&n.push(e(o)),n}()}},kD=function(t){var n=t.getParam("inline",!1,"boolean"),e=n?VE:pE,r=b.none(),o=zg.isRtl()?{attributes:{dir:"rtl"}}:{},i=bu({dom:$e({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"]},o),behaviours:Wu([ms.config({useFixed:!1})])}),u=rg({dom:{tag:"div",classes:["tox-anchorbar"]}}),a=function(){return r.bind(function(t){return eE.getMoreButton(t)}).getOrDie("Could not find more button element")},c=function(){return r.bind(function(t){return eE.getThrobber(t)}).getOrDie("Could not find throbber element")},s=TO(i,t,function(){return r.bind(function(t){return u.getOpt(t)}).getOrDie("Could not find a anchor bar element")},a),l=function(){return gt.value(i)},f=eE.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},getSink:l,providers:s.shared.providers,onEscape:function(){t.focus()}}),d=eE.parts().toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:l,backstage:s,onEscape:function(){t.focus()},split:jh(t),lazyToolbar:function(){return r.bind(function(t){return eE.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyMoreButton:a}),m=eE.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),g=eE.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),p=eE.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:s}),h=t.getParam("statusbar",!0,"boolean")&&!n?b.some(OD(t,s.shared.providers)):b.none(),v={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[m,g]},y=function(t){var n=t.getParam("toolbar");return S(n)?n.length>0:!1!==t.getParam("toolbar",!0,"boolean")}(t)||Vh(t).isSome(),w=function(t){return!1!==t.getParam("menubar",!0,"boolean")}(t),x=j([w?[f]:[],y?[d]:[],Wh(t)?[]:[u.asSpec()],n?[]:[v]]),C=j([[{dom:{tag:"div",classes:["tox-editor-container"]},components:x}],n?[]:h.toArray(),[p]]),O=$e({role:"application"},zg.isRtl()?{dir:"rtl"}:{}),k=bu(eE.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(n?["tox-tinymce-inline"]:[]),styles:{visibility:"hidden"},attributes:O},components:C,behaviours:Wu(e.getBehaviours(t).concat([Qd.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})]))}));r=b.some(k),t.shortcuts.add("alt+F9","focus menubar",function(){eE.focusMenubar(k)}),t.shortcuts.add("alt+F10","focus toolbar",function(){eE.focusToolbar(k)});var T=Mh(k),E=Mh(i);_T(t,T,E);var D=function(n){var e=Fh.DOM,r=t.getParam("width",e.getStyle(n,"width")),o=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))}(t),i=Lh(t),u=Hh(t),a=QE(r).bind(function(t){return tD(i.map(function(n){return Math.max(t,n)}))}).getOr(tD(r)),c=QE(o).bind(function(t){return u.map(function(n){return Math.max(t,n)})}).getOr(o),s=tD(a);if(ou("div","width",s)&&Zi(k.element(),"width",s),!t.inline){var l=tD(c);ou("div","height",l)?Zi(k.element(),"height",l):Zi(k.element(),"height","200px")}return c};return{mothership:T,uiMothership:E,backstage:s,renderUI:function(){ZE(t,l,s.shared),function(t){var n=t.ui.registry.getAll().sidebars;N(Q(n),function(e){var r=n[e],o=function(){return b.from(t.queryCommandValue("ToggleSidebar")).is(e)};t.ui.registry.addToggleButton(e,{icon:r.icon,tooltip:r.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(o())},onSetup:function(n){var e=function(){return n.setActive(o())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})})}(t),KT(t,c,s.shared);var n=t.ui.registry.getAll(),r=n.buttons,o=n.menuItems,u=n.contextToolbars,a=n.sidebars,f={menuItems:o,buttons:r,menus:t.settings.menu?et(t.settings.menu,function(t){return yt(t,{items:t.items})}):{},menubar:t.settings.menubar,toolbar:Vh(t).getOr(t.getParam("toolbar",!0)),sidebar:a};NT(t,u,i,{backstage:s});var d=t.getElement(),m=D(d),g={mothership:T,uiMothership:E,outerContainer:k},p={targetNode:d,height:m};return e.render(t,g,f,s,p)},getUi:function(){return{channels:{broadcastAll:E.broadcast,broadcastOn:E.broadcastOn,register:function(){}}}}}},TD=function(t){XS.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:cT(t,n.name)})});var n="alignnone",e="No alignment",r="JustifyNone",o="align-none";t.ui.registry.addButton(n,{tooltip:e,onAction:function(){return t.execCommand(r)},icon:o})},ED=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},DD=function(t){!function(t){XS.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:cT(t,n.name),onAction:ED(t,n.name)})});for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:cT(t,e),onAction:ED(t,e)})}}(t),function(t){XS.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:function(){return t.execCommand(n.action)}})})}(t),function(t){XS.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:function(){return t.execCommand(n.action)},onSetup:cT(t,n.name)})})}(t)},AD=function(t){DD(t),function(t){XS.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:function(){return t.execCommand(n.action)}})}),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:ED(t,"code")})}(t)},RD=function(t,n,e){var r=function(){return!!n.undoManager&&n.undoManager[e]()},o=function(){t.setDisabled(n.readonly||!r())};return t.setDisabled(!r()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o)}},BD=function(t){!function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(n){return RD(n,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(n){return RD(n,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}})}(t),function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(n){return RD(n,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(n){return RD(n,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}})}(t)},ND=function(t){!function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return t.execCommand("mceToggleVisualAid")}})}(t),function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(n){return function(t,n){t.setActive(n.hasVisual);var e=function(n){t.setActive(n.hasVisual)};return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}}(n,t)},onAction:function(){t.execCommand("mceToggleVisualAid")}})}(t)},_D=function(t){!function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(n){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(n,t)},onAction:function(){return t.execCommand("outdent")}}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return t.execCommand("indent")}})}(t)},ID=function(t,n){!function(t,n){var e=hT(t),r=fT(0,n,e.dataset,e);t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})}(t,n),function(t,n){var e=bT(t),r=fT(0,n,e.dataset,e);t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})}(t,n),function(t,n){var e=n.styleselect,r=fT(0,n,e,CT(t));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})}(t,n),function(t,n){var e=ST(t),r=fT(0,n,e.dataset,e);t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})}(t,n),function(t,n){var e=wT(t),r=fT(0,n,e.dataset,e);t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})}(t,n)},MD=function(t,n){TD(t),AD(t),ID(t,n),BD(t),Jb.register(t),ND(t),_D(t)},FD=function(t,n){var e=b.from(Re(t,"id")).fold(function(){var t=Ge("dialog-label");return De(n,"id",t),t},i);De(t,"aria-labelledby",e)},PD=o([oo("lazySink"),mo("dragBlockClass"),yo("useTabstopAt",o(!0)),yo("eventOrder",{}),Ls("modalBehaviours",[Qd]),Iu("onExecute"),Fu("onEscape")]),LD={sketch:i},HD=o([ml({name:"draghandle",overrides:function(t,n){return{behaviours:Wu([bD.config({mode:"mouse",getTarget:function(t){return xu(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+xr(n,null,2)).message)})])}}}),fl({schema:[oo("dom")],name:"title"}),fl({factory:LD,schema:[oo("dom")],name:"close"}),fl({factory:LD,schema:[oo("dom")],name:"body"}),ml({factory:LD,schema:[oo("dom")],name:"footer"}),dl({factory:{sketch:function(t,n){return $e({},t,{dom:n.dom,components:n.components})}},schema:[yo("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),yo("components",[])],name:"blocker"})]),VD=jl({name:"ModalDialog",configFields:PD(),partFields:HD(),factory:function(t,n,e,r){var o=Ge("alloy.dialog.busy"),u=Ge("alloy.dialog.idle"),a=Wu([Qd.config({mode:"special",onTab:function(){return b.some(!0)},onShiftTab:function(){return b.some(!0)}}),Sm.config({})]),c=Ge("modal-events"),s=$e({},t.eventOrder,{"alloy.system.attached":[c].concat(t.eventOrder["alloy.system.attached"]||[])});return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){var e=t.lazySink(n).getOrDie(),i=Dt(b.none()),c=r.blocker(),s=e.getSystem().build($e({},c,{components:c.components.concat([yu(n)]),behaviours:Wu([Hm("dialog-blocker-events",[Yo(u,function(t,e){Be(n.element(),"aria-busy")&&(Ne(n.element(),"aria-busy"),i.get().each(function(t){return om.remove(n,t)}))}),Yo(o,function(t,e){De(n.element(),"aria-busy","true");var r=e.event().getBusySpec();i.get().each(function(t){om.remove(n,t)});var o=r(n,a),u=t.getSystem().build(o);i.set(b.some(u)),om.append(n,yu(u)),u.hasConfigured(Qd)&&Qd.focusIn(u)})])])}));hs(e,s),Qd.focusIn(n)},hide:function(t){ce(t.element()).each(function(n){t.getSystem().getByDom(n).each(function(t){ys(t)})})},getBody:function(n){return Tl(n,t,"body")},getFooter:function(n){return Tl(n,t,"footer")},setIdle:function(t){Bo(t,u)},setBusy:function(t,n){No(t,o,{getBusySpec:n})}},eventOrder:s,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Vs(t.modalBehaviours,[om.config({}),Qd.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),Hm(c,[oi(function(n){var e,r,o;FD(n.element(),Tl(n,t,"title").element()),e=n.element(),r=Tl(n,t,"body").element(),o=b.from(Re(e,"id")).fold(function(){var t=Ge("dialog-describe");return De(r,"id",t),t},i),De(e,"aria-describedby",o)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),zD=[uo("type"),uo("text"),ao("level",["info","warn","error","success"]),uo("icon"),yo("url","")],jD=[uo("type"),uo("text"),Oo("primary",!1),Pr("name","name",nr(function(){return Ge("button-name")}),to),ho("icon")],UD=[uo("type"),uo("name"),uo("label")],WD=no,GD=[uo("type"),uo("name"),ho("label")],qD=GD,$D=to,XD=GD,YD=to,KD=GD,JD=jr(),ZD=GD.concat([Oo("sandboxed",!0)]),QD=to,tA=GD.concat([ho("placeholder")]),nA=to,eA=GD.concat([lo("items",[uo("text"),uo("value")]),xo("size",1)]),rA=to,oA=GD.concat([Oo("constrain",!0)]),iA=Br([uo("width"),uo("height")]),uA=GD.concat([ho("placeholder")]),aA=to,cA=GD.concat([Co("filetype","file",["image","media","file"])]),sA=Br([uo("value"),yo("meta",{})]),lA=GD.concat([uo("type"),So("tag","textarea"),co("init")]),fA=to,dA=[uo("type"),uo("html"),Co("presets","presentation",["presentation","document"])],mA=GD.concat([io("currentState",Br([oo("blob"),uo("url")]))]),gA=GD.concat([yo("columns","auto")]),pA=zr([uo("value"),uo("text"),uo("icon")]),hA=[uo("type"),fo("header",to),fo("cells",Nr(to))],vA=function(t){return Pr("items","items",Qe(),Nr(Ur(function(n){return qr("Checking item of "+t,bA,n).fold(function(t){return gt.error(Yr(t))},function(t){return gt.value(t)})})))},bA=Kr("type",{alertbanner:zD,bar:(yD=vA("bar"),[uo("type"),yD]),button:jD,checkbox:UD,colorinput:qD,colorpicker:XD,dropzone:KD,grid:function(t){return[uo("type"),(n="columns",io(n,Qr)),t];var n}(vA("grid")),iframe:ZD,input:tA,selectbox:eA,sizeinput:oA,textarea:uA,urlinput:cA,customeditor:lA,htmlpanel:dA,imagetools:mA,collection:gA,label:function(t){return[uo("type"),uo("label"),t]}(vA("label")),table:hA}),yA=[uo("type"),fo("items",bA)],wA=[uo("title"),fo("items",bA)],xA=[uo("type"),lo("tabs",wA)],SA=[Pr("name","name",nr(function(){return Ge("button-name")}),to),uo("text"),ho("icon"),Co("align","end",["start","end"]),Oo("primary",!1),Oo("disabled",!1)],CA=Br([ao("type",["submit","cancel","custom"])].concat(SA)),OA=Br([uo("title"),io("body",Kr("type",{panel:yA,tabpanel:xA})),So("size","normal"),fo("buttons",CA),yo("initialData",{}),ko("onAction",n),ko("onChange",n),ko("onSubmit",n),ko("onClose",n),ko("onCancel",n),yo("onTabChange",n)]),kA=function(t){return x(t)?[t].concat(U(ut(t),kA)):S(t)?U(t,kA):[]},TA=function(t){return w(t.type)&&w(t.name)},EA={checkbox:WD,colorinput:$D,colorpicker:YD,dropzone:JD,input:nA,iframe:QD,sizeinput:iA,selectbox:rA,size:iA,textarea:aA,urlinput:sA,customeditor:fA,collection:pA},DA=function(t){var n=U(function(t){return M(kA(t),TA)}(t),function(t){return function(t){return b.from(EA[t.type])}(t).fold(function(){return[]},function(n){return[io(t.name,n)]})});return Br(n)},AA=Br([ao("type",["cancel","custom"])].concat(SA)),RA=Br([uo("title"),uo("url"),po("height"),po("width"),function(t,n){return go(t,Nr(n))}("buttons",AA),ko("onAction",n),ko("onCancel",n),ko("onClose",n),ko("onMessage",n)]),BA=function(t){return{internalDialog:$r(qr("dialog",OA,t)),dataValidator:DA(t),initialData:t.initialData}},NA={open:function(t,n){var e=BA(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t($r(qr("dialog",RA,n)))},redial:function(t){return BA(t)}},_A=function(t){var n=[],e={};return nt(t,function(t,r){t.fold(function(){n.push(r)},function(t){e[r]=t})}),n.length>0?gt.error(n):gt.value(e)},IA=function(n,e){var r=rg(tx.sketch(function(t){return{dom:{tag:"div",classes:["tox-form"]},components:B(n.items,function(n){return AC(t,n,e)})}}));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[r.asSpec()]}],behaviours:Wu([Qd.config({mode:"acyclic",useTabstopAt:s(Ox)}),cx(r),px(r,{postprocess:function(n){return _A(n).fold(function(n){return t.console.error(n),{}},function(t){return t})}})])}},MA=zl({name:"TabButton",configFields:[yo("uid",void 0),oo("value"),Pr("dom","dom",er(function(t){return{attributes:{role:"tab",id:Ge("aria"),"aria-selected":"false"}}}),Jr()),mo("action"),yo("domModification",{}),Ls("tabButtonBehaviours",[Sm,Qd,vm]),oo("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:ng(t.action),behaviours:Vs(t.tabButtonBehaviours,[Sm.config({}),Qd.config({mode:"execution",useSpace:!0,useEnter:!0}),vm.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),FA=o([oo("tabs"),oo("dom"),yo("clickToDismiss",!1),Ls("tabbarBehaviours",[uf,Qd]),Bu(["tabClass","selectedClass"])]),PA=gl({factory:MA,name:"tabs",unit:"tab",overrides:function(t,e){var r=function(t,n){uf.dehighlight(t,n),No(t,Ln(),{tabbar:t,button:n})},o=function(t,n){uf.highlight(t,n),No(t,Pn(),{tabbar:t,button:n})};return{action:function(e){var i=e.getSystem().getByUid(t.uid).getOrDie(),u=uf.isHighlighted(i,e);(u&&t.clickToDismiss?r:u?n:o)(i,e)},domModification:{classes:[t.markers.tabClass]}}}}),LA=o([PA]),HA=jl({name:"Tabbar",configFields:FA(),partFields:LA(),factory:function(t,n,e,r){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Vs(t.tabbarBehaviours,[uf.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){De(n.element(),"aria-selected","true")},onDehighlight:function(t,n){De(n.element(),"aria-selected","false")}}),Qd.config({mode:"flow",getInitial:function(t){return uf.getHighlighted(t).map(function(t){return t.element()})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),VA=zl({name:"Tabview",configFields:[Ls("tabviewBehaviours",[om])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:Vs(t.tabviewBehaviours,[om.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),zA=o([yo("selectFirst",!0),_u("onChangeTab"),_u("onDismissTab"),yo("tabs",[]),Ls("tabSectionBehaviours",[])]),jA=fl({factory:HA,schema:[oo("dom"),so("markers",[oo("tabClass"),oo("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),UA=fl({factory:VA,name:"tabview"}),WA=o([jA,UA]),GA=jl({name:"TabSection",configFields:zA(),partFields:WA(),factory:function(t,n,e,r){var o=function(n,e){kl(n,t,"tabbar").each(function(t){e(t).each(_o)})};return{uid:t.uid,dom:t.dom,components:n,behaviours:Hs(t.tabSectionBehaviours),events:Go(j([t.selectFirst?[oi(function(t,n){o(t,uf.getFirst)})]:[],[Yo(Pn(),function(n,e){!function(n){var e=vm.getValue(n);kl(n,t,"tabview").each(function(r){L(t.tabs,function(t){return t.value===e}).each(function(e){var o=e.view();De(r.element(),"aria-labelledby",Re(n.element(),"id")),om.set(r,o),t.onChangeTab(r,n,o)})})}(e.event().button())}),Yo(Ln(),function(n,e){var r=e.event().button();t.onDismissTab(n,r)})]])),apis:{getViewItems:function(n){return kl(n,t,"tabview").map(function(t){return om.contents(t)}).getOr([])},showTab:function(t,n){o(t,function(t){var e=uf.getCandidates(t);return L(e,function(t){return vm.getValue(t)===n}).filter(function(n){return!uf.isHighlighted(t,n)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),qA=function(n,e,r){xu(n,'[role="dialog"]').each(function(o){r.get().map(function(r){return Zi(e,"height","0"),Math.min(r,function(n,e){var r=xu(n,".tox-dialog-wrap").getOr(n);return("fixed"===nu(r,"position")?Math.max(t.document.documentElement.clientHeight,t.window.innerHeight):Math.max(t.document.documentElement.offsetHeight,t.document.documentElement.scrollHeight))-(n.dom().getBoundingClientRect().height-e.dom().getBoundingClientRect().height)}(o,n))}).each(function(t){Zi(e,"height",t+"px")})})},$A=function(t){var n;return{smartTabHeight:(n=Dt(b.none()),{extraEvents:[oi(function(e){Su(e.element(),'[role="tabpanel"]').each(function(r){Zi(r,"visibility","hidden"),e.getSystem().getByDom(r).toOption().each(function(e){var o=function(t){return K(Y(t,function(t,n){return t>n?-1:t<n?1:0}))}(function(t,n,e){return B(t,function(r,o){om.set(e,t[o].view());var i=n.dom().getBoundingClientRect();return om.set(e,[]),i.height})}(t,r,e));n.set(o)}),qA(e.element(),r,n),iu(r,"visibility"),function(t,n){K(t).each(function(t){return GA.showTab(n,t.value)})}(t,e),sg.requestAnimationFrame(function(){qA(e.element(),r,n)})})}),Yo(Bn(),function(t){Su(t.element(),'[role="tabpanel"]').each(function(e){qA(t.element(),e,n)})}),Yo(Qh,function(t,e){Su(t.element(),'[role="tabpanel"]').each(function(e){var r=yf();Zi(e,"visibility","hidden");var o=ru(e,"height").map(function(t){return parseInt(t,10)});iu(e,"height");var i=e.dom().getBoundingClientRect().height;o.forall(function(t){return i>t})?(n.set(b.from(i)),qA(t.element(),e,n)):o.each(function(t){Zi(e,"height",t+"px")}),iu(e,"visibility"),r.each(bf)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},XA=function(t,n){var e=Dt({}),r=function(t){var n=vm.getValue(t),r=_A(n).getOr({}),o=e.get(),i=bt(o,r);e.set(i)},o=function(t){var n=e.get();vm.setValue(t,n)},i=Dt(null),u=B(t.tabs,function(t){return{value:t.title,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[tx.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"]},components:B(t.items,function(t){return AC(e,t,n)}),formBehaviours:Wu([Qd.config({mode:"acyclic",useTabstopAt:s(Ox)}),Hm("TabView.form.events",[oi(o),ii(r)]),Zu.config({channels:kt([{key:"send-data-to-section",value:{onReceive:r}},{key:"send-data-to-view",value:{onReceive:o}}])})])}})]}}}),a=$A(u).smartTabHeight;return GA.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var r=vm.getValue(n);No(t,Zh,{title:r,oldTitle:i.get()}),i.set(r)},tabs:u,components:[GA.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[HA.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Wu([fb.config({})])}),GA.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:Wu([Hm("tabpanel",a.extraEvents),Qd.config({mode:"acyclic"}),ql.config({find:function(t){return K(GA.getViewItems(t))}}),vm.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn(["send-data-to-section"],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn(["send-data-to-view"],{})}}})])})},YA=Ge("update-dialog"),KA=Ge("update-title"),JA=Ge("update-body"),ZA=Ge("update-footer"),QA=Ge("body-send-message"),tR=function(t,n,e,r){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:$e({},n.map(function(t){return{id:t}}).getOr({}),r?{"aria-live":"polite"}:{})},components:[],behaviours:Wu([sx(0),_k.config({channel:JA,updateState:function(t,n){return b.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[XA({tabs:t.body.tabs},e)];default:return[IA({items:t.body.items},e)]}},initialData:t})])}},nR=function(t,n){return[ti(Vt(),kx),t(qh,function(t,e){n.onClose(),e.onClose()}),t($h,function(t,n,e,r){n.onCancel(t),Bo(r,qh)}),Yo(Jh,function(t,e){return n.onUnblock()}),Yo(Kh,function(t,e){return n.onBlock(e.event())})]},eR=function(t,n){var e=function(n,e){return Yo(n,function(n,o){r(n,function(r,i){e(t(),r,o.event(),n)})})},r=function(t,n){_k.getState(t).get().each(function(e){n(e,t)})};return nR(e,n).concat([e(Xh,function(t,n,e){n.onAction(t,{name:e.name()})})])},rR=function(t,n){var e=function(n,e){return Yo(n,function(n,o){r(n,function(r,i){e(t(),r,o.event(),n)})})},r=function(t,n){_k.getState(t).get().each(function(e){n(e.internalDialog,t)})};return nR(e,n).concat([e(Yh,function(t,n){return n.onSubmit(t)}),e(Gh,function(t,n,e){n.onChange(t,{name:e.name()})}),e(Xh,function(t,n,e){n.onAction(t,{name:e.name(),value:e.value()})}),e(Zh,function(t,n,e){n.onTabChange(t,e.title())}),ii(function(n){var e=t();vm.setValue(n,e.getData())})])},oR=function(t,n){var e=n.map(function(t){return t.footerButtons}).getOr([]),r=I(e,function(t){return"start"===t.align}),o=function(t,n){return Ih.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:B(n,function(t){return t.memento.asSpec()})})};return[o("start",r.pass),o("end",r.fail)]},iR=function(t,n){return{dom:Vg('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Wu([_k.config({channel:ZA,initialData:t,updateState:function(t,e){var r=B(e.buttons,function(t){var e=rg(function(t,n){return AS(t,t.type,n)}(t,n));return{name:t.name,align:t.align,memento:e}});return b.some({lookupByName:function(t,n){return function(t,n,e){return L(n,function(t){return t.name===e}).bind(function(n){return n.memento.getOpt(t)})}(t,r,n)},footerButtons:r})},renderComponents:oR})])}},uR=function(t,n){return VD.parts().footer(iR(t,n))},aR=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=ql.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return tx.getField(e,n).fold(function(){var r=t.getFooter();return _k.getState(r).get().bind(function(t){return t.lookupByName(e,n)})},function(t){return b.some(t)})}return b.none()},cR=function(t,n){var e=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},r={getData:function(){var n=t.getRoot(),e=n.getSystem().isConnected()?t.getFormWrapper():n;return vm.getValue(e)},setData:function(n){e(function(e){var o=r.getData(),i=yt(o,n),u=function(t,n){var e=t.getRoot();return _k.getState(e).get().map(function(t){return $r(qr("data",t.dataValidator,n))}).getOr(n)}(t,i),a=t.getFormWrapper();vm.setValue(a,u)})},disable:function(n){aR(t,n).each(mp.disable)},enable:function(n){aR(t,n).each(mp.enable)},focus:function(n){aR(t,n).each(Sm.focus)},block:function(t){if(!w(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e(function(n){No(n,Kh,{message:t})})},unblock:function(){e(function(t){Bo(t,Jh)})},showTab:function(n){e(function(e){var r=t.getBody();_k.getState(r).get().exists(function(t){return t.isTabPanel()})&&ql.getCurrent(r).each(function(t){GA.showTab(t,n)})})},redial:function(t){e(function(e){var o=n(t);e.getSystem().broadcastOn([YA],o),e.getSystem().broadcastOn([KA],o.internalDialog),e.getSystem().broadcastOn([JA],o.internalDialog),e.getSystem().broadcastOn([ZA],o.internalDialog),r.setData(o.initialData)})},close:function(){e(function(t){Bo(t,qh)})}};return r},sR=function(t){return eg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(t){Bo(t,$h)}})},lR=function(t,n,e){var r=function(t){return[pu(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:$e({},n.map(function(t){return{id:t}}).getOr({}))},components:r(t),behaviours:Wu([_k.config({channel:KA,renderComponents:r})])}},fR=function(t,n){return function(t,n){var e=VD.parts().title(lR(t,b.none(),n)),r=VD.parts().draghandle({dom:Vg('<div class="tox-dialog__draghandle"></div>')}),o=VD.parts().close(sR(n)),i=[e].concat(t.draggable?[r]:[]).concat([o]);return Ih.sketch({dom:Vg('<div class="tox-dialog__header"></div>'),components:i})}({title:n.shared.providers.translate(t),draggable:!0},n.shared.providers)},dR=function(t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(n){VD.setBusy(t(),function(t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:Vg('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}})},onUnblock:function(){VD.setIdle(t())}}},mR=function(t,n,e,r){var o;return bu(VD.sketch({lazySink:r.shared.getSink,onEscape:function(t){return Bo(t,$h),b.some(!0)},useTabstopAt:function(t){return!Ox(t)&&("button"!==xe(t)||"disabled"!==Re(t,"disabled"))},modalBehaviours:Wu([_k.config({channel:YA,updateState:function(t,n){return b.some(n)},initialData:n}),bx({}),Sm.config({}),Hm("execute-on-form",e.concat([ri(Vt(),function(t,n){Qd.focusIn(t)})])),Hm("scroll-lock",[oi(function(){Wi(Ho(),"tox-dialog__disable-scroll")}),ii(function(){Gi(Ho(),"tox-dialog__disable-scroll")})])].concat(t.extraBehaviours)),eventOrder:(o={},o[Sn()]=["execute-on-form"],o[xn()]=["reflecting","receiving"],o[Nn()]=["scroll-lock","reflecting","messages","execute-on-form","alloy.base.behaviour"],o[_n()]=["alloy.base.behaviour","execute-on-form","messages","reflecting","scroll-lock"],o),dom:{tag:"div",classes:["tox-dialog"].concat(t.extraClasses),styles:$e({position:"relative"},t.extraStyles)},components:[t.header,t.body].concat(t.footer.toArray()),dragBlockClass:"tox-dialog-wrap",parts:{blocker:{dom:Vg('<div class="tox-dialog-wrap"></div>'),components:[{dom:{tag:"div",classes:["tox-dialog-wrap__backdrop"]}}]}}}))},gR=function(t,n,e){var r=fR(t.internalDialog.title,e),o=function(t,n){var e=tR(t,b.none(),n,!1);return VD.parts().body(e)}({body:t.internalDialog.body},e),i=uR({buttons:t.internalDialog.buttons},e.shared.providers),u=rR(function(){return l},dR(function(){return s},n)),a="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],c={header:r,body:o,footer:b.some(i),extraClasses:a,extraBehaviours:[],extraStyles:{}},s=mR(c,t,u,e),l=cR({getRoot:function(){return s},getBody:function(){return VD.getBody(s)},getFooter:function(){return VD.getFooter(s)},getFormWrapper:function(){var t=VD.getBody(s);return ql.getCurrent(t).getOr(t)}},n.redial);return{dialog:s,instanceApi:l}},pR=tinymce.util.Tools.resolve("tinymce.util.URI"),hR=["insertContent","setContent","execCommand","close","block","unblock"],vR=function(t){return x(t)&&-1!==hR.indexOf(t.mceAction)},bR=function(n,e,r,o){var i,u,a,c=fR(n.title,o),l=function(t){var n={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Tx({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:Wu([fb.config({}),Sm.config({})])})]}],behaviours:Wu([Qd.config({mode:"acyclic",useTabstopAt:s(Ox)})])};return VD.parts().body(n)}(n),f=n.buttons.bind(function(t){return 0===t.length?b.none():b.some(uR({buttons:t},o.shared.providers))}),d=eR(function(){return O},dR(function(){return S},e)),m=$e({},n.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}}),n.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),g=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],p=new pR(n.url,{base_uri:new pR(t.window.location.href)}),h=p.protocol+"://"+p.host+(p.port?":"+p.port:""),v=Dt(b.none()),y=[Hm("messages",[oi(function(){var e=gh(jn.fromDom(t.window),"message",function(t){if(p.isSameOrigin(new pR(t.raw().origin))){var e=t.raw().data;vR(e)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var r=!!C(e.ui)&&e.ui;t.execCommand(e.cmd,r,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(r,O,e):function(t){return!vR(t)&&x(t)&&ct(t,"mceAction")}(e)&&n.onMessage(O,e)}});v.set(b.some(e))}),ii(function(){v.get().each(function(t){return t.unbind()})})]),Zu.config({channels:(i={},i[QA]={onReceive:function(t,n){Su(t.element(),"iframe").each(function(t){t.dom().contentWindow.postMessage(n,h)})}},i)})],S=mR({header:c,body:l,footer:f,extraClasses:g,extraBehaviours:y,extraStyles:m},n,d,o),O=(u=S,a=function(t){u.getSystem().isConnected()&&t(u)},{block:function(t){if(!w(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");a(function(n){No(n,Kh,{message:t})})},unblock:function(){a(function(t){Bo(t,Jh)})},close:function(){a(function(t){Bo(t,qh)})},sendMessage:function(t){a(function(n){n.getSystem().broadcastOn([QA],t)})}});return{dialog:S,instanceApi:O}},yR=function(t,n,e,r){var o,i,u,a,c,s=Ge("dialog-label"),l=Ge("dialog-content"),f=rg((u={title:t.internalDialog.title,draggable:!0},a=s,c=e.shared.providers,Ih.sketch({dom:Vg('<div class="tox-dialog__header"></div>'),components:[lR(u,b.some(a),c),sR(c)],containerBehaviours:Wu([bD.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Cu(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),d=rg(function(t,n,e,r){return tR(t,b.some(n),e,r)}({body:t.internalDialog.body},l,e,r)),m=rg(function(t,n){return iR(t,n)}({buttons:t.internalDialog.buttons},e.shared.providers)),g=rR(function(){return h},{onBlock:function(){},onUnblock:function(){},onClose:function(){return n.closeWindow()}}),p=bu({dom:{tag:"div",classes:["tox-dialog"],attributes:(o={role:"dialog"},o["aria-labelledby"]=s,o["aria-describedby"]=""+l,o)},eventOrder:(i={},i[xn()]=[_k.name(),Zu.name()],i[Sn()]=["execute-on-form"],i[Nn()]=["reflecting","execute-on-form"],i),behaviours:Wu([Qd.config({mode:"cyclic",onEscape:function(t){return Bo(t,qh),b.some(!0)},useTabstopAt:function(t){return!Ox(t)&&("button"!==xe(t)||"disabled"!==Re(t,"disabled"))}}),_k.config({channel:YA,updateState:function(t,n){return b.some(n)},initialData:t}),Hm("execute-on-form",g),bx({})]),components:[f.asSpec(),d.asSpec(),m.asSpec()]}),h=cR({getRoot:function(){return p},getFooter:function(){return m.get(p)},getBody:function(){return d.get(p)},getFormWrapper:function(){var t=d.get(p);return ql.getCurrent(t).getOr(t)}},n.redial);return{dialog:p,instanceApi:h}},wR=function(t,n){return VD.parts().close(eg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Wu([fb.config({})])}))},xR=function(){return VD.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},SR=function(t,n){return VD.parts().body({dom:{tag:"div",classes:["tox-dialog__body","todo-tox-fit"]},components:[{dom:Vg("<p>"+n.translate(t)+"</p>")}]})},CR=function(t){return VD.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},OR=function(t,n){return[Ih.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),Ih.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},kR=function(t){return VD.sketch({lazySink:t.lazySink,onEscape:function(){return t.onCancel(),b.some(!0)},dom:{tag:"div",classes:["tox-dialog"].concat(t.extraClasses)},components:[{dom:{tag:"div",classes:["tox-dialog__header"]},components:[t.partSpecs.title,t.partSpecs.close]},t.partSpecs.body,t.partSpecs.footer],parts:{blocker:{dom:Vg('<div class="tox-dialog-wrap"></div>'),components:[{dom:{tag:"div",classes:["tox-dialog-wrap__backdrop"]}}]}},modalBehaviours:Wu([Hm("basic-dialog-events",[Yo($h,function(n,e){t.onCancel()}),Yo(Yh,function(n,e){t.onSubmit()})])])})},TR=function(t){var e=function(t){var e=t.backstage.shared;return{open:function(t,r){var o=function(){VD.hide(u),r()},i=rg(AS({name:"close-alert",text:"OK",primary:!0,icon:b.none()},"cancel",e.providers)),u=bu(kR({lazySink:function(){return e.getSink()},partSpecs:{title:xR(),close:wR(function(){o()},e.providers),body:SR(t,e.providers),footer:CR(OR([],[i.asSpec()]))},onCancel:function(){return o()},onSubmit:n,extraClasses:["tox-alert-dialog"]}));VD.show(u);var a=i.get(u);Sm.focus(a)}}}(t),r=function(t){var n=t.backstage.shared;return{open:function(t,e){var r=function(t){VD.hide(u),e(t)},o=rg(AS({name:"yes",text:"Yes",primary:!0,icon:b.none()},"submit",n.providers)),i=AS({name:"no",text:"No",primary:!0,icon:b.none()},"cancel",n.providers),u=bu(kR({lazySink:function(){return n.getSink()},partSpecs:{title:xR(),close:wR(function(){r(!1)},n.providers),body:SR(t,n.providers),footer:CR(OR([],[i,o.asSpec()]))},onCancel:function(){return r(!1)},onSubmit:function(){return r(!0)},extraClasses:["tox-confirm-dialog"]}));VD.show(u);var a=o.get(u);Sm.focus(a)}}}(t),o=function(n,e){return NA.openUrl(function(n){var r=bR(n,{closeWindow:function(){VD.hide(r.dialog),e(r.instanceApi)}},t.editor,t.backstage);return VD.show(r.dialog),r.instanceApi},n)},i=function(n,e){return NA.open(function(n,r,o){var i=r,u=gR({dataValidator:o,initialData:i,internalDialog:n},{redial:NA.redial,closeWindow:function(){VD.hide(u.dialog),e(u.instanceApi)}},t.backstage);return VD.show(u.dialog),u.instanceApi.setData(i),u.instanceApi},n)},u=function(n,e,r,o){return NA.open(function(n,i,u){var a=$r(qr("data",u,i)),c=yR({dataValidator:u,initialData:a,internalDialog:n},{redial:NA.redial,closeWindow:function(){tg.hide(s),r(c.instanceApi)}},t.backstage,o),s=bu(tg.sketch({lazySink:t.backstage.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},inlineBehaviours:Wu([Hm("window-manager-inline-events",[Yo(In(),function(t,n){Bo(c.dialog,$h)})])])}));return tg.showAt(s,e,yu(c.dialog)),c.instanceApi.setData(a),Qd.focusIn(c.dialog),c.instanceApi},n)};return{open:function(n,e,r){return void 0!==e&&"toolbar"===e.inline?u(n,t.backstage.shared.anchors.toolbar(),r,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?u(n,t.backstage.shared.anchors.cursor(),r,e.ariaAttrs):i(n,r)},openUrl:function(t,n){return o(t,n)},alert:function(t,n){e.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){r.open(t,function(t){n(t)})}}};qe.add("silver",function(t){var n=kD(t),e=n.mothership,r=n.uiMothership,i=n.backstage,u=n.renderUI,a=n.getUi;MD(t,i),je(Ge("silver-demo"),e),je(Ge("silver-ui-demo"),r),sh(t,i.shared);var c=TR({editor:t,backstage:i});return{renderUI:u,getWindowManagerImpl:o(c),getNotificationManagerImpl:function(){return lg(t,{backstage:i},r)},ui:a()}})}(window)},"03e2":function(t,n,e){},"07d1":function(t,n,e){e("94ce")},"09cf":function(t,n){!function(t){"use strict";tinymce.util.Tools.resolve("tinymce.PluginManager").add("textcolor",function(){t.console.warn("Text color plugin is now built in to the core editor, please remove it from your editor configuration")})}(window)},"0d68":function(t,n,e){e("030f")},1733:function(t,n,e){"use strict";var r=e("2f75");e.n(r).a},"1f38":function(t,n,e){"use strict";(function(t){e.d(n,"a",function(){return o});var r=function(){return"undefined"!=typeof window?window:t},o=function(){var t=r();return t&&t.tinymce?t.tinymce:null}}).call(this,e("c8ba"))},2401:function(t,n){!function(t){"use strict";var n,e,r,o,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),a=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),c=tinymce.util.Tools.resolve("tinymce.util.VK"),s=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),l=tinymce.util.Tools.resolve("tinymce.util.Tools"),f=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),d=function(t){return t&&"BR"===t.nodeName},m=function(t){return t&&3===t.nodeType},g=function(t){return t&&/^(OL|UL|DL)$/.test(t.nodeName)},p=function(t){return t&&/^(OL|UL)$/.test(t.nodeName)},h=function(t){return t&&/^(DT|DD)$/.test(t.nodeName)},v=function(t){return t&&/^(LI|DT|DD)$/.test(t.nodeName)},b=function(t){return t&&/^(TH|TD)$/.test(t.nodeName)},y=d,w=function(t,n){return n&&!!t.schema.getTextBlockElements()[n.nodeName]},x=function(t,n){return t&&t.nodeName in n},S=function(t,n){return!!d(n)&&!(!t.isBlock(n.nextSibling)||d(n.previousSibling))},C=function(t,n,e){var r=t.isEmpty(n);return!(e&&t.select("span[data-mce-type=bookmark]",n).length>0)&&r},O=function(t,n){return t.isChildOf(n,t.getRoot())},k=function(t,n){if(m(t))return{container:t,offset:n};var e=u.getNode(t,n);return m(e)?{container:e,offset:n>=t.childNodes.length?e.data.length:0}:e.previousSibling&&m(e.previousSibling)?{container:e.previousSibling,offset:e.previousSibling.data.length}:e.nextSibling&&m(e.nextSibling)?{container:e.nextSibling,offset:0}:{container:t,offset:n}},T=function(t){var n=t.cloneRange(),e=k(t.startContainer,t.startOffset);n.setStart(e.container,e.offset);var r=k(t.endContainer,t.endOffset);return n.setEnd(r.container,r.offset),n},E=f.DOM,D=function(t){var n={},e=function(e){var r,o,i;o=t[e?"startContainer":"endContainer"],i=t[e?"startOffset":"endOffset"],1===o.nodeType&&(r=E.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),e?o.insertBefore(r,o.childNodes[i]):E.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),n[e?"startContainer":"endContainer"]=o,n[e?"startOffset":"endOffset"]=i};return e(!0),t.collapsed||e(),n},A=function(t){function n(n){var e,r,o;e=o=t[n?"startContainer":"endContainer"],r=t[n?"startOffset":"endOffset"],e&&(1===e.nodeType&&(r=function(t){for(var n=t.parentNode.firstChild,e=0;n;){if(n===t)return e;1===n.nodeType&&"bookmark"===n.getAttribute("data-mce-type")||e++,n=n.nextSibling}return-1}(e),e=e.parentNode,E.remove(o),!e.hasChildNodes()&&E.isBlock(e)&&e.appendChild(E.create("br"))),t[n?"startContainer":"endContainer"]=e,t[n?"startOffset":"endOffset"]=r)}n(!0),n();var e=E.createRng();return e.setStart(t.startContainer,t.startOffset),t.endContainer&&e.setEnd(t.endContainer,t.endOffset),T(e)},R=function(t){return function(){return t}},B=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}},N=R(!1),_=R(!0),I=N,M=_,F=function(){return P},P=function(){var t=function(t){return t.isNone()},n=function(t){return t()},e=function(t){return t},r={fold:function(t,n){return t()},is:I,isSome:I,isNone:M,getOr:e,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:e,orThunk:n,map:F,ap:F,each:function(){},bind:F,flatten:F,exists:I,forall:M,filter:F,equals:t,equals_:t,toArray:function(){return[]},toString:R("none()")};return Object.freeze&&Object.freeze(r),r}(),L=function(t){var n=function(){return t},e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:M,isNone:I,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return L(n(t))},ap:function(n){return n.fold(F,function(n){return L(n(t))})},each:function(n){n(t)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(t)?o:P},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(I,function(n){return e(t,n)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},H={some:L,none:F,from:function(t){return null==t?P:L(t)}},V=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(n)===t}},z=V("string"),j=V("boolean"),U=V("function"),W=V("number"),G=(Array.prototype.indexOf,function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o,t)}return r}),q=function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e,t)},$=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r,t)&&e.push(i)}return e},X=function(t,n){if(0===t.length)return[];for(var e=n(t[0]),r=[],o=[],i=0,u=t.length;i<u;i++){var a=t[i],c=n(a);c!==e&&(r.push(o),o=[]),e=c,o.push(a)}return 0!==o.length&&r.push(o),r},Y=function(t,n,e){return q(t,function(t){e=n(e,t)}),e},K=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e,t))return H.some(o)}return H.none()},J=Array.prototype.push,Z=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!Array.prototype.isPrototypeOf(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);J.apply(n,t[e])}return n},Q=function(t,n){var e=G(t,n);return Z(e)},tt=Array.prototype.slice,nt=function(t){var n=tt.call(t,0);return n.reverse(),n},et=function(t){return 0===t.length?H.none():H.some(t[0])},rt=function(t){return 0===t.length?H.none():H.some(t[t.length-1])},ot=(U(Array.from)&&Array.from,void 0!==t.window?t.window:Function("return this;")()),it=function(t,n){return function(t,n){for(var e=null!=n?n:ot,r=0;r<t.length&&null!=e;++r)e=e[t[r]];return e}(t.split("."),n)},ut=function(t,n){var e=function(t,n){return it(t,n)}(t,n);if(null==e)throw t+" not available on this browser";return e},at=function(t){return function(t){return ut("HTMLElement",t)}(it("ownerDocument.defaultView",t)).prototype.isPrototypeOf(t)},ct=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),st=function(t){var n=t.selection.getStart(!0);return t.dom.getParent(n,"OL,UL,DL",ft(t,n))},lt=function(t){var n=t.selection.getSelectedBlocks();return l.grep(function(t,n){var e=l.map(n,function(n){var e=t.dom.getParent(n,"li,dd,dt",ft(t,n));return e||n});return ct.unique(e)}(t,n),function(t){return v(t)})},ft=function(t,n){var e=t.dom.getParents(n,"TD,TH");return e.length>0?e[0]:t.getBody()},dt=function(t,n){var e=t.dom.getParents(n,"ol,ul",ft(t,n));return rt(e)},mt=function(t,n){var e=G(n,function(n){return dt(t,n).getOr(n)});return ct.unique(e)},gt={isList:function(t){var n=st(t);return at(n)},getParentList:st,getSelectedSubLists:function(t){var n=st(t),e=t.selection.getSelectedBlocks();return function(t,n){return t&&1===n.length&&n[0]===t}(n,e)?function(t){return l.grep(t.querySelectorAll("ol,ul,dl"),function(t){return g(t)})}(n):l.grep(e,function(t){return g(t)&&n!==t})},getSelectedListItems:lt,getClosestListRootElm:ft,getSelectedDlItems:function(t){return $(lt(t),h)},getSelectedListRoots:function(t){var n=function(t){var n=dt(t,t.selection.getStart()),e=$(t.selection.getSelectedBlocks(),p);return n.toArray().concat(e)}(t);return mt(t,n)}},pt=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:R(t)}},ht={fromHtml:function(n,e){var r=(e||t.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return pt(r.childNodes[0])},fromTag:function(n,e){var r=(e||t.document).createElement(n);return pt(r)},fromText:function(n,e){var r=(e||t.document).createTextNode(n);return pt(r)},fromDom:pt,fromPoint:function(t,n,e){var r=t.dom();return H.from(r.elementFromPoint(n,e)).map(pt)}},vt=function(t,n){for(var e=[],r=0;r<t.length;r++){var o=t[r];if(!o.isSome())return H.none();e.push(o.getOrDie())}return H.some(n.apply(null,e))},bt=Object.keys,yt=function(){return ut("Node")},wt=function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)},xt=function(t,n){return wt(t,n,yt().DOCUMENT_POSITION_CONTAINED_BY)},St=function(){return Ct(0,0)},Ct=function(t,n){return{major:t,minor:n}},Ot={nu:Ct,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?St():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}}(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return Ct(r(1),r(2))}(t,e)},unknown:St},kt=function(t,n){return function(){return n===t}},Tt=function(t){var n=t.current;return{current:n,version:t.version,isEdge:kt("Edge",n),isChrome:kt("Chrome",n),isIE:kt("IE",n),isOpera:kt("Opera",n),isFirefox:kt("Firefox",n),isSafari:kt("Safari",n)}},Et={unknown:function(){return Tt({current:void 0,version:Ot.unknown()})},nu:Tt,edge:R("Edge"),chrome:R("Chrome"),ie:R("IE"),opera:R("Opera"),firefox:R("Firefox"),safari:R("Safari")},Dt=function(t,n){return function(){return n===t}},At=function(t){var n=t.current;return{current:n,version:t.version,isWindows:Dt("Windows",n),isiOS:Dt("iOS",n),isAndroid:Dt("Android",n),isOSX:Dt("OSX",n),isLinux:Dt("Linux",n),isSolaris:Dt("Solaris",n),isFreeBSD:Dt("FreeBSD",n)}},Rt={unknown:function(){return At({current:void 0,version:Ot.unknown()})},nu:At,windows:R("Windows"),ios:R("iOS"),android:R("Android"),linux:R("Linux"),osx:R("OSX"),solaris:R("Solaris"),freebsd:R("FreeBSD")},Bt=function(t,n){var e=String(n).toLowerCase();return K(t,function(t){return t.search(e)})},Nt=function(t,n){return Bt(t,n).map(function(t){var e=Ot.detect(t.versionRegexes,n);return{current:t.name,version:e}})},_t=function(t,n){return Bt(t,n).map(function(t){var e=Ot.detect(t.versionRegexes,n);return{current:t.name,version:e}})},It=function(t,n){return-1!==t.indexOf(n)},Mt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Ft=function(t){return function(n){return It(n,t)}},Pt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return It(t,"edge/")&&It(t,"chrome")&&It(t,"safari")&&It(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Mt],search:function(t){return It(t,"chrome")&&!It(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return It(t,"msie")||It(t,"trident")}},{name:"Opera",versionRegexes:[Mt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Ft("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Ft("firefox")},{name:"Safari",versionRegexes:[Mt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(It(t,"safari")||It(t,"mobile/"))&&It(t,"applewebkit")}}],Lt=[{name:"Windows",search:Ft("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return It(t,"iphone")||It(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Ft("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Ft("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Ft("linux"),versionRegexes:[]},{name:"Solaris",search:Ft("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Ft("freebsd"),versionRegexes:[]}],Ht={browsers:R(Pt),oses:R(Lt)},Vt=function(t){var n=Ht.browsers(),e=Ht.oses(),r=Nt(n,t).fold(Et.unknown,Et.nu),o=_t(e,t).fold(Rt.unknown,Rt.nu),i=function(t,n,e){var r=t.isiOS()&&!0===/ipad/i.test(e),o=t.isiOS()&&!r,i=t.isAndroid()&&3===t.version.major,u=t.isAndroid()&&4===t.version.major,a=r||i||u&&!0===/mobile/i.test(e),c=t.isiOS()||t.isAndroid(),s=c&&!a,l=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e);return{isiPad:R(r),isiPhone:R(o),isTablet:R(a),isPhone:R(s),isTouch:R(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:R(l)}}(o,r,t);return{browser:r,os:o,deviceType:i}},zt={detect:(n=function(){var n=t.navigator.userAgent;return Vt(n)},r=!1,function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return r||(r=!0,e=n.apply(null,t)),e})},jt=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE,t.Node.DOCUMENT_NODE,t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),Ut=(t.Node.TEXT_NODE,t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,jt),Wt=function(t,n){return t.dom()===n.dom()},Gt=zt.detect().browser.isIE()?function(t,n){return xt(t.dom(),n.dom())}:function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},qt=function(t,n){var e=t.dom();if(e.nodeType!==Ut)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},$t=function(t){var n=t.dom();return H.from(n.parentNode).map(ht.fromDom)},Xt=function(t){var n=t.dom();return G(n.childNodes,ht.fromDom)},Yt=function(t,n){var e=t.dom().childNodes;return H.from(e[n]).map(ht.fromDom)},Kt=function(t){return Yt(t,0)},Jt=function(t){return Yt(t,t.dom().childNodes.length-1)},Zt=(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]}("element","offset"),function(t,n){$t(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})}),Qt=function(t,n){t.dom().appendChild(n.dom())},tn=function(t,n){q(n,function(n){Qt(t,n)})},nn=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},en=function(t){return t.dom().nodeName.toLowerCase()},rn=function(n,e){var r=n.dom();!function(t,n){for(var e=bt(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i,t)}}(e,function(n,e){!function(n,e,r){if(!(z(r)||j(r)||W(r)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")}(r,e,n)})},on=function(t){return Y(t.dom().attributes,function(t,n){return t[n.name]=n.value,t},{})},un=function(n,e,r){!function(n,e,r){if(!z(r))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);(function(t){return void 0!==t.style})(n)&&n.style.setProperty(e,r)}(n.dom(),e,r)},an=function(t){return function(t,n){return ht.fromDom(t.dom().cloneNode(n))}(t,!0)},cn=function(t,n){var e=function(t,n){var e=ht.fromTag(n),r=on(t);return rn(e,r),e}(t,n);Zt(t,e);var r=Xt(t);return tn(e,r),nn(t),e},sn=function(t,n){Qt(t.item,n.list)},ln=function(t,n){var e={list:ht.fromTag(n,t),item:ht.fromTag("li",t)};return Qt(e.list,e.item),e},fn=function(t,n,e){var r=n.slice(0,e.depth);return rt(r).each(function(n){!function(t,n){Qt(t.list,n),t.item=n}(n,function(t,n,e){var r=ht.fromTag("li",t);return rn(r,n),tn(r,e),r}(t,e.itemAttributes,e.content)),function(t,n){en(t.list)!==n.listType&&(t.list=cn(t.list,n.listType)),rn(t.list,n.listAttributes)}(n,e)}),r},dn=function(t,n,e){var r,o=function(t,n,e){for(var r=[],o=0;o<e;o++)r.push(ln(t,n.listType));return r}(t,e,e.depth-n.length);return function(t){for(var n=1;n<t.length;n++)sn(t[n-1],t[n])}(o),function(t,n){for(var e=0;e<t.length-1;e++)un(t[e].item,"list-style-type","none");rt(t).each(function(t){rn(t.list,n.listAttributes),rn(t.item,n.itemAttributes),tn(t.item,n.content)})}(o,e),r=o,vt([rt(n),et(r)],sn),n.concat(o)},mn=function(t){return qt(t,"OL,UL")},gn=function(t){return Kt(t).map(mn).getOr(!1)},pn=function(t){return t.depth>0},hn=function(t){return t.isSelected},vn=function(t){var n=Xt(t),e=Jt(t).map(mn).getOr(!1)?n.slice(0,-1):n;return G(e,an)},bn=Object.prototype.hasOwnProperty,yn=(o=function(t,n){return n},function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},r=0;r<t.length;r++){var i=t[r];for(var u in i)bn.call(i,u)&&(e[u]=o(e[u],i[u]))}return e}),wn=function(t){q(t,function(n,e){(function(t,n){for(var e=t[n].depth,r=n-1;r>=0;r--){if(t[r].depth===e)return H.some(t[r]);if(t[r].depth<e)break}return H.none()})(t,e).each(function(t){var e,r;r=t,(e=n).listType=r.listType,e.listAttributes=yn({},r.listAttributes)})})},xn=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return xn(e())}}},Sn=function(t,n,e,r){return Kt(r).filter(mn).fold(function(){n.each(function(t){Wt(t.start,r)&&e.set(!0)});var o=function(t,n,e){return $t(t).map(function(r){return{depth:n,isSelected:e,content:vn(t),itemAttributes:on(t),listAttributes:on(r),listType:en(r)}})}(r,t,e.get());n.each(function(t){Wt(t.end,r)&&e.set(!1)});var i=Jt(r).filter(mn).map(function(r){return Cn(t,n,e,r)}).getOr([]);return o.toArray().concat(i)},function(r){return Cn(t,n,e,r)})},Cn=function(t,n,e,r){return Q(Xt(r),function(r){return(mn(r)?Cn:Sn)(t+1,n,e,r)})},On=tinymce.util.Tools.resolve("tinymce.Env"),kn=function(t,n){var e,r,o,i,u=t.dom,a=t.schema.getBlockElements(),c=u.createFragment();if(t.settings.forced_root_block&&(o=t.settings.forced_root_block),o&&((r=u.create(o)).tagName===t.settings.forced_root_block&&u.setAttribs(r,t.settings.forced_root_block_attrs),x(n.firstChild,a)||c.appendChild(r)),n)for(;e=n.firstChild;){var s=e.nodeName;i||"SPAN"===s&&"bookmark"===e.getAttribute("data-mce-type")||(i=!0),x(e,a)?(c.appendChild(e),r=null):o?(r||(r=u.create(o),c.appendChild(r)),r.appendChild(e)):c.appendChild(e)}return t.settings.forced_root_block?i||On.ie&&!(On.ie>10)||r.appendChild(u.create("br",{"data-mce-bogus":"1"})):c.appendChild(u.create("br")),c},Tn=function(t,n,e){return t.fire("ListMutation",{action:n,element:e})},En=function(n,e){return G(e,function(e){var r,o,i,u=(r=e.content,i=(o||t.document).createDocumentFragment(),q(r,function(t){i.appendChild(t.dom())}),ht.fromDom(i));return ht.fromDom(kn(n,u.dom()))})},Dn=function(t,n){return wn(n),function(t,n){var e=Y(n,function(n,e){return e.depth>n.length?dn(t,n,e):fn(t,n,e)},[]);return et(e).map(function(t){return t.list})}(t.contentDocument,n).toArray()},An=function(t,n,e){var r=function(t,n){var e=xn(!1);return G(t,function(t){return{sourceList:t,entries:Cn(0,n,e,t)}})}(n,function(t){var n=G(gt.getSelectedListItems(t),ht.fromDom);return vt([K(n,B(gn)),K(nt(n),B(gn))],function(t,n){return{start:t,end:n}})}(t));q(r,function(n){!function(t,n){q($(t,hn),function(t){return function(t,n){switch(t){case"Indent":n.depth++;break;case"Outdent":n.depth--;break;case"Flatten":n.depth=0}}(n,t)})}(n.entries,e);var r,o=function(t,n){return Q(X(n,pn),function(n){return et(n).map(pn).getOr(!1)?Dn(t,n):En(t,n)})}(t,n.entries);q(o,function(n){Tn(t,"Indent"===e?"IndentList":"OutdentList",n.dom())}),r=n.sourceList,q(o,function(t){Zt(r,t)}),nn(n.sourceList)})},Rn=f.DOM,Bn=function(t,n,e){var r,o,i,u,a,c;for(i=Rn.select('span[data-mce-type="bookmark"]',n),a=kn(t,e),(r=Rn.createRng()).setStartAfter(e),r.setEndAfter(n),u=(o=r.extractContents()).firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&t.dom.isEmpty(u)){Rn.remove(u);break}t.dom.isEmpty(o)||Rn.insertAfter(o,n),Rn.insertAfter(a,n),C(t.dom,e.parentNode)&&(c=e.parentNode,l.each(i,function(t){c.parentNode.insertBefore(t,e.parentNode)}),Rn.remove(c)),Rn.remove(e),C(t.dom,n)&&Rn.remove(n)},Nn=function(t){qt(t,"DT")&&cn(t,"DD")},_n=function(t,n,e){q(e,"Indent"===n?Nn:function(n){return function(t,n){qt(n,"DD")?cn(n,"DT"):qt(n,"DT")&&$t(n).each(function(e){return Bn(t,e.dom(),n.dom())})}(t,n)})},In=function(t,n){var e=G(gt.getSelectedListRoots(t),ht.fromDom),r=G(gt.getSelectedDlItems(t),ht.fromDom),o=!1;if(e.length||r.length){var i=t.selection.getBookmark();An(t,e,n),_n(t,n,r),t.selection.moveToBookmark(i),t.selection.setRng(T(t.selection.getRng())),t.nodeChanged(),o=!0}return o},Mn=function(t){return In(t,"Indent")},Fn=function(t){return In(t,"Outdent")},Pn=function(t){return In(t,"Flatten")},Ln=function(t){return/\btox\-/.test(t.className)},Hn=function(t){switch(t){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},Vn=function(t,n){l.each(n,function(n,e){t.setAttribute(e,n)})},zn=function(t,n,e){!function(t,n,e){var r=e["list-style-type"]?e["list-style-type"]:null;t.setStyle(n,"list-style-type",r)}(t,n,e),function(t,n,e){Vn(n,e["list-attributes"]),l.each(t.select("li",n),function(t){Vn(t,e["list-item-attributes"])})}(t,n,e)},jn=function(t,n,e,r){var o,i;for(o=n[e?"startContainer":"endContainer"],i=n[e?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!e&&y(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(w(t,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},Un=function(t,n,e){void 0===e&&(e={});var r,o=t.selection.getRng(!0),i="LI",u=gt.getClosestListRootElm(t,t.selection.getStart(!0)),a=t.dom;"false"!==a.getContentEditable(t.selection.getNode())&&("DL"===(n=n.toUpperCase())&&(i="DT"),r=D(o),l.each(function(t,n,e){for(var r,o=[],i=t.dom,u=jn(t,n,!0,e),a=jn(t,n,!1,e),c=[],f=u;f&&(c.push(f),f!==a);f=f.nextSibling);return l.each(c,function(n){if(w(t,n))return o.push(n),void(r=null);if(i.isBlock(n)||y(n))return y(n)&&i.remove(n),void(r=null);var u=n.nextSibling;s.isBookmarkNode(n)&&(w(t,u)||!u&&n.parentNode===e)?r=null:(r||(r=i.create("p"),n.parentNode.insertBefore(r,n),o.push(r)),r.appendChild(n))}),o}(t,o,u),function(r){var o,u;(u=r.previousSibling)&&g(u)&&u.nodeName===n&&function(t,n,e){var r=t.getStyle(n,"list-style-type"),o=e?e["list-style-type"]:"";return r===(null===o?"":o)}(a,u,e)?(o=u,r=a.rename(r,i),u.appendChild(r)):(o=a.create(n),r.parentNode.insertBefore(o,r),o.appendChild(r),r=a.rename(r,i)),function(t,n,e){l.each(e,function(e){var r;return t.setStyle(n,((r={})[e]="",r))})}(a,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),zn(a,o,e),Gn(t.dom,o)}),t.selection.setRng(A(r)))},Wn=function(t,n,e){return function(t,n){return t&&n&&g(t)&&t.nodeName===n.nodeName}(n,e)&&function(t,n,e){return t.getStyle(n,"list-style-type",!0)===t.getStyle(e,"list-style-type",!0)}(t,n,e)&&(r=e,n.className===r.className);var r},Gn=function(t,n){var e,r;if(e=n.nextSibling,Wn(t,n,e)){for(;r=e.firstChild;)n.appendChild(r);t.remove(e)}if(e=n.previousSibling,Wn(t,n,e)){for(;r=e.lastChild;)n.insertBefore(r,n.firstChild);t.remove(e)}},qn=function(t,n,e,r,o){if(n.nodeName!==r||$n(o)){var i=D(t.selection.getRng(!0));l.each([n].concat(e),function(n){!function(t,n,e,r){if(n.nodeName!==e){var o=t.dom.rename(n,e);zn(t.dom,o,r),Tn(t,Hn(e),o)}else zn(t.dom,n,r),Tn(t,Hn(e),n)}(t,n,r,o)}),t.selection.setRng(A(i))}else Pn(t)},$n=function(t){return"list-style-type"in t},Xn={toggleList:function(t,n,e){var r=gt.getParentList(t),o=gt.getSelectedSubLists(t);e=e||{},r&&o.length>0?qn(t,r,o,n,e):function(t,n,e,r){if(n!==t.getBody())if(n)if(n.nodeName!==e||$n(r)||Ln(n)){var o=D(t.selection.getRng(!0));zn(t.dom,n,r);var i=t.dom.rename(n,e);Gn(t.dom,i),t.selection.setRng(A(o)),Tn(t,Hn(e),i)}else Pn(t);else Un(t,e,r),Tn(t,Hn(e),n)}(t,r,n,e)},mergeWithAdjacentLists:Gn},Yn=f.DOM,Kn=function(t,n){var e,r=n.parentNode;"LI"===r.nodeName&&r.firstChild===n&&((e=r.previousSibling)&&"LI"===e.nodeName?(e.appendChild(n),C(t,r)&&Yn.remove(r)):Yn.setStyle(r,"listStyleType","none")),g(r)&&(e=r.previousSibling)&&"LI"===e.nodeName&&e.appendChild(n)},Jn=function(t,n){l.each(l.grep(t.select("ol,ul",n)),function(n){Kn(t,n)})},Zn=function(t,n,e,r){var o=n.startContainer,i=n.startOffset;if(3===o.nodeType&&(e?i<o.data.length:i>0))return o;var c=t.schema.getNonEmptyElements();1===o.nodeType&&(o=u.getNode(o,i));var s=new a(o,r);for(e&&S(t.dom,o)&&s.next();o=s[e?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(c[o.nodeName])return o;if(3===o.nodeType&&o.data.length>0)return o}},Qn=function(t,n){var e=n.childNodes;return 1===e.length&&!g(e[0])&&t.isBlock(e[0])},te=function(t,n,e){var r,o;if(o=Qn(t,e)?e.firstChild:e,function(t,n){Qn(t,n)&&t.remove(n.firstChild,!0)}(t,n),!C(t,n,!0))for(;r=n.firstChild;)o.appendChild(r)},ne=function(t,n,e){var r,o,i=n.parentNode;if(O(t,n)&&O(t,e)){g(e.lastChild)&&(o=e.lastChild),i===e.lastChild&&y(i.previousSibling)&&t.remove(i.previousSibling),(r=e.lastChild)&&y(r)&&n.hasChildNodes()&&t.remove(r),C(t,e,!0)&&t.$(e).empty(),te(t,n,e),o&&e.appendChild(o);var u=Gt(ht.fromDom(e),ht.fromDom(n))?t.getParents(n,g,e):[];t.remove(n),q(u,function(n){C(t,n)&&n!==t.getRoot()&&t.remove(n)})}},ee=function(t,n,e,r){var o=t.dom;if(o.isEmpty(r))!function(t,n,e){t.dom.$(e).empty(),ne(t.dom,n,e),t.selection.setCursorLocation(e)}(t,e,r);else{var i=D(n);ne(o,e,r),t.selection.setRng(A(i))}},re=function(t,n){var e,r,o,i=t.dom,u=t.selection,a=u.getStart(),c=gt.getClosestListRootElm(t,a),s=i.getParent(u.getStart(),"LI",c);if(s){if((e=s.parentNode)===t.getBody()&&C(i,e))return!0;if(r=T(u.getRng(!0)),(o=i.getParent(Zn(t,r,n,c),"LI",c))&&o!==s)return n?ee(t,r,o,s):function(t,n,e,r){var o=D(n);ne(t.dom,e,r);var i=A(o);t.selection.setRng(i)}(t,r,s,o),!0;if(!o&&!n)return Pn(t),!0}return!1},oe=function(t,n){return re(t,n)||function(t,n){var e=t.dom,r=t.selection.getStart(),o=gt.getClosestListRootElm(t,r),i=e.getParent(r,e.isBlock,o);if(i&&e.isEmpty(i)){var u=T(t.selection.getRng(!0)),a=e.getParent(Zn(t,u,n,o),"LI",o);if(a)return t.undoManager.transact(function(){!function(t,n,e){var r=t.getParent(n.parentNode,t.isBlock,e);t.remove(n),r&&t.isEmpty(r)&&t.remove(r)}(e,i,o),Xn.mergeWithAdjacentLists(e,a.parentNode),t.selection.select(a,!0),t.selection.collapse(n)}),!0}return!1}(t,n)},ie=function(t,n){return t.selection.isCollapsed()?oe(t,n):function(t){var n=t.selection.getStart(),e=gt.getClosestListRootElm(t,n);return!!(t.dom.getParent(n,"LI,DT,DD",e)||gt.getSelectedListItems(t).length>0)&&(t.undoManager.transact(function(){t.execCommand("Delete"),Jn(t.dom,t.getBody())}),!0)}(t)},ue=function(t){t.on("keydown",function(n){n.keyCode===c.BACKSPACE?ie(t,!1)&&n.preventDefault():n.keyCode===c.DELETE&&ie(t,!0)&&n.preventDefault()})},ae=ie,ce=function(t){return{backspaceDelete:function(n){ae(t,n)}}},se=function(t,n){return function(){var e=t.dom.getParent(t.selection.getStart(),"UL,OL,DL");return e&&e.nodeName===n}},le=function(t){t.on("BeforeExecCommand",function(n){var e=n.command.toLowerCase();"indent"===e?Mn(t):"outdent"===e&&Fn(t)}),t.addCommand("InsertUnorderedList",function(n,e){Xn.toggleList(t,"UL",e)}),t.addCommand("InsertOrderedList",function(n,e){Xn.toggleList(t,"OL",e)}),t.addCommand("InsertDefinitionList",function(n,e){Xn.toggleList(t,"DL",e)}),t.addCommand("RemoveList",function(){Pn(t)}),t.addQueryStateHandler("InsertUnorderedList",se(t,"UL")),t.addQueryStateHandler("InsertOrderedList",se(t,"OL")),t.addQueryStateHandler("InsertDefinitionList",se(t,"DL"))},fe=function(t){return t.getParam("lists_indent_on_tab",!0)},de=function(t){fe(t)&&function(t){t.on("keydown",function(n){n.keyCode!==c.TAB||c.metaKeyPressed(n)||t.undoManager.transact(function(){(n.shiftKey?Fn(t):Mn(t))&&n.preventDefault()})})}(t),ue(t)},me=function(t,n){return function(e){var r=function(t){var r=function(t,n){for(var e=0;e<t.length;e++)if(n(t[e]))return e;return-1}(t.parents,b),o=-1!==r?t.parents.slice(0,r):t.parents,i=l.grep(o,g);e.setActive(i.length>0&&i[0].nodeName===n&&!Ln(i[0]))};return t.on("NodeChange",r),function(){return t.off("NodeChange",r)}}},ge=function(t){var n=function(n){return function(){return t.execCommand(n)}};(function(t,n){var e=t.settings.plugins?t.settings.plugins:"";return-1!==l.inArray(e.split(/[ ,]/),n)})(t,"advlist")||(t.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:n("InsertOrderedList"),onSetup:me(t,"OL")}),t.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:n("InsertUnorderedList"),onSetup:me(t,"UL")}))};i.add("lists",function(t){return de(t),ge(t),le(t),ce(t)})}(window)},"2d33":function(t,n,e){e("303c")},"2f75":function(t,n,e){},"303c":function(t,n){!function(t){"use strict";tinymce.util.Tools.resolve("tinymce.PluginManager").add("colorpicker",function(){t.console.warn("Color picker plugin is now built in to the core editor, please remove it from your editor configuration")})}(window)},"34de":function(t,n,e){e("09cf")},4237:function(t,n,e){e("be7f")},"4ea8":function(t,n,e){e("cdd9")},5969:function(t,n,e){},"5e4c":function(t,n){!function(t){"use strict";tinymce.util.Tools.resolve("tinymce.PluginManager").add("contextmenu",function(){t.console.warn("Context menu plugin is now built in to the core editor, please remove it from your editor configuration")})}(window)},"64d8":function(t,n,e){e("ef1f")},"76f7":function(t,n,e){"use strict";var r=e("5969");e.n(r).a},"836f":function(t,n){tinymce.addI18n("zh_CN",{Redo:"重复",Undo:"撤消",Cut:"剪切",Copy:"复制",Paste:"粘贴","Select all":"全选","New document":"新文档",Ok:"确定",Cancel:"取消","Visual aids":"网格线",Bold:"粗体",Italic:"斜体",Underline:"下划线",Strikethrough:"删除线",Superscript:"上标",Subscript:"下标","Clear formatting":"清除格式","Align left":"左对齐","Align center":"居中","Align right":"右对齐",Justify:"两端对齐","Bullet list":"项目符号","Numbered list":"编号列表","Decrease indent":"减少缩进","Increase indent":"增加缩进",Close:"关闭",Formats:"格式","Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.":"你的浏览器不支持对剪贴板的访问，请使用Ctrl+X/C/V键进行复制粘贴。",Headers:"标题","Header 1":"标题1","Header 2":"标题2","Header 3":"标题3","Header 4":"标题4","Header 5":"标题5","Header 6":"标题6",Headings:"标题","Heading 1":"标题1","Heading 2":"标题2","Heading 3":"标题3","Heading 4":"标题4","Heading 5":"标题5","Heading 6":"标题6",Preformatted:"预格式化",Div:"Div区块",Pre:"预格式文本",Code:"代码",Paragraph:"段落",Blockquote:"引用",Inline:"文本",Blocks:"区块","Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.":"当前为纯文本粘贴模式，再次点击可以回到普通粘贴模式。","Font Family":"字体","Font Sizes":"字号",Class:"Class","Browse for an image":"浏览图像",OR:"或","Drop an image here":"拖放一张图像至此",Upload:"上传",Block:"块",Align:"对齐",Default:"默认",Circle:"空心圆",Disc:"实心圆",Square:"方块","Lower Alpha":"小写英文字母","Lower Greek":"小写希腊字母","Lower Roman":"小写罗马字母","Upper Alpha":"大写英文字母","Upper Roman":"大写罗马字母",Anchor:"锚点",Name:"名称",Id:"标识符","Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores.":"标识符应该以字母开头，后跟字母、数字、破折号、点、冒号或下划线。","You have unsaved changes are you sure you want to navigate away?":"你还有文档尚未保存，确定要离开？","Restore last draft":"恢复上次的草稿","Special character":"特殊符号","Source code":"源代码","Insert/Edit code sample":"插入/编辑代码示例",Language:"语言","Code sample":"代码示例",Color:"颜色",R:"R",G:"G",B:"B","Left to right":"从左到右","Right to left":"从右到左",Emoticons:"表情","Document properties":"文档属性",Title:"标题",Keywords:"关键词",Description:"描述",Robots:"机器人",Author:"作者",Encoding:"编码",Fullscreen:"全屏",Action:"操作",Shortcut:"快捷键",Help:"帮助",Address:"地址","Focus to menubar":"移动焦点到菜单栏","Focus to toolbar":"移动焦点到工具栏","Focus to element path":"移动焦点到元素路径","Focus to contextual toolbar":"移动焦点到上下文菜单","Insert link (if link plugin activated)":"插入链接 (如果链接插件已激活)","Save (if save plugin activated)":"保存(如果保存插件已激活)","Find (if searchreplace plugin activated)":"查找(如果查找替换插件已激活)","Plugins installed ({0}):":"已安装插件 ({0}):","Premium plugins:":"优秀插件：","Learn more...":"了解更多...","You are using {0}":"你正在使用 {0}",Plugins:"插件","Handy Shortcuts":"快捷键","Horizontal line":"水平分割线","Insert/edit image":"插入/编辑图片","Image description":"图片描述",Source:"地址",Dimensions:"大小","Constrain proportions":"保持纵横比",General:"普通",Advanced:"高级",Style:"样式","Vertical space":"垂直边距","Horizontal space":"水平边距",Border:"边框","Insert image":"插入图片",Image:"图片","Image list":"图片列表","Rotate counterclockwise":"逆时针旋转","Rotate clockwise":"顺时针旋转","Flip vertically":"垂直翻转","Flip horizontally":"水平翻转","Edit image":"编辑图片","Image options":"图片选项","Zoom in":"放大","Zoom out":"缩小",Crop:"裁剪",Resize:"调整大小",Orientation:"方向",Brightness:"亮度",Sharpen:"锐化",Contrast:"对比度","Color levels":"颜色层次",Gamma:"伽马值",Invert:"反转",Apply:"应用",Back:"后退","Insert date/time":"插入日期/时间","Date/time":"日期/时间","Insert link":"插入链接","Insert/edit link":"插入/编辑链接","Text to display":"显示文字",Url:"地址",Target:"打开方式",None:"无","New window":"在新窗口打开","Remove link":"删除链接",Anchors:"锚点",Link:"链接","Paste or type a link":"粘贴或输入链接","The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?":"你所填写的URL地址为邮件地址，需要加上mailto:前缀吗？","The URL you entered seems to be an external link. Do you want to add the required http:// prefix?":"你所填写的URL地址属于外部链接，需要加上http://:前缀吗？","Link list":"链接列表","Insert video":"插入视频","Insert/edit video":"插入/编辑视频","Insert/edit media":"插入/编辑媒体","Alternative source":"镜像",Poster:"封面","Paste your embed code below:":"将内嵌代码粘贴在下面:",Embed:"内嵌",Media:"媒体","Nonbreaking space":"不间断空格","Page break":"分页符","Paste as text":"粘贴为文本",Preview:"预览",Print:"打印",Save:"保存",Find:"查找","Replace with":"替换为",Replace:"替换","Replace all":"全部替换",Prev:"上一个",Next:"下一个","Find and replace":"查找和替换","Could not find the specified string.":"未找到搜索内容.","Match case":"区分大小写","Whole words":"全字匹配",Spellcheck:"拼写检查",Ignore:"忽略","Ignore all":"全部忽略",Finish:"完成","Add to Dictionary":"添加到字典","Insert table":"插入表格","Table properties":"表格属性","Delete table":"删除表格",Cell:"单元格",Row:"行",Column:"列","Cell properties":"单元格属性","Merge cells":"合并单元格","Split cell":"拆分单元格","Insert row before":"在上方插入","Insert row after":"在下方插入","Delete row":"删除行","Row properties":"行属性","Cut row":"剪切行","Copy row":"复制行","Paste row before":"粘贴到上方","Paste row after":"粘贴到下方","Insert column before":"在左侧插入","Insert column after":"在右侧插入","Delete column":"删除列",Cols:"列",Rows:"行",Width:"宽",Height:"高","Cell spacing":"单元格外间距","Cell padding":"单元格内边距",Caption:"标题",Left:"左对齐",Center:"居中",Right:"右对齐","Cell type":"单元格类型",Scope:"范围",Alignment:"对齐方式","H Align":"水平对齐","V Align":"垂直对齐",Top:"顶部对齐",Middle:"垂直居中",Bottom:"底部对齐","Header cell":"表头单元格","Row group":"行组","Column group":"列组","Row type":"行类型",Header:"表头",Body:"表体",Footer:"表尾","Border color":"边框颜色","Insert template":"插入模板",Templates:"模板",Template:"模板","Text color":"文字颜色","Background color":"背景色","Custom...":"自定义...","Custom color":"自定义颜色","No color":"无","Table of Contents":"内容列表","Show blocks":"显示区块边框","Show invisible characters":"显示不可见字符","Words: {0}":"字数：{0}","{0} words":"{0} 字",File:"文件",Edit:"编辑",Insert:"插入",View:"视图",Format:"格式",Table:"表格",Tools:"工具","Powered by {0}":"由{0}驱动","Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help":"在编辑区按ALT-F9打开菜单，按ALT-F10打开工具栏，按ALT-0查看帮助"})},"84ec":function(t,n,e){e("2401")},9434:function(t,n,e){e("e8b0")},"94ce":function(t,n){!function(t){"use strict";var n=function(t){var e=t,r=function(){return e};return{get:r,set:function(t){e=t},clone:function(){return n(r())}}},e=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},r=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))}},o=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=n.concat(e);return t.apply(null,o)}}var a,c=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}},s=function(t){return function(){throw new Error(t)}},l=function(t){return t()},f=o(!1),d=o(!0),m=f,g=d,p=function(){return h},h=function(){var t=function(t){return t.isNone()},n=function(t){return t()},e=function(t){return t},r={fold:function(t,n){return t()},is:m,isSome:m,isNone:g,getOr:e,getOrThunk:n,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:e,orThunk:n,map:p,ap:p,each:function(){},bind:p,flatten:p,exists:m,forall:g,filter:p,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(r),r}(),v=function(t){var n=function(){return t},e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:g,isNone:m,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return v(n(t))},ap:function(n){return n.fold(p,function(n){return v(n(t))})},each:function(n){n(t)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(t)?o:h},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(m,function(n){return e(t,n)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},b={some:v,none:p,from:function(t){return null==t?h:v(t)}},y=tinymce.util.Tools.resolve("tinymce.PluginManager"),w=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(n)===t}},x=w("string"),S=w("array"),C=w("boolean"),O=w("function"),k=w("number"),T=void 0===(a=Array.prototype.indexOf)?function(t,n){return P(t,n)}:function(t,n){return a.call(t,n)},E=function(t,n){return T(t,n)>-1},D=function(t,n){return F(t,n).isSome()},A=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o,t)}return r},R=function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e,t)},B=function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e],e,t)},N=function(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r,t)&&e.push(i)}return e},_=function(t,n,e){return B(t,function(t){e=n(e,t)}),e},I=function(t,n,e){return R(t,function(t){e=n(e,t)}),e},M=function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e,t))return b.some(o)}return b.none()},F=function(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e,t))return b.some(e);return b.none()},P=function(t,n){for(var e=0,r=t.length;e<r;++e)if(t[e]===n)return e;return-1},L=Array.prototype.push,H=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!Array.prototype.isPrototypeOf(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);L.apply(n,t[e])}return n},V=function(t,n){var e=A(t,n);return H(e)},z=function(t,n){for(var e=0,r=t.length;e<r;++e)if(!0!==n(t[e],e,t))return!1;return!0},j=Array.prototype.slice,U=function(t){var n=j.call(t,0);return n.reverse(),n},W=function(t){return 0===t.length?b.none():b.some(t[t.length-1])},G=(O(Array.from)&&Array.from,Object.keys),q=Object.hasOwnProperty,$=function(t,n){for(var e=G(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i,t)}},X=function(t,n){return Y(t,function(t,e,r){return{k:e,v:n(t,e,r)}})},Y=function(t,n){var e={};return $(t,function(r,o){var i=n(r,o,t);e[i.k]=i.v}),e},K=function(t,n){return J(t,n)?b.from(t[n]):b.none()},J=function(t,n){return q.call(t,n)},Z=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return R(t,function(t,e){r[t]=o(n[e])}),r}},Q=function(t){return t.slice(0).sort()},tt=function(t,n){throw new Error("All required keys ("+Q(t).join(", ")+") were not specified. Specified keys were: "+Q(n).join(", ")+".")},nt=function(t){throw new Error("Unsupported keys for object: "+Q(t).join(", "))},et=function(t,n){if(!S(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");R(n,function(n){if(!x(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")})},rt=function(t){var n=Q(t);M(n,function(t,e){return e<n.length-1&&t===n[e+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+n.join(", ")+"].")})},ot=function(t,n){var e=t.concat(n);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return et("required",t),et("optional",n),rt(e),function(r){var i=G(r);z(t,function(t){return E(i,t)})||tt(t,i);var u=N(i,function(t){return!E(e,t)});u.length>0&&nt(u);var a={};return R(t,function(t){a[t]=o(r[t])}),R(n,function(t){a[t]=o(Object.prototype.hasOwnProperty.call(r,t)?b.some(r[t]):b.none())}),a}},it=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),ut=t.Node.DOCUMENT_NODE,at=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),ct=t.Node.TEXT_NODE,st=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,function(t){return t.dom().nodeName.toLowerCase()}),lt=function(t){return t.dom().nodeType},ft=function(t){return function(n){return lt(n)===t}},dt=function(t){return lt(t)===it||"#comment"===st(t)},mt=ft(at),gt=ft(ct),pt=ft(ut),ht=function(n,e,r){if(!(x(r)||C(r)||k(r)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")},vt=function(t,n,e){ht(t.dom(),n,e)},bt=function(t,n){var e=t.dom();$(n,function(t,n){ht(e,n,t)})},yt=function(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e},wt=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},xt=function(t,n){t.dom().removeAttribute(n)},St=function(t){return I(t.dom().attributes,function(t,n){return t[n.name]=n.value,t},{})},Ct=function(t,n,e){return""===n||!(t.length<n.length)&&t.substr(e,e+n.length)===n},Ot=function(t,n){return-1!==t.indexOf(n)},kt=function(t,n){return Ct(t,n,0)},Tt=function(t){return void 0!==t.style},Et=function(t){var n,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,n=t.apply(null,r)),n}},Dt=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},At={fromHtml:function(n,e){var r=(e||t.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Dt(r.childNodes[0])},fromTag:function(n,e){var r=(e||t.document).createElement(n);return Dt(r)},fromText:function(n,e){var r=(e||t.document).createTextNode(n);return Dt(r)},fromDom:Dt,fromPoint:function(t,n,e){var r=t.dom();return b.from(r.elementFromPoint(n,e)).map(Dt)}},Rt=function(t){var n=gt(t)?t.dom().parentNode:t.dom();return null!=n&&n.ownerDocument.body.contains(n)},Bt=Et(function(){return Nt(At.fromDom(t.document))}),Nt=function(t){var n=t.dom().body;if(null==n)throw new Error("Body is not available yet");return At.fromDom(n)},_t=function(n,e,r){if(!x(r))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);Tt(n)&&n.style.setProperty(e,r)},It=function(t,n){Tt(t)&&t.style.removeProperty(n)},Mt=function(t,n,e){var r=t.dom();_t(r,n,e)},Ft=function(t,n){var e=t.dom();$(n,function(t,n){_t(e,n,t)})},Pt=function(n,e){var r=n.dom(),o=t.window.getComputedStyle(r).getPropertyValue(e),i=""!==o||Rt(n)?o:Lt(r,e);return null===i?void 0:i},Lt=function(t,n){return Tt(t)?t.style.getPropertyValue(n):""},Ht=function(t,n){var e=t.dom(),r=Lt(e,n);return b.from(r).filter(function(t){return t.length>0})},Vt=function(t,n){var e=t.dom();It(e,n),wt(t,"style")&&""===yt(t,"style").replace(/^\s+|\s+$/g,"")&&xt(t,"style")},zt=function(t,n){var e=t.dom(),r=n.dom();Tt(e)&&Tt(r)&&(r.style.cssText=e.style.cssText)},jt=void 0!==t.window?t.window:Function("return this;")(),Ut=function(t,n){return function(t,n){for(var e=null!=n?n:jt,r=0;r<t.length&&null!=e;++r)e=e[t[r]];return e}(t.split("."),n)},Wt=function(t,n){var e=function(t,n){return Ut(t,n)}(t,n);if(null==e)throw t+" not available on this browser";return e},Gt=function(){return Wt("Node")},qt=function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)},$t=function(t,n){return qt(t,n,Gt().DOCUMENT_POSITION_CONTAINED_BY)},Xt=function(){return Yt(0,0)},Yt=function(t,n){return{major:t,minor:n}},Kt={nu:Yt,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?Xt():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}}(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return Yt(r(1),r(2))}(t,e)},unknown:Xt},Jt=function(t,n){return function(){return n===t}},Zt=function(t){var n=t.current;return{current:n,version:t.version,isEdge:Jt("Edge",n),isChrome:Jt("Chrome",n),isIE:Jt("IE",n),isOpera:Jt("Opera",n),isFirefox:Jt("Firefox",n),isSafari:Jt("Safari",n)}},Qt={unknown:function(){return Zt({current:void 0,version:Kt.unknown()})},nu:Zt,edge:o("Edge"),chrome:o("Chrome"),ie:o("IE"),opera:o("Opera"),firefox:o("Firefox"),safari:o("Safari")},tn=function(t,n){return function(){return n===t}},nn=function(t){var n=t.current;return{current:n,version:t.version,isWindows:tn("Windows",n),isiOS:tn("iOS",n),isAndroid:tn("Android",n),isOSX:tn("OSX",n),isLinux:tn("Linux",n),isSolaris:tn("Solaris",n),isFreeBSD:tn("FreeBSD",n)}},en={unknown:function(){return nn({current:void 0,version:Kt.unknown()})},nu:nn,windows:o("Windows"),ios:o("iOS"),android:o("Android"),linux:o("Linux"),osx:o("OSX"),solaris:o("Solaris"),freebsd:o("FreeBSD")},rn=function(t,n){var e=String(n).toLowerCase();return M(t,function(t){return t.search(e)})},on=function(t,n){return rn(t,n).map(function(t){var e=Kt.detect(t.versionRegexes,n);return{current:t.name,version:e}})},un=function(t,n){return rn(t,n).map(function(t){var e=Kt.detect(t.versionRegexes,n);return{current:t.name,version:e}})},an=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,cn=function(t){return function(n){return Ot(n,t)}},sn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Ot(t,"edge/")&&Ot(t,"chrome")&&Ot(t,"safari")&&Ot(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,an],search:function(t){return Ot(t,"chrome")&&!Ot(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Ot(t,"msie")||Ot(t,"trident")}},{name:"Opera",versionRegexes:[an,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:cn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:cn("firefox")},{name:"Safari",versionRegexes:[an,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Ot(t,"safari")||Ot(t,"mobile/"))&&Ot(t,"applewebkit")}}],ln=[{name:"Windows",search:cn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Ot(t,"iphone")||Ot(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:cn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:cn("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:cn("linux"),versionRegexes:[]},{name:"Solaris",search:cn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:cn("freebsd"),versionRegexes:[]}],fn={browsers:o(sn),oses:o(ln)},dn=function(t){var n=fn.browsers(),e=fn.oses(),r=on(n,t).fold(Qt.unknown,Qt.nu),i=un(e,t).fold(en.unknown,en.nu),u=function(t,n,e){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,c=r||u||a&&!0===/mobile/i.test(e),s=t.isiOS()||t.isAndroid(),l=s&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e);return{isiPad:o(r),isiPhone:o(i),isTablet:o(c),isPhone:o(l),isTouch:o(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:o(f)}}(i,r,t);return{browser:r,os:i,deviceType:u}},mn={detect:Et(function(){var n=t.navigator.userAgent;return dn(n)})},gn=at,pn=ut,hn=function(t,n){var e=t.dom();if(e.nodeType!==gn)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},vn=function(t){return t.nodeType!==gn&&t.nodeType!==pn||0===t.childElementCount},bn=function(n,e){var r=void 0===e?t.document:e.dom();return vn(r)?b.none():b.from(r.querySelector(n)).map(At.fromDom)},yn=function(t,n){return t.dom()===n.dom()},wn=mn.detect().browser.isIE()?function(t,n){return $t(t.dom(),n.dom())}:function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},xn=hn,Sn=function(t){return At.fromDom(t.dom().ownerDocument)},Cn=function(t){var n=t.dom();return b.from(n.parentNode).map(At.fromDom)},On=function(t,n){for(var e=O(n)?n:o(!1),r=t.dom(),i=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,a=At.fromDom(u);if(i.push(a),!0===e(a))break;r=u}return i},kn=function(t){var n=t.dom();return b.from(n.previousSibling).map(At.fromDom)},Tn=function(t){var n=t.dom();return b.from(n.nextSibling).map(At.fromDom)},En=function(t){var n=t.dom();return A(n.childNodes,At.fromDom)},Dn=function(t,n){var e=t.dom().childNodes;return b.from(e[n]).map(At.fromDom)},An=(Z("element","offset"),function(t,n){Cn(t).each(function(e){e.dom().insertBefore(n.dom(),t.dom())})}),Rn=function(t,n){Tn(t).fold(function(){Cn(t).each(function(t){Nn(t,n)})},function(t){An(t,n)})},Bn=function(t,n){(function(t){return Dn(t,0)})(t).fold(function(){Nn(t,n)},function(e){t.dom().insertBefore(n.dom(),e.dom())})},Nn=function(t,n){t.dom().appendChild(n.dom())},_n=function(t,n){An(t,n),Nn(n,t)},In=function(t,n){R(n,function(e,r){var o=0===r?t:n[r-1];Rn(o,e)})},Mn=function(t,n){R(n,function(n){Nn(t,n)})},Fn=function(t){t.dom().textContent="",R(En(t),function(t){Pn(t)})},Pn=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},Ln=function(t){var n,e=En(t);e.length>0&&(n=t,R(e,function(t){An(n,t)})),Pn(t)},Hn=Z("width","height"),Vn=Z("rows","columns"),zn=Z("row","column"),jn=Z("x","y"),Un=Z("element","rowspan","colspan"),Wn=Z("element","rowspan","colspan","isNew"),Gn={dimensions:Hn,grid:Vn,address:zn,coords:jn,extended:Z("element","rowspan","colspan","row","column"),detail:Un,detailnew:Wn,rowdata:Z("element","cells","section"),elementnew:Z("element","isNew"),rowdatanew:Z("element","cells","section","isNew"),rowcells:Z("cells","section"),rowdetails:Z("details","section"),bounds:Z("startRow","startCol","finishRow","finishCol")},qn=function(t,n){var e=[];return R(En(t),function(t){n(t)&&(e=e.concat([t])),e=e.concat(qn(t,n))}),e},$n=function(t,n,e){return function(t,n,e){return N(On(t,e),n)}(t,function(t){return hn(t,n)},e)},Xn=function(t,n){return function(t,n){return N(En(t),n)}(t,function(t){return hn(t,n)})},Yn=function(n,e){return function(n,e){var r=void 0===e?t.document:e.dom();return vn(r)?[]:A(r.querySelectorAll(n),At.fromDom)}(e,n)};function Kn(t,n,e,r,o){return t(e,r)?b.some(e):O(o)&&o(e)?b.none():n(e,r,o)}var Jn=function(t,n,e){for(var r=t.dom(),i=O(e)?e:o(!1);r.parentNode;){r=r.parentNode;var u=At.fromDom(r);if(n(u))return b.some(u);if(i(u))break}return b.none()},Zn=function(t,n){return M(t.dom().childNodes,r(n,At.fromDom)).map(At.fromDom)},Qn=function(t,n,e){return Jn(t,function(t){return hn(t,n)},e)},te=function(t,n){return Zn(t,function(t){return hn(t,n)})},ne=function(t,n){return bn(n,t)},ee=function(t,n,e){return Kn(hn,Qn,t,n,e)},re=function(t,n,e){return V(En(t),function(t){return hn(t,n)?e(t)?[t]:[]:re(t,n,e)})},oe={firstLayer:function(t,n){return re(t,n,o(!0))},filterFirstLayer:re},ie=function(t,n,e){var r=void 0!==e?e:o(!1);return r(n)?b.none():E(t,st(n))?b.some(n):Qn(n,t.join(","),function(t){return hn(t,"table")||r(t)})},ue=function(t,n){return Cn(n).map(function(n){return Xn(n,t)})},ae=u(ue,"th,td"),ce=u(ue,"tr"),se=function(t,n){return parseInt(yt(t,n),10)},le={cell:function(t,n){return ie(["td","th"],t,n)},firstCell:function(t){return ne(t,"th,td")},cells:function(t){return oe.firstLayer(t,"th,td")},neighbourCells:ae,table:function(t,n){return ee(t,"table",n)},row:function(t,n){return ie(["tr"],t,n)},rows:function(t){return oe.firstLayer(t,"tr")},notCell:function(t,n){return ie(["caption","tr","tbody","tfoot","thead"],t,n)},neighbourRows:ce,attr:se,grid:function(t,n,e){var r=se(t,n),o=se(t,e);return Gn.grid(r,o)}},fe=function(t){var n=le.rows(t);return A(n,function(t){var n=t,e=Cn(n).map(function(t){var n=st(t);return"tfoot"===n||"thead"===n||"tbody"===n?n:"tbody"}).getOr("tbody"),r=A(le.cells(t),function(t){var n=wt(t,"rowspan")?parseInt(yt(t,"rowspan"),10):1,e=wt(t,"colspan")?parseInt(yt(t,"colspan"),10):1;return Gn.detail(t,n,e)});return Gn.rowdata(n,r,e)})},de=function(t,n){return A(t,function(t){var e=A(le.cells(t),function(t){var n=wt(t,"rowspan")?parseInt(yt(t,"rowspan"),10):1,e=wt(t,"colspan")?parseInt(yt(t,"colspan"),10):1;return Gn.detail(t,n,e)});return Gn.rowdata(t,e,n.section())})},me=function(t,n){return t+","+n},ge=function(t,n){var e=V(t.all(),function(t){return t.cells()});return N(e,n)},pe={generate:function(t){var n={},e=[],r=t.length,i=0;R(t,function(t,r){var o=[];R(t.cells(),function(t,e){for(var u=0;void 0!==n[me(r,u)];)u++;for(var a=Gn.extended(t.element(),t.rowspan(),t.colspan(),r,u),c=0;c<t.colspan();c++)for(var s=0;s<t.rowspan();s++){var l=u+c,f=me(r+s,l);n[f]=a,i=Math.max(i,l+1)}o.push(a)}),e.push(Gn.rowdata(t.element(),o,t.section()))});var u=Gn.grid(r,i);return{grid:o(u),access:o(n),all:o(e)}},getAt:function(t,n,e){var r=t.access()[me(n,e)];return void 0!==r?b.some(r):b.none()},findItem:function(t,n,e){var r=ge(t,function(t){return e(n,t.element())});return r.length>0?b.some(r[0]):b.none()},filterItems:ge,justCells:function(t){var n=A(t.all(),function(t){return t.cells()});return H(n)}},he=Z("minRow","minCol","maxRow","maxCol"),ve=function(t,n,e){var r=t[e].element(),o=At.fromTag("td");Nn(o,At.fromTag("br")),(n?Nn:Bn)(r,o)},be=function(t,n){var e=function(t){return hn(t.element(),n)},r=fe(t),o=pe.generate(r),i=function(t,n){var e=t.grid().columns(),r=t.grid().rows(),o=e,i=0,u=0;return $(t.access(),function(t){if(n(t)){var e=t.row(),a=e+t.rowspan()-1,c=t.column(),s=c+t.colspan()-1;e<r?r=e:a>i&&(i=a),c<o?o=c:s>u&&(u=s)}}),he(r,o,i,u)}(o,e),u="th:not("+n+"),td:not("+n+")",a=oe.filterFirstLayer(t,"th,td",function(t){return hn(t,u)});return R(a,Pn),function(t,n,e,r){for(var o=n.grid().columns(),i=n.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)u<e.minRow()||u>e.maxRow()||c<e.minCol()||c>e.maxCol()||(pe.getAt(n,u,c).filter(r).isNone()?ve(t,a,u):a=!0)}(r,o,i,e),function(t,n){var e=N(oe.firstLayer(t,"tr"),function(t){return 0===t.dom().childElementCount});R(e,Pn),n.minCol()!==n.maxCol()&&n.minRow()!==n.maxRow()||R(oe.firstLayer(t,"th,td"),function(t){xt(t,"rowspan"),xt(t,"colspan")}),xt(t,"width"),xt(t,"height"),Vt(t,"width"),Vt(t,"height")}(t,i),t},ye=function(t,n){var e=function(n){return t(n)?b.from(n.dom().nodeValue):b.none()},r=mn.detect().browser,o=r.isIE()&&10===r.version.major?function(t){try{return e(t)}catch(t){return b.none()}}:e;return{get:function(e){if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return o(e).getOr("")},getOption:o,set:function(e,r){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom().nodeValue=r}}}(gt,"text"),we=function(t){return ye.get(t)},xe=function(t){return ye.getOption(t)},Se=function(t,n){ye.set(t,n)},Ce=function(t){return"img"===st(t)?1:xe(t).fold(function(){return En(t).length},function(t){return t.length})},Oe=["img","br"],ke=function(t){return xe(t).filter(function(t){return 0!==t.trim().length||t.indexOf(" ")>-1}).isSome()||E(Oe,st(t))},Te=function(t){return n=ke,(e=function(t){for(var r=0;r<t.childNodes.length;r++){if(n(At.fromDom(t.childNodes[r])))return b.some(At.fromDom(t.childNodes[r]));var o=e(t.childNodes[r]);if(o.isSome())return o}return b.none()})(t.dom());var n,e},Ee=function(t){return De(t,ke)},De=function(t,n){var e=function(t){for(var r=En(t),o=r.length-1;o>=0;o--){var i=r[o];if(n(i))return b.some(i);var u=e(i);if(u.isSome())return u}return b.none()};return e(t)},Ae=function(t,n){return At.fromDom(t.dom().cloneNode(n))},Re=function(t){return Ae(t,!1)},Be=function(t){return Ae(t,!0)},Ne=function(t,n){var e=function(t,n){var e=At.fromTag(n),r=St(t);return bt(e,r),e}(t,n),r=En(Be(t));return Mn(e,r),e},_e=function(){var t=At.fromTag("td");return Nn(t,At.fromTag("br")),t},Ie=function(t,n,e){var r=Ne(t,n);return $(e,function(t,n){null===t?xt(r,n):vt(r,n,t)}),r},Me=function(t){return t},Fe=function(t){return function(){return At.fromTag("tr",t.dom())}},Pe=function(t,n,e){return{row:Fe(n),cell:function(n){var r=Sn(n.element()),o=At.fromTag(st(n.element()),r.dom()),i=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?function(t,n,e){return Te(t).map(function(r){var o=e.join(","),i=$n(r,o,function(n){return yn(n,t)});return _(i,function(t,n){var e=Re(n);return xt(e,"contenteditable"),Nn(t,e),e},n)}).getOr(n)}(n.element(),o,i):o;return Nn(u,At.fromTag("br")),zt(n.element(),o),Vt(o,"height"),1!==n.colspan()&&Vt(n.element(),"width"),t(n.element(),o),o},replace:Ie,gap:_e}},Le=function(t){return{row:Fe(t),cell:_e,replace:Me,gap:_e}},He=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Ve(){return{up:o({selector:Qn,closest:ee,predicate:Jn,all:On}),down:o({selector:Yn,predicate:qn}),styles:o({get:Pt,getRaw:Ht,set:Mt,remove:Vt}),attrs:o({get:yt,set:vt,remove:xt,copyTo:function(t,n){var e=St(t);bt(n,e)}}),insert:o({before:An,after:Rn,afterAll:In,append:Nn,appendAll:Mn,prepend:Bn,wrap:_n}),remove:o({unwrap:Ln,remove:Pn}),create:o({nu:At.fromTag,clone:function(t){return At.fromDom(t.dom().cloneNode(!1))},text:At.fromText}),query:o({comparePosition:function(t,n){return t.dom().compareDocumentPosition(n.dom())},prevSibling:kn,nextSibling:Tn}),property:o({children:En,name:st,parent:Cn,document:function(t){return t.dom().ownerDocument},isText:gt,isComment:dt,isElement:mt,getText:we,setText:Se,isBoundary:function(t){return!!mt(t)&&("body"===st(t)||E(He,st(t)))},isEmptyTag:function(t){return!!mt(t)&&E(["br","img","hr","input"],st(t))}}),eq:yn,is:xn}}var ze=Z("left","right"),je=function(t,n,e){var r=t.property().children(n);return F(r,u(t.eq,e)).map(function(t){return{before:o(r.slice(0,t)),after:o(r.slice(t+1))}})},Ue=function(t,n,e){return je(t,n,e).map(function(r){var o=t.create().clone(n);return t.insert().appendAll(o,r.before().concat([e])),t.insert().appendAll(n,r.after()),t.insert().before(n,o),ze(o,n)})},We=function(t,n,e){return je(t,n,e).map(function(e){var r=t.create().clone(n);return t.insert().appendAll(r,e.after()),t.insert().after(n,r),ze(n,r)})},Ge=function(t,n,e,r){var o=Z("first","second","splits"),i=function(n,u,a){var c=o(n,b.none(),a);return e(n)?o(n,u,a):t.property().parent(n).bind(function(o){return r(t,o,n).map(function(t){var n=[{first:t.left,second:t.right}],r=e(o)?o:t.left();return i(r,b.some(t.right()),a.concat(n))}).getOr(c)})};return i(n,b.none(),[])},qe=function(t,n,e,r){var o=n(t,e);return _(r,function(e,r){var o=n(t,r);return $e(t,e,o)},o)},$e=function(t,n,e){return n.bind(function(n){return e.filter(u(t.eq,n))})},Xe=function(t,n,e){return e.length>0?function(t,n,e,r){return r(t,n,e[0],e.slice(1))}(t,n,e,qe):b.none()},Ye=function(t,n){return u(t.eq,n)},Ke=function(t,n,e,r){var i=void 0!==r?r:o(!1),u=[n].concat(t.up().all(n)),a=[e].concat(t.up().all(e)),c=function(t){return F(t,i).fold(function(){return t},function(n){return t.slice(0,n+1)})},s=c(u),l=c(a),f=M(s,function(n){return D(l,Ye(t,n))});return{firstpath:o(s),secondpath:o(l),shared:o(f)}},Je=function(t,n,e){var r=Ke(t,n,e);return r.shared().bind(function(n){return function(t,n,e,r){var o=t.property().children(n);if(t.eq(n,e[0]))return b.some([e[0]]);if(t.eq(n,r[0]))return b.some([r[0]]);var i=function(e){var r=U(e),i=F(r,Ye(t,n)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return F(o,Ye(t,u))},u=i(e),a=i(r);return u.bind(function(t){return a.map(function(n){var e=Math.min(t,n),r=Math.max(t,n);return o.slice(e,r+1)})})}(t,n,r.firstpath(),r.secondpath())})},Ze=Ke,Qe=function(t,n,e){return Xe(t,n,e)},tr=function(t,n,e){return Je(t,n,e)},nr=function(t,n,e,r){return Ze(t,n,e,r)},er=function(t,n,e){return Ue(t,n,e)},rr=function(t,n,e){return We(t,n,e)},or=function(t,n,e,r){return Ge(t,n,e,r)},ir=Ve(),ur={sharedOne:function(t,n){return Qe(ir,function(n,e){return t(e)},n)},subset:function(t,n){return tr(ir,t,n)},ancestors:function(t,n,e){return nr(ir,t,n,e)},breakToLeft:function(t,n){return er(ir,t,n)},breakToRight:function(t,n){return rr(ir,t,n)},breakPath:function(t,n,e){return or(ir,t,n,function(t,n,r){return e(n,r)})}},ar=function(t,n){return n.column()>=t.startCol()&&n.column()+n.colspan()-1<=t.finishCol()&&n.row()>=t.startRow()&&n.row()+n.rowspan()-1<=t.finishRow()},cr=function(t,n){var e=n.column(),r=n.column()+n.colspan()-1,o=n.row(),i=n.row()+n.rowspan()-1;return e<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},sr=function(t,n){for(var e=!0,r=u(ar,n),o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)e=e&&pe.getAt(t,o,i).exists(r);return e?b.some(n):b.none()},lr=function(t,n,e){var r=pe.findItem(t,n,yn),o=pe.findItem(t,e,yn);return r.bind(function(t){return o.map(function(n){return e=t,r=n,Gn.bounds(Math.min(e.row(),r.row()),Math.min(e.column(),r.column()),Math.max(e.row()+e.rowspan()-1,r.row()+r.rowspan()-1),Math.max(e.column()+e.colspan()-1,r.column()+r.colspan()-1));var e,r})})},fr=lr,dr=function(t,n,e){return lr(t,n,e).bind(function(n){return sr(t,n)})},mr=function(t,n,e,r){return pe.findItem(t,n,yn).bind(function(n){var o=e>0?n.row()+n.rowspan()-1:n.row(),i=r>0?n.column()+n.colspan()-1:n.column();return pe.getAt(t,o+e,i+r).map(function(t){return t.element()})})},gr=function(t,n,e){return fr(t,n,e).map(function(n){var e=pe.filterItems(t,u(cr,n));return A(e,function(t){return t.element()})})},pr=function(t,n){return pe.findItem(t,n,function(t,n){return wn(n,t)}).bind(function(t){return t.element()})},hr=function(t){var n=fe(t);return pe.generate(n)},vr=function(t,n,e){return le.table(t).bind(function(r){var o=hr(r);return mr(o,t,n,e)})},br=function(t,n,e){var r=hr(t);return gr(r,n,e)},yr=function(t,n,e,r,o){var i=hr(t),u=yn(t,e)?n:pr(i,n),a=yn(t,o)?r:pr(i,r);return gr(i,u,a)},wr=function(t,n,e){var r=hr(t);return dr(r,n,e)},xr=function(t,n){return Qn(t,"table")},Sr=ot(["boxes","start","finish"],[]),Cr=function(t,n,e){var r=function(t){return function(n){return e(n)||yn(n,t)}};return yn(t,n)?b.some(Sr({boxes:b.some([t]),start:t,finish:n})):xr(t).bind(function(o){return xr(n).bind(function(i){if(yn(o,i))return b.some(Sr({boxes:br(o,t,n),start:t,finish:n}));if(wn(o,i)){var u=(a=$n(n,"td,th",r(o))).length>0?a[a.length-1]:n;return b.some(Sr({boxes:yr(o,t,o,n,i),start:t,finish:u}))}if(wn(i,o)){var a,c=(a=$n(t,"td,th",r(i))).length>0?a[a.length-1]:t;return b.some(Sr({boxes:yr(i,t,o,n,i),start:t,finish:c}))}return ur.ancestors(t,n).shared().bind(function(u){return ee(u,"table",e).bind(function(e){var u=$n(n,"td,th",r(e)),a=u.length>0?u[u.length-1]:n,c=$n(t,"td,th",r(e)),s=c.length>0?c[c.length-1]:t;return b.some(Sr({boxes:yr(e,t,o,n,i),start:s,finish:a}))})})})})},Or={identify:Cr,retrieve:function(t,n){var e=Yn(t,n);return e.length>0?b.some(e):b.none()},shiftSelection:function(t,n,e,r,i){return function(t,n){return M(t,function(t){return hn(t,n)})}(t,i).bind(function(t){return vr(t,n,e).bind(function(t){return function(t,n){return Qn(t,"table").bind(function(e){return ne(e,n).bind(function(n){return Cr(n,t).bind(function(t){return t.boxes().map(function(n){return{boxes:o(n),start:o(t.start()),finish:o(t.finish())}})})})})}(t,r)})})},getEdges:function(t,n,e){return ne(t,n).bind(function(n){return ne(t,e).bind(function(t){return ur.sharedOne(xr,[n,t]).map(function(e){return{first:o(n),last:o(t),table:o(e)}})})})}},kr=function(t,n){return Or.retrieve(t,n)},Tr=function(t,n,e){return Or.getEdges(t,n,e).bind(function(n){var e=function(n){return yn(t,n)},r=Qn(n.first(),"thead,tfoot,tbody,table",e),o=Qn(n.last(),"thead,tfoot,tbody,table",e);return r.bind(function(t){return o.bind(function(e){return yn(t,e)?wr(n.table(),n.first(),n.last()):b.none()})})})},Er="data-mce-selected",Dr={selected:o(Er),selectedSelector:o("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:o("[data-mce-selected]"),firstSelected:o("data-mce-first-selected"),firstSelectedSelector:o("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:o("data-mce-last-selected"),lastSelectedSelector:o("td[data-mce-last-selected],th[data-mce-last-selected]")},Ar=function(n){if(!S(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],r={};return R(n,function(o,i){var u=G(o);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=o[a];if(void 0!==r[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!S(c))throw new Error("case arguments must be an array");e.push(a),r[a]=function(){var r=arguments.length;if(r!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var n=G(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!z(e,function(t){return E(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[a].apply(null,o)},log:function(n){t.console.log(n,{constructors:e,constructor:a,params:o})}}}}),r},Rr=Ar([{none:[]},{multiple:["elements"]},{single:["selection"]}]),Br={cata:function(t,n,e,r){return t.fold(n,e,r)},none:Rr.none,multiple:Rr.multiple,single:Rr.single},Nr=function(t,n){return Br.cata(n.get(),o([]),i,o([t]))},_r=function(t,n){return Br.cata(n.get(),b.none,function(n,e){return 0===n.length?b.none():Tr(t,Dr.firstSelectedSelector(),Dr.lastSelectedSelector()).bind(function(t){return n.length>1?b.some({bounds:o(t),cells:o(n)}):b.none()})},b.none)},Ir=function(t,n){var e=Nr(t,n);return e.length>0&&z(e,function(t){return wt(t,"rowspan")&&parseInt(yt(t,"rowspan"),10)>1||wt(t,"colspan")&&parseInt(yt(t,"colspan"),10)>1})?b.some(e):b.none()},Mr=Nr,Fr=function(t){return{element:o(t),mergable:b.none,unmergable:b.none,selection:o([t])}},Pr=Z("element","clipboard","generators"),Lr={noMenu:Fr,forMenu:function(t,n,e){return{element:o(e),mergable:o(_r(n,t)),unmergable:o(Ir(e,t)),selection:o(Mr(e,t))}},notCell:function(t){return Fr(t)},paste:Pr,pasteRows:function(t,n,e,r,i){return{element:o(e),mergable:b.none,unmergable:b.none,selection:o(Mr(e,t)),clipboard:o(r),generators:o(i)}}},Hr={registerEvents:function(n,r,o,i){n.on("BeforeGetContent",function(t){!0===t.selection&&Br.cata(r.get(),e,function(e){t.preventDefault(),function(t){return le.table(t[0]).map(Be).map(function(t){return[be(t,Dr.attributeSelector())]})}(e).each(function(e){t.content="text"===t.format?function(t){return A(t,function(t){return t.dom().innerText}).join("")}(e):function(t,n){return A(n,function(n){return t.selection.serializer.serialize(n.dom(),{})}).join("")}(n,e)})},e)}),n.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&b.from(n.dom.getParent(n.selection.getStart(),"th,td")).each(function(r){var u=At.fromDom(r);le.table(u).each(function(r){var a,c,s,l=N((a=e.content,(s=(c||t.document).createElement("div")).innerHTML=a,En(At.fromDom(s))),function(t){return"meta"!==st(t)});if(1===l.length&&"table"===st(l[0])){e.preventDefault();var f=At.fromDom(n.getDoc()),d=Le(f),m=Lr.paste(u,l[0],d);o.pasteCells(r,m).each(function(t){n.selection.setRng(t),n.focus(),i.clear(r)})}})})})}};function Vr(t,n){var e=function(e){var r=n(e);if(r<=0||null===r){var o=Pt(e,t);return parseFloat(o)||0}return r},r=function(t,n){return I(n,function(n,e){var r=Pt(t,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o},0)};return{set:function(n,e){if(!k(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var r=n.dom();Tt(r)&&(r.style[t]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(t,n,e){var o=r(t,e);return n>o?n-o:0}}}var zr=Vr("height",function(t){var n=t.dom();return Rt(t)?n.getBoundingClientRect().height:n.offsetHeight}),jr=function(t){return zr.get(t)},Ur=function(t){return zr.getOuter(t)},Wr=Vr("width",function(t){return t.dom().offsetWidth}),Gr=function(t){return Wr.get(t)},qr=function(t){return Wr.getOuter(t)},$r=mn.detect(),Xr=function(t,n,e){return function(t,n){var e=parseFloat(t);return isNaN(e)?n:e}(Pt(t,n),e)},Yr=function(t){return $r.browser.isIE()||$r.browser.isEdge()?function(t){var n=Xr(t,"padding-top",0),e=Xr(t,"padding-bottom",0),r=Xr(t,"border-top-width",0),o=Xr(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===Pt(t,"box-sizing")?i:i-n-e-(r+o)}(t):Xr(t,"height",jr(t))},Kr=/(\d+(\.\d+)?)(\w|%)*/,Jr=/(\d+(\.\d+)?)%/,Zr=/(\d+(\.\d+)?)px|em/,Qr=function(t,n){Mt(t,"height",n+"px")},to=function(t,n,e,r){var o,i,u=parseInt(t,10);return Ct(o=t,i="%",o.length-i.length)&&"table"!==st(n)?function(t,n,e,r){var o=le.table(t).map(function(t){var r=e(t);return Math.floor(n/100*r)}).getOr(n);return r(t,o),o}(n,u,e,r):u},no=function(t){var n=function(t){return Ht(t,"height").getOrThunk(function(){return Yr(t)+"px"})}(t);return n?to(n,t,jr,Qr):jr(t)},eo=function(t,n){return wt(t,n)?parseInt(yt(t,n),10):1},ro=function(t){return Ht(t,"width").fold(function(){return b.from(yt(t,"width"))},function(t){return b.some(t)})},oo=function(t,n){return t/n.pixelWidth()*100},io={percentageBasedSizeRegex:o(Jr),pixelBasedSizeRegex:o(Zr),setPixelWidth:function(t,n){Mt(t,"width",n+"px")},setPercentageWidth:function(t,n){Mt(t,"width",n+"%")},setHeight:Qr,getPixelWidth:function(t,n){return ro(t).fold(function(){return Gr(t)},function(e){return function(t,n,e){if(Zr.test(n)){var r=Zr.exec(n);return parseInt(r[1],10)}if(Jr.test(n)){var o=Jr.exec(n);return function(t,n){return t/100*n.pixelWidth()}(parseFloat(o[1]),e)}return Gr(t)}(t,e,n)})},getPercentageWidth:function(t,n){return ro(t).fold(function(){var e=Gr(t);return oo(e,n)},function(e){return function(t,n,e){if(Jr.test(n)){var r=Jr.exec(n);return parseFloat(r[1])}var o=Gr(t);return oo(o,e)}(t,e,n)})},getGenericWidth:function(t){return ro(t).bind(function(t){if(Kr.test(t)){var n=Kr.exec(t);return b.some({width:o(n[1]),unit:o(n[3])})}return b.none()})},setGenericWidth:function(t,n,e){Mt(t,"width",n+e)},getHeight:function(t){return function(t,n,e){return e(t)/eo(t,n)}(t,"rowspan",no)},getRawWidth:ro},uo=function(t,n){io.getGenericWidth(t).each(function(e){var r=e.width()/2;io.setGenericWidth(t,r,e.unit()),io.setGenericWidth(n,r,e.unit())})},ao=function(t,n){return{left:o(t),top:o(n),translate:function(e,r){return ao(t+e,n+r)}}},co=ao,so=function(t,n){return void 0!==t?t:void 0!==n?n:0},lo=function(n){var e=n.dom().ownerDocument,r=e.body,o=function(n){var e=n.dom();return e===e.window&&n instanceof t.Window?n:pt(n)?e.defaultView||e.parentWindow:null}(At.fromDom(e)),i=e.documentElement,u=so(o.pageYOffset,i.scrollTop),a=so(o.pageXOffset,i.scrollLeft),c=so(i.clientTop,r.clientTop),s=so(i.clientLeft,r.clientLeft);return fo(n).translate(a-s,u-c)},fo=function(n){var e=n.dom(),r=e.ownerDocument,o=r.body,i=At.fromDom(r.documentElement);return o===e?co(o.offsetLeft,o.offsetTop):function(n,e){var r=e||At.fromDom(t.document.documentElement);return Jn(n,u(yn,r)).isSome()}(n,i)?function(t){var n=t.getBoundingClientRect();return co(n.left,n.top)}(e):co(0,0)},mo=Z("row","y"),go=Z("col","x"),po=function(t){return lo(t).left()+qr(t)},ho=function(t){return lo(t).left()},vo=function(t,n){return go(t,ho(n))},bo=function(t,n){return go(t,po(n))},yo=function(t){return lo(t).top()},wo=function(t,n,e){if(0===e.length)return[];var r=A(e.slice(1),function(n,e){return n.map(function(n){return t(e,n)})}),o=e[e.length-1].map(function(t){return n(e.length-1,t)});return r.concat([o])},xo={delta:i,positions:u(wo,function(t,n){return mo(t,yo(n))},function(t,n){return mo(t,yo(n)+Ur(n))}),edge:yo},So={delta:i,edge:ho,positions:u(wo,vo,bo)},Co={height:xo,rtl:{delta:function(t,n){return-t},edge:po,positions:u(wo,bo,vo)},ltr:So},Oo={ltr:Co.ltr,rtl:Co.rtl};function ko(t){var n=function(n){return t(n).isRtl()?Oo.rtl:Oo.ltr};return{delta:function(t,e){return n(e).delta(t,e)},edge:function(t){return n(t).edge(t)},positions:function(t,e){return n(e).positions(t)}}}var To,Eo=function(t){var n=fe(t);return pe.generate(n).grid()},Do=Object.prototype.hasOwnProperty,Ao=(To=function(t,n){return n},function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},r=0;r<t.length;r++){var o=t[r];for(var i in o)Do.call(o,i)&&(e[i]=To(e[i],o[i]))}return e}),Ro=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},Bo=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return b.none()},No=function(t,n,e,r){e===r?xt(t,n):vt(t,n,e)},_o=function(t,n){var e=[],r=[],i=function(n,o){n.length>0?function(n,o){var i=te(t,o).getOrThunk(function(){var n=At.fromTag(o,Sn(t).dom());return Nn(t,n),n});Fn(i);var u=A(n,function(t){t.isNew()&&e.push(t.element());var n=t.element();return Fn(n),R(t.cells(),function(t){t.isNew()&&r.push(t.element()),No(t.element(),"colspan",t.colspan(),1),No(t.element(),"rowspan",t.rowspan(),1),Nn(n,t.element())}),n});Mn(i,u)}(n,o):function(n){te(t,n).each(Pn)}(o)},u=[],a=[],c=[];return R(n,function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":a.push(t);break;case"tfoot":c.push(t)}}),i(u,"thead"),i(a,"tbody"),i(c,"tfoot"),{newRows:o(e),newCells:o(r)}},Io=function(t){return A(t,function(t){var n=Re(t.element());return R(t.cells(),function(t){var e=Be(t.element());No(e,"colspan",t.colspan(),1),No(e,"rowspan",t.rowspan(),1),Nn(n,e)}),n})},Mo=function(t,n){var e=yt(t,n);return void 0===e||""===e?[]:e.split(" ")},Fo=function(t){return void 0!==t.dom().classList},Po=function(t){return Mo(t,"class")},Lo=function(t,n){return function(t,n,e){var r=Mo(t,n).concat([e]);return vt(t,n,r.join(" ")),!0}(t,"class",n)},Ho=function(t,n){return function(t,n,e){var r=N(Mo(t,n),function(t){return t!==e});return r.length>0?vt(t,n,r.join(" ")):xt(t,n),!1}(t,"class",n)},Vo=function(t,n){Fo(t)?t.dom().classList.add(n):Lo(t,n)},zo=function(t,n){Fo(t)?t.dom().classList.remove(n):Ho(t,n),function(t){0===(Fo(t)?t.dom().classList:Po(t)).length&&xt(t,"class")}(t)},jo=function(t,n){return Fo(t)&&t.dom().classList.contains(n)},Uo=function(t,n){for(var e=[],r=0;r<t;r++)e.push(n(r));return e},Wo=function(t,n){for(var e=[],r=t;r<n;r++)e.push(r);return e},Go=function(t,n){if(n<0||n>=t.length-1)return b.none();var e=t[n].fold(function(){var e=U(t.slice(0,n));return Bo(e,function(t,n){return t.map(function(t){return{value:t,delta:n+1}})})},function(t){return b.some({value:t,delta:0})}),r=t[n+1].fold(function(){var e=t.slice(n+1);return Bo(e,function(t,n){return t.map(function(t){return{value:t,delta:n+1}})})},function(t){return b.some({value:t,delta:1})});return e.bind(function(t){return r.map(function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e})})},qo=function(t,n,e){var r=t();return M(r,n).orThunk(function(){return b.from(r[0]).orThunk(e)}).map(function(t){return t.element()})},$o=function(t){var n=t.grid(),e=Wo(0,n.columns()),r=Wo(0,n.rows());return A(e,function(n){return qo(function(){return V(r,function(e){return pe.getAt(t,e,n).filter(function(t){return t.column()===n}).fold(o([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return pe.getAt(t,0,n)})})},Xo=function(t){var n=t.grid(),e=Wo(0,n.rows()),r=Wo(0,n.columns());return A(e,function(n){return qo(function(){return V(r,function(e){return pe.getAt(t,n,e).filter(function(t){return t.row()===n}).fold(o([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return pe.getAt(t,n,0)})})},Yo=function(t){var n=t.replace(/\./g,"-");return{resolve:function(t){return n+"-"+t}}},Ko=Yo("ephox-snooker"),Jo={resolve:Ko.resolve},Zo=function(t,n,e,r,o){var i=At.fromTag("div");return Ft(i,{position:"absolute",left:n-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),bt(i,{"data-column":t,role:"presentation"}),i},Qo=function(t,n,e,r,o){var i=At.fromTag("div");return Ft(i,{position:"absolute",left:n+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),bt(i,{"data-row":t,role:"presentation"}),i},ti=Jo.resolve("resizer-bar"),ni=Jo.resolve("resizer-rows"),ei=Jo.resolve("resizer-cols"),ri=function(t){var n=Yn(t.parent(),"."+ti);R(n,Pn)},oi=function(t,n,e){var r=t.origin();R(n,function(n,o){n.each(function(n){var o=e(r,n);Vo(o,ti),Nn(t.parent(),o)})})},ii=function(t,n,e,r,o,i){var u=lo(n);!function(t,n,e,r){oi(t,n,function(t,n){var o=Qo(n.row(),e.left()-t.left(),n.y()-t.top(),r,7);return Vo(o,ni),o})}(t,e.length>0?o.positions(e,n):[],u,qr(n)),function(t,n,e,r){oi(t,n,function(t,n){var o=Zo(n.col(),n.x()-t.left(),e.top()-t.top(),7,r);return Vo(o,ei),o})}(t,r.length>0?i.positions(r,n):[],u,Ur(n))},ui=function(t,n){var e=Yn(t.parent(),"."+ti);R(e,n)},ai={refresh:function(t,n,e,r){ri(t);var o=fe(n),i=pe.generate(o),u=Xo(i),a=$o(i);ii(t,n,u,a,e,r)},hide:function(t){ui(t,function(t){Mt(t,"display","none")})},show:function(t){ui(t,function(t){Mt(t,"display","block")})},destroy:ri,isRowBar:function(t){return jo(t,ni)},isColBar:function(t){return jo(t,ei)}},ci=function(t,n){return Gn.rowcells(n,t.section())},si=function(t,n){return t.cells()[n]},li={addCell:function(t,n,e){var r=t.cells(),o=r.slice(0,n),i=r.slice(n),u=o.concat([e]).concat(i);return ci(t,u)},setCells:ci,mutateCell:function(t,n,e){t.cells()[n]=e},getCell:si,getCellElement:function(t,n){return si(t,n).element()},mapCells:function(t,n){var e=t.cells(),r=A(e,n);return Gn.rowcells(r,t.section())},cellLength:function(t){return t.cells().length}},fi=function(t,n){if(0===t.length)return 0;var e=t[0];return F(t,function(t){return!n(e.element(),t.element())}).fold(function(){return t.length},function(t){return t})},di=function(t,n,e,r){var i=function(t,n){return t[n]}(t,n).cells().slice(e),u=fi(i,r),a=function(t,n){return A(t,function(t){return li.getCell(t,n)})}(t,e).slice(n),c=fi(a,r);return{colspan:o(u),rowspan:o(c)}},mi=function(t,n){var e=A(t,function(t,n){return A(t.cells(),function(t,n){return!1})});return A(t,function(r,o){var i=V(r.cells(),function(r,i){if(!1===e[o][i]){var u=di(t,o,i,n);return function(t,n,r,o){for(var i=t;i<t+r;i++)for(var u=n;u<n+o;u++)e[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[Gn.detailnew(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]});return Gn.rowdetails(i,r.section())})},gi=function(t,n,e){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=pe.getAt(t,o,u).map(function(t){return Gn.elementnew(t.element(),e)}).getOrThunk(function(){return Gn.elementnew(n.gap(),!0)});i.push(a)}var c=Gn.rowcells(i,t.all()[o].section());r.push(c)}return r},pi=function(t,n){return A(t,function(t){var e=function(t){return Bo(t,function(t){return Cn(t.element()).map(function(t){var n=Cn(t).isNone();return Gn.elementnew(t,n)})}).getOrThunk(function(){return Gn.elementnew(n.row(),!0)})}(t.details());return Gn.rowdatanew(e.element(),t.details(),t.section(),e.isNew())})},hi=function(t,n){var e=mi(t,yn);return pi(e,n)},vi=function(t,n){var e=H(A(t.all(),function(t){return t.cells()}));return M(e,function(t){return yn(n,t.element())})},bi=function(t,n,e,r,i){return function(u,a,c,s,l){var f=fe(a),d=pe.generate(f);return n(d,c).map(function(n){var e=function(t,n){return gi(t,n,!1)}(d,s),r=t(e,n,yn,i(s)),u=hi(r.grid(),s);return{grid:o(u),cursor:r.cursor}}).fold(function(){return b.none()},function(t){var n=_o(a,t.grid());return e(a,t.grid(),l),r(a),ai.refresh(u,a,Co.height,l),b.some({cursor:t.cursor,newRows:n.newRows,newCells:n.newCells})})}},yi=hi,wi=function(t,n){return le.cell(n.element()).bind(function(n){return vi(t,n)})},xi=function(t,n){var e=A(n.selection(),function(n){return le.cell(n).bind(function(n){return vi(t,n)})}),r=Ro(e);return r.length>0?b.some(r):b.none()},Si=function(t,n){return le.cell(n.element()).bind(function(e){return vi(t,e).map(function(t){return Ao(t,{generators:n.generators,clipboard:n.clipboard})})})},Ci=function(t,n){var e=A(n.selection(),function(n){return le.cell(n).bind(function(n){return vi(t,n)})}),r=Ro(e);return r.length>0?b.some(Ao({cells:r},{generators:n.generators,clipboard:n.clipboard})):b.none()},Oi=function(t,n){return n.mergable()},ki=function(t,n){return n.unmergable()},Ti=function(t){return{is:function(n){return t===n},isValue:d,isError:f,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:function(n){return Ti(t)},orThunk:function(n){return Ti(t)},fold:function(n,e){return e(t)},map:function(n){return Ti(n(t))},mapError:function(n){return Ti(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return b.some(t)}}},Ei=function(t){return{is:f,isValue:f,isError:d,getOr:i,getOrThunk:function(t){return t()},getOrDie:function(){return s(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return Ei(t)},mapError:function(n){return Ei(n(t))},each:e,bind:function(n){return Ei(t)},exists:f,forall:d,toOption:b.none}},Di={value:Ti,error:Ei},Ai=function(t,n){return A(t,function(){return Gn.elementnew(n.cell(),!0)})},Ri=function(t,n,e){return t.concat(Uo(n,function(n){return li.setCells(t[t.length-1],Ai(t[t.length-1].cells(),e))}))},Bi=function(t,n,e){return A(t,function(t){return li.setCells(t,t.cells().concat(Ai(Wo(0,n),e)))})},Ni=function(t,n,e){if(t.row()>=n.length||t.column()>li.cellLength(n[0]))return Di.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=n.slice(t.row()),i=r[0].cells().slice(t.column()),u=li.cellLength(e[0]),a=e.length;return Di.value({rowDelta:o(r.length-a),colDelta:o(i.length-u)})},_i=function(t,n){var e=li.cellLength(t[0]),r=li.cellLength(n[0]);return{rowDelta:o(0),colDelta:o(e-r)}},Ii=function(t,n,e){var r=n.colDelta()<0?Bi:i;return(n.rowDelta()<0?Ri:i)(r(t,Math.abs(n.colDelta()),e),Math.abs(n.rowDelta()),e)},Mi=function(t,n,e,r){if(0===t.length)return t;for(var o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)li.mutateCell(t[o],i,Gn.elementnew(r(),!1));return t},Fi=function(t,n,e,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<li.cellLength(t[0]);u++){var a=e(li.getCellElement(t[i],u),n);!0===a&&!1===o?li.mutateCell(t[i],u,Gn.elementnew(r(),!0)):!0===a&&(o=!1)}return t},Pi=function(t,n,e,r){if(n>0&&n<t.length){var o=function(t,n){return I(t,function(t,e){return D(t,function(t){return n(t.element(),e.element())})?t:t.concat([e])},[])}(t[n-1].cells(),e);R(o,function(o){for(var i=b.none(),u=function(n){for(var u=function(u){var a=t[n].cells()[u];e(a.element(),o.element())&&(i.isNone()&&(i=b.some(r())),i.each(function(e){li.mutateCell(t[n],u,Gn.elementnew(e,!0))}))},a=0;a<li.cellLength(t[0]);a++)u(a)},a=n;a<t.length;a++)u(a)})}return t},Li=function(t,n,e,r){var o=u(r,li.getCell(t[n],e).element()),i=t[n];return t.length>1&&li.cellLength(i)>1&&(e>0&&o(li.getCellElement(i,e-1))||e<i.length-1&&o(li.getCellElement(i,e+1))||n>0&&o(li.getCellElement(t[n-1],e))||n<t.length-1&&o(li.getCellElement(t[n+1],e)))},Hi=function(t,n,e,r,o){return Ni(t,n,e).map(function(i){var u=Ii(n,i,r);return function(t,n,e,r,o){for(var i=t.row(),u=t.column(),a=i+e.length,c=u+li.cellLength(e[0]),s=i;s<a;s++)for(var l=u;l<c;l++){Li(n,s,l,o)&&Fi(n,li.getCellElement(n[s],l),o,r.cell);var f=li.getCellElement(e[s-i],l-u),d=r.replace(f);li.mutateCell(n[s],l,Gn.elementnew(d,!0))}return n}(t,u,e,r,o)})},Vi=function(t,n,e,r,o){Pi(n,t,o,r.cell);var i=_i(e,n),u=Ii(e,i,r),a=_i(n,u),c=Ii(n,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},zi=function(t,n,e,r,o){var i=t.slice(0,n),u=t.slice(n),a=li.mapCells(t[e],function(e,i){return n>0&&n<t.length&&r(li.getCellElement(t[n-1],i),li.getCellElement(t[n],i))?li.getCell(t[n],i):Gn.elementnew(o(e.element(),r),!0)});return i.concat([a]).concat(u)},ji=function(t,n,e,r,o){return A(t,function(t){var i=n>0&&n<li.cellLength(t)&&r(li.getCellElement(t,n-1),li.getCellElement(t,n))?li.getCell(t,n):Gn.elementnew(o(li.getCellElement(t,e),r),!0);return li.addCell(t,n,i)})},Ui=function(t,n,e,r,o){var i=e+1;return A(t,function(t,u){var a=u===n?Gn.elementnew(o(li.getCellElement(t,e),r),!0):li.getCell(t,e);return li.addCell(t,i,a)})},Wi=function(t,n,e,r,o){var i=n+1,u=t.slice(0,i),a=t.slice(i),c=li.mapCells(t[n],function(t,n){return n===e?Gn.elementnew(o(t.element(),r),!0):t});return u.concat([c]).concat(a)},Gi=function(t,n,e){return t.slice(0,n).concat(t.slice(e+1))},qi=function(t,n,e){var r=A(t,function(t){var r=t.cells().slice(0,n).concat(t.cells().slice(e+1));return Gn.rowcells(r,t.section())});return N(r,function(t){return t.cells().length>0})},$i=function(t,n,e,r){return A(t,function(t){return li.mapCells(t,function(t){return function(t){return D(n,function(n){return e(t.element(),n.element())})}(t)?Gn.elementnew(r(t.element(),e),!0):t})})},Xi=function(t,n,e,r){return void 0!==li.getCellElement(t[n],e)&&n>0&&r(li.getCellElement(t[n-1],e),li.getCellElement(t[n],e))},Yi=function(t,n,e){return n>0&&e(li.getCellElement(t,n-1),li.getCellElement(t,n))},Ki=function(t,n,e,r){var o=V(t,function(r,o){return Xi(t,o,n,e)||Yi(r,n,e)?[]:[li.getCell(r,n)]});return $i(t,o,e,r)},Ji=function(t,n,e,r){var o=t[n],i=V(o.cells(),function(r,i){return Xi(t,n,i,e)||Yi(o,i,e)?[]:[r]});return $i(t,i,e,r)},Zi=function(t){return{fold:t}},Qi=function(){return Zi(function(t,n,e,r,o){return t()})},tu=function(t){return Zi(function(n,e,r,o,i){return e(t)})},nu=function(t,n){return Zi(function(e,r,o,i,u){return o(t,n)})},eu=function(t,n,e){return Zi(function(r,o,i,u,a){return u(t,n,e)})},ru=function(t,n){return Zi(function(e,r,o,i,u){return u(t,n)})},ou=function(t,n,e,r){var i=t.slice(0),u=function(t,n){return 0===t.length?Qi():1===t.length?tu(0):0===n?nu(0,1):n===t.length-1?ru(n-1,n):n>0&&n<t.length-1?eu(n-1,n,n+1):Qi()}(t,n),a=function(t){return A(t,o(0))},c=o(a(i)),s=function(t,n){if(e>=0){var o=Math.max(r.minCellWidth(),i[n]-e);return a(i.slice(0,t)).concat([e,o-i[n]]).concat(a(i.slice(n+1)))}var u=Math.max(r.minCellWidth(),i[t]+e),c=i[t]-u;return a(i.slice(0,t)).concat([u-i[t],c]).concat(a(i.slice(n+1)))},l=s;return u.fold(c,function(t){return r.singleColumnWidth(i[t],e)},l,function(t,n,e){return s(n,e)},function(t,n){if(e>=0)return a(i.slice(0,n)).concat([e]);var o=Math.max(r.minCellWidth(),i[n]+e);return a(i.slice(0,n)).concat([o-i[n]])})},iu=function(t,n){return wt(t,n)&&parseInt(yt(t,n),10)>1},uu={hasColspan:function(t){return iu(t,"colspan")},hasRowspan:function(t){return iu(t,"rowspan")},minWidth:o(10),minHeight:o(10),getInt:function(t,n){return parseInt(Pt(t,n),10)}},au=function(t,n,e){return Ht(t,n).fold(function(){return e(t)+"px"},function(t){return t})},cu=function(t){return au(t,"width",io.getPixelWidth)},su=function(t){return au(t,"height",io.getHeight)},lu=function(t,n,e,r,o){var i=$o(t),u=A(i,function(t){return t.map(n.edge)});return A(i,function(t,n){return t.filter(c(uu.hasColspan)).fold(function(){var t=Go(u,n);return r(t)},function(t){return e(t,o)})})},fu=function(t){return t.map(function(t){return t+"px"}).getOr("")},du=function(t,n,e,r){var o=Xo(t),i=A(o,function(t){return t.map(n.edge)});return A(o,function(t,n){return t.filter(c(uu.hasRowspan)).fold(function(){var t=Go(i,n);return r(t)},function(t){return e(t)})})},mu={getRawWidths:function(t,n){return lu(t,n,cu,fu)},getPixelWidths:function(t,n,e){return lu(t,n,io.getPixelWidth,function(t){return t.getOrThunk(e.minCellWidth)},e)},getPercentageWidths:function(t,n,e){return lu(t,n,io.getPercentageWidth,function(t){return t.fold(function(){return e.minCellWidth()},function(t){return t/e.pixelWidth()*100})},e)},getPixelHeights:function(t,n){return du(t,n,io.getHeight,function(t){return t.getOrThunk(uu.minHeight)})},getRawHeights:function(t,n){return du(t,n,su,fu)}},gu=function(t,n,e){for(var r=0,o=t;o<n;o++)r+=void 0!==e[o]?e[o]:0;return r},pu=function(t,n){var e=pe.justCells(t);return A(e,function(t){var e=gu(t.column(),t.column()+t.colspan(),n);return{element:t.element,width:o(e),colspan:t.colspan}})},hu=function(t,n){var e=pe.justCells(t);return A(e,function(t){var e=gu(t.row(),t.row()+t.rowspan(),n);return{element:t.element,height:o(e),rowspan:t.rowspan}})},vu=function(t,n){return A(t.all(),function(t,e){return{element:t.element,height:o(n[e])}})},bu=function(t){var n=parseInt(t,10),e=i;return{width:o(n),pixelWidth:o(n),getWidths:mu.getPixelWidths,getCellDelta:e,singleColumnWidth:function(t,n){return[Math.max(uu.minWidth(),t+n)-t]},minCellWidth:uu.minWidth,setElementWidth:io.setPixelWidth,setTableWidth:function(t,n,e){var r=_(n,function(t,n){return t+n},0);io.setPixelWidth(t,r)}}},yu=function(t,n){if(io.percentageBasedSizeRegex().test(n))return function(t,n){var e=parseFloat(t),r=Gr(n);return{width:o(e),pixelWidth:o(r),getWidths:mu.getPercentageWidths,getCellDelta:function(t){return t/r*100},singleColumnWidth:function(t,n){return[100-t]},minCellWidth:function(){return uu.minWidth()/r*100},setElementWidth:io.setPercentageWidth,setTableWidth:function(t,n,r){var o=e+r;io.setPercentageWidth(t,o)}}}(io.percentageBasedSizeRegex().exec(n)[1],t);if(io.pixelBasedSizeRegex().test(n)){var e=io.pixelBasedSizeRegex().exec(n);return bu(e[1])}var r=Gr(t);return bu(r)},wu=function(t){return io.getRawWidth(t).fold(function(){var n=Gr(t);return bu(n)},function(n){return yu(t,n)})},xu=function(t){return pe.generate(t)},Su=function(t){var n=fe(t);return xu(n)},Cu={adjustWidth:function(t,n,e,r){var o=wu(t),i=o.getCellDelta(n),u=Su(t),a=o.getWidths(u,r,o),c=ou(a,e,i,o),s=A(c,function(t,n){return t+a[n]}),l=pu(u,s);R(l,function(t){o.setElementWidth(t.element(),t.width())}),e===u.grid().columns()-1&&o.setTableWidth(t,s,i)},adjustHeight:function(t,n,e,r){var o=Su(t),i=mu.getPixelHeights(o,r),u=A(i,function(t,r){return e===r?Math.max(n+t,uu.minHeight()):t}),a=hu(o,u),c=vu(o,u);R(c,function(t){io.setHeight(t.element(),t.height())}),R(a,function(t){io.setHeight(t.element(),t.height())});var s=_(u,function(t,n){return t+n},0);io.setHeight(t,s)},adjustWidthTo:function(t,n,e){var r=wu(t),o=xu(n),i=r.getWidths(o,e,r),u=pu(o,i);R(u,function(t){r.setElementWidth(t.element(),t.width())});var a=_(i,function(t,n){return n+t},0);u.length>0&&r.setTableWidth(t,a)}},Ou=function(t,n){return ku(t,n,{validate:O,label:"function"})},ku=function(t,n,e){if(0===n.length)throw new Error("You must specify at least one required field.");return et("required",n),rt(n),function(r){var o=G(r);z(n,function(t){return E(o,t)})||tt(n,o),t(n,o);var i=N(n,function(t){return!e.validate(r[t],t)});return i.length>0&&function(t,n){throw new Error("All values need to be of type: "+n+". Keys ("+Q(t).join(", ")+") were not.")}(i,e.label),r}},Tu=function(t,n){var e=N(n,function(n){return!E(t,n)});e.length>0&&nt(e)},Eu=function(t){return Ou(Tu,t)},Du=function(t){var n=wt(t,"colspan")?parseInt(yt(t,"colspan"),10):1,e=wt(t,"rowspan")?parseInt(yt(t,"rowspan"),10):1;return{element:o(t),colspan:o(n),rowspan:o(e)}},Au=Eu(["cell","row","replace","gap"]),Ru=function(t,e){Au(t);var r=n(b.none()),o=void 0!==e?e:Du,i=function(n){return function(n){return t.cell(n)}(o(n))},u=function(t){var n=i(t);return r.get().isNone()&&r.set(b.some(n)),a=b.some({item:t,replacement:n}),n},a=b.none();return{getOrInit:function(t,n){return a.fold(function(){return u(t)},function(e){return n(t,e.item)?e.replacement:u(t)})},cursor:r.get}},Bu=function(t,e){return function(r){var o=n(b.none());Au(r);var i=[],u=function(n){var u=r.replace(n,e,{scope:t});return i.push({item:n,sub:u}),o.get().isNone()&&o.set(b.some(u)),u};return{replaceOrInit:function(t,n){return function(t,n){return M(i,function(e){return n(e.item,t)})}(t,n).fold(function(){return u(t)},function(e){return n(t,e.item)?e.sub:u(t)})},cursor:o.get}}},Nu=function(t){Au(t);var e=n(b.none());return{combine:function(n){return e.get().isNone()&&e.set(b.some(n)),function(){var e=t.cell({element:o(n),colspan:o(1),rowspan:o(1)});return Vt(e,"width"),Vt(n,"width"),e}},cursor:e.get}},_u=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Iu=function(t,n){var e=t.property().name(n);return E(_u,e)},Mu=function(t,n){return E(["br","img","hr","input"],t.property().name(n))},Fu=Iu,Pu=function(t,n){var e=t.property().name(n);return E(["ol","ul"],e)},Lu=Mu,Hu=Ve(),Vu=function(t){return Fu(Hu,t)},zu=function(t){return Pu(Hu,t)},ju=function(t){return Lu(Hu,t)},Uu=function(t){var n,e=function(t){return"br"===st(t)},r=function(t){return Ee(t).bind(function(n){var r=Tn(n).map(function(t){return!!Vu(t)||(ju(t)?"img"!==st(t):void 0)}).getOr(!1);return Cn(n).map(function(o){return!0===r||function(t){return"li"===st(t)||Jn(t,zu).isSome()}(o)||e(n)||Vu(o)&&!yn(t,o)?[]:[At.fromTag("br")]})}).getOr([])},o=0===(n=V(t,function(t){var n=En(t);return function(t){return z(t,function(t){return e(t)||gt(t)&&0===we(t).trim().length})}(n)?[]:n.concat(r(t))})).length?[At.fromTag("br")]:n;Fn(t[0]),Mn(t[0],o)},Wu=function(t){0===le.cells(t).length&&Pn(t)},Gu=Z("grid","cursor"),qu=function(t,n,e){return $u(t,n,e).orThunk(function(){return $u(t,0,0)})},$u=function(t,n,e){return b.from(t[n]).bind(function(t){return b.from(t.cells()[e]).bind(function(t){return b.from(t.element())})})},Xu=function(t,n,e){return Gu(t,$u(t,n,e))},Yu=function(t){return I(t,function(t,n){return D(t,function(t){return t.row()===n.row()})?t:t.concat([n])},[]).sort(function(t,n){return t.row()-n.row()})},Ku=function(t){return I(t,function(t,n){return D(t,function(t){return t.column()===n.column()})?t:t.concat([n])},[]).sort(function(t,n){return t.column()-n.column()})},Ju=function(t,n,e){var r=de(t,e),o=pe.generate(r);return gi(o,n,!0)},Zu=Cu.adjustWidthTo,Qu={insertRowBefore:bi(function(t,n,e,r){var o=n.row(),i=n.row(),u=zi(t,i,o,e,r.getOrInit);return Xu(u,i,n.column())},wi,e,e,Ru),insertRowsBefore:bi(function(t,n,e,r){var o=n[0].row(),i=n[0].row(),u=Yu(n),a=I(u,function(t,n){return zi(t,i,o,e,r.getOrInit)},t);return Xu(a,i,n[0].column())},xi,e,e,Ru),insertRowAfter:bi(function(t,n,e,r){var o=n.row(),i=n.row()+n.rowspan(),u=zi(t,i,o,e,r.getOrInit);return Xu(u,i,n.column())},wi,e,e,Ru),insertRowsAfter:bi(function(t,n,e,r){var o=Yu(n),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=I(o,function(t,n){return zi(t,u,i,e,r.getOrInit)},t);return Xu(a,u,n[0].column())},xi,e,e,Ru),insertColumnBefore:bi(function(t,n,e,r){var o=n.column(),i=n.column(),u=ji(t,i,o,e,r.getOrInit);return Xu(u,n.row(),i)},wi,Zu,e,Ru),insertColumnsBefore:bi(function(t,n,e,r){var o=Ku(n),i=o[0].column(),u=o[0].column(),a=I(o,function(t,n){return ji(t,u,i,e,r.getOrInit)},t);return Xu(a,n[0].row(),u)},xi,Zu,e,Ru),insertColumnAfter:bi(function(t,n,e,r){var o=n.column(),i=n.column()+n.colspan(),u=ji(t,i,o,e,r.getOrInit);return Xu(u,n.row(),i)},wi,Zu,e,Ru),insertColumnsAfter:bi(function(t,n,e,r){var o=n[n.length-1].column(),i=n[n.length-1].column()+n[n.length-1].colspan(),u=Ku(n),a=I(u,function(t,n){return ji(t,i,o,e,r.getOrInit)},t);return Xu(a,n[0].row(),i)},xi,Zu,e,Ru),splitCellIntoColumns:bi(function(t,n,e,r){var o=Ui(t,n.row(),n.column(),e,r.getOrInit);return Xu(o,n.row(),n.column())},wi,Zu,e,Ru),splitCellIntoRows:bi(function(t,n,e,r){var o=Wi(t,n.row(),n.column(),e,r.getOrInit);return Xu(o,n.row(),n.column())},wi,e,e,Ru),eraseColumns:bi(function(t,n,e,r){var o=Ku(n),i=qi(t,o[0].column(),o[o.length-1].column()),u=qu(i,n[0].row(),n[0].column());return Gu(i,u)},xi,Zu,Wu,Ru),eraseRows:bi(function(t,n,e,r){var o=Yu(n),i=Gi(t,o[0].row(),o[o.length-1].row()),u=qu(i,n[0].row(),n[0].column());return Gu(i,u)},xi,e,Wu,Ru),makeColumnHeader:bi(function(t,n,e,r){var o=Ki(t,n.column(),e,r.replaceOrInit);return Xu(o,n.row(),n.column())},wi,e,e,Bu("row","th")),unmakeColumnHeader:bi(function(t,n,e,r){var o=Ki(t,n.column(),e,r.replaceOrInit);return Xu(o,n.row(),n.column())},wi,e,e,Bu(null,"td")),makeRowHeader:bi(function(t,n,e,r){var o=Ji(t,n.row(),e,r.replaceOrInit);return Xu(o,n.row(),n.column())},wi,e,e,Bu("col","th")),unmakeRowHeader:bi(function(t,n,e,r){var o=Ji(t,n.row(),e,r.replaceOrInit);return Xu(o,n.row(),n.column())},wi,e,e,Bu(null,"td")),mergeCells:bi(function(t,n,e,r){var i=n.cells();Uu(i);var u=Mi(t,n.bounds(),e,o(i[0]));return Gu(u,b.from(i[0]))},Oi,e,e,Nu),unmergeCells:bi(function(t,n,e,r){var o=_(n,function(t,n){return Fi(t,n,e,r.combine(n))},t);return Gu(o,b.from(n[0]))},ki,Zu,e,Nu),pasteCells:bi(function(t,n,e,r){var o=function(t,n){var e=fe(t),r=pe.generate(e);return gi(r,n,!0)}(n.clipboard(),n.generators()),i=Gn.address(n.row(),n.column());return Hi(i,t,o,n.generators(),e).fold(function(){return Gu(t,b.some(n.element()))},function(t){var e=qu(t,n.row(),n.column());return Gu(t,e)})},Si,Zu,e,Ru),pasteRowsBefore:bi(function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[0].row(),u=Ju(n.clipboard(),n.generators(),o),a=Vi(i,t,u,n.generators(),e),c=qu(a,n.cells[0].row(),n.cells[0].column());return Gu(a,c)},Ci,e,e,Ru),pasteRowsAfter:bi(function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[n.cells.length-1].row()+n.cells[n.cells.length-1].rowspan(),u=Ju(n.clipboard(),n.generators(),o),a=Vi(i,t,u,n.generators(),e),c=qu(a,n.cells[0].row(),n.cells[0].column());return Gu(a,c)},Ci,e,e,Ru)},ta=function(t){return At.fromDom(t.getBody())},na=function(t){return t.getBoundingClientRect().width},ea=function(t){return t.getBoundingClientRect().height},ra=function(t){return function(n){return yn(n,ta(t))}},oa=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},ia=function(t){var n=Yn(t,"td[data-mce-style],th[data-mce-style]");xt(t,"data-mce-style"),R(n,function(t){xt(t,"data-mce-style")})},ua={isRtl:o(!1)},aa={isRtl:o(!0)},ca={directionAt:function(t){return"rtl"===function(t){return"rtl"===Pt(t,"direction")?"rtl":"ltr"}(t)?aa:ua}},sa={"border-collapse":"collapse",width:"100%"},la={border:"1"},fa=function(t){return t.getParam("table_default_attributes",la,"object")},da=function(t){return t.getParam("table_default_styles",sa,"object")},ma=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},ga=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},pa=function(t){return t.getParam("table_row_advtab",!0,"boolean")},ha=function(t){return t.getParam("table_advtab",!0,"boolean")},va=function(t){return t.getParam("table_style_by_css",!1,"boolean")},ba=function(t){return t.getParam("table_class_list",[],"array")},ya=function(t){return!1===t.getParam("table_responsive_width")},wa=function(t,n){return t.fire("newrow",{node:n})},xa=function(t,n){return t.fire("newcell",{node:n})},Sa=function(t,n,e,r){t.fire("ObjectResizeStart",{target:n,width:e,height:r})},Ca=function(t,n,e,r){t.fire("ObjectResized",{target:n,width:e,height:r})},Oa=function(t,n){var r=function(t){return"table"===st(ta(t))},o=function(t){var n=t.getParam("table_clone_elements");return x(n)?b.some(n.split(/[ ,]/)):Array.isArray(n)?b.some(n):b.none()}(t),i=function(n,e,r,i){return function(u,a){ia(u);var c=i(),s=At.fromDom(t.getDoc()),l=ko(ca.directionAt),f=Pe(r,s,o);return e(u)?n(c,u,a,f,l).bind(function(n){return R(n.newRows(),function(n){wa(t,n.dom())}),R(n.newCells(),function(n){xa(t,n.dom())}),n.cursor().map(function(n){var e=t.dom.createRng();return e.setStart(n.dom(),0),e.setEnd(n.dom(),0),e})}):b.none()}};return{deleteRow:i(Qu.eraseRows,function(n){var e=Eo(n);return!1===r(t)||e.rows()>1},e,n),deleteColumn:i(Qu.eraseColumns,function(n){var e=Eo(n);return!1===r(t)||e.columns()>1},e,n),insertRowsBefore:i(Qu.insertRowsBefore,d,e,n),insertRowsAfter:i(Qu.insertRowsAfter,d,e,n),insertColumnsBefore:i(Qu.insertColumnsBefore,d,uo,n),insertColumnsAfter:i(Qu.insertColumnsAfter,d,uo,n),mergeCells:i(Qu.mergeCells,d,e,n),unmergeCells:i(Qu.unmergeCells,d,e,n),pasteRowsBefore:i(Qu.pasteRowsBefore,d,e,n),pasteRowsAfter:i(Qu.pasteRowsAfter,d,e,n),pasteCells:i(Qu.pasteCells,d,e,n)}},ka=function(t,n,e){var r=fe(t),o=pe.generate(r);return xi(o,n).map(function(t){var n=gi(o,e,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=yi(n,e);return Io(r)})},Ta=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ea=function(t,n,e){e&&t.formatter.apply("align"+e,{},n)},Da=function(t,n,e){e&&t.formatter.apply("valign"+e,{},n)},Aa=function(t,n){Ta.each("left center right".split(" "),function(e){t.formatter.remove("align"+e,{},n)})},Ra=function(t,n){Ta.each("top middle bottom".split(" "),function(e){t.formatter.remove("valign"+e,{},n)})},Ba=function(t,n,e){var r;return function(n,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],e);if(void 0===n&&(n=i),n!==i)return""}return n}(r,t.select("td,th",n))},Na=function(){return(Na=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},_a=function(t,n){var e=function(n){return kt(n,"rgb")?t.toHex(n):n};return{borderstyle:Ht(At.fromDom(n),"border-style").getOr(""),bordercolor:Ht(At.fromDom(n),"border-color").map(e).getOr(""),backgroundcolor:Ht(At.fromDom(n),"background-color").map(e).getOr("")}},Ia=function(t,n,e,r,o){var i={};return Ta.each(t.split(" "),function(t){r.formatter.matchNode(o,n+t)&&(i[e]=t)}),i[e]||(i[e]=""),i},Ma=u(Ia,"left center right"),Fa=u(Ia,"top middle bottom"),Pa=function(t,n,e){var r=function(t,e){return e=e||[],Ta.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,n&&n(o)),e.push(o)}),e};return r(t,e||[])},La=function(t){var n=t[0],e=t.slice(1),r=G(n);return R(e,function(t){R(r,function(e){$(t,function(t,r,o){var i=n[e];""!==i&&e===r&&i!==t&&(n[e]="")})})}),n},Ha=function(){return{title:"Advanced",items:[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}]}},Va=function(t,n,e){var r=t.dom;return Na({width:r.getStyle(n,"width")||r.getAttrib(n,"width"),height:r.getStyle(n,"height")||r.getAttrib(n,"height"),cellspacing:r.getStyle(n,"border-spacing")||r.getAttrib(n,"cellspacing"),cellpadding:r.getAttrib(n,"cellpadding")||Ba(t.dom,n,"padding"),border:function(n,e){var r=Ht(At.fromDom(e),"border-width");return va(t)&&r.isSome()?r.getOr(""):n.getAttrib(e,"border")||Ba(t.dom,e,"border-width")||Ba(t.dom,e,"border")}(r,n),caption:!!r.select("caption",n)[0],class:r.getAttrib(n,"class","")},Ma("align","align",t,n),e?_a(r,n):{})},za=function(t,n,e){var r=t.dom;return Na({height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),class:r.getAttrib(n,"class",""),align:"",type:n.parentNode.nodeName.toLowerCase()},Ma("align","align",t,n),e?_a(r,n):{})},ja=function(t,n,e){var r=t.dom;return Na({width:r.getStyle(n,"width")||r.getAttrib(n,"width"),height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),celltype:n.nodeName.toLowerCase(),class:r.getAttrib(n,"class","")},Ma("align","halign",t,n),Fa("valign","valign",t,n),e?_a(r,n):{})},Ua=function(t,n){var e,r,o,i=da(t),u=fa(t),a=t.dom,c=n?function(t){var n=function(n){return kt(n,"rgb")?t.toHex(n):n},e=K(i,"border-style").getOr(""),r=K(i,"border-color").getOr(""),o=K(i,"background-color").getOr("");return{borderstyle:e,bordercolor:n(r),backgroundcolor:n(o)}}(a):{};return Na({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},i,u,c,(o=i["border-width"],va(t)&&o?{border:o}:K(u,"border").fold(function(){return{}},function(t){return{border:t}})),(e=K(i,"border-spacing").or(K(u,"cellspacing")).fold(function(){return{}},function(t){return{cellspacing:t}}),r=K(i,"border-padding").or(K(u,"cellpadding")).fold(function(){return{}},function(t){return{cellpadding:t}}),Na({},e,r)))},Wa=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Ga=function(t){return function(t){var n=function(t){return t.getParam("table_cell_class_list",[],"array")}(t),e=Pa(n,function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})});return n.length>0?b.some({name:"class",type:"selectbox",label:"Class",items:e}):b.none()}(t).fold(function(){return Wa},function(t){return Wa.concat(t)})},qa={normal:function(t,n){return{setAttrib:function(e,r){t.setAttrib(n,e,r)},setStyle:function(e,r){t.setStyle(n,e,r)}}},ifTruthy:function(t,n){return{setAttrib:function(e,r){r&&t.setAttrib(n,e,r)},setStyle:function(e,r){r&&t.setStyle(n,e,r)}}}},$a=function(t,n){t.setAttrib("scope",n.scope),t.setAttrib("class",n.class),t.setStyle("width",oa(n.width)),t.setStyle("height",oa(n.height))},Xa=function(t,n){t.setStyle("background-color",n.backgroundcolor),t.setStyle("border-color",n.bordercolor),t.setStyle("border-style",n.borderstyle)},Ya=function(t,n,e){var r=t.dom,o=e.celltype&&n[0].nodeName.toLowerCase()!==e.celltype?r.rename(n[0],e.celltype):n[0],i=qa.normal(r,o);$a(i,e),ga(t)&&Xa(i,e),Aa(t,o),Ra(t,o),e.halign&&Ea(t,o,e.halign),e.valign&&Da(t,o,e.valign)},Ka=function(t,n,e){var r=t.dom;Ta.each(n,function(n){e.celltype&&n.nodeName.toLowerCase()!==e.celltype&&(n=r.rename(n,e.celltype));var o=qa.ifTruthy(r,n);$a(o,e),ga(t)&&Xa(o,e),e.halign&&Ea(t,n,e.halign),e.valign&&Da(t,n,e.valign)})},Ja=function(t,n,e){var r=e.getData();e.close(),t.undoManager.transact(function(){(1===n.length?Ya:Ka)(t,n,r),t.focus()})},Za=function(t){var n,e=[];if(e=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!e.length&&n&&e.push(n),n=n||e[0]){var r=Ta.map(e,function(n){return ja(t,n,ga(t))}),o=La(r),i={type:"tabpanel",tabs:[{title:"General",items:Ga(t)},Ha()]},a={type:"panel",items:[{type:"grid",columns:2,items:Ga(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:ga(t)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:u(Ja,t,e)})}},Qa=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],tc=function(t){return function(t){var n=function(t){return t.getParam("table_row_class_list",[],"array")}(t),e=Pa(n,function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})});return n.length>0?b.some({name:"class",type:"selectbox",label:"Class",items:e}):b.none()}(t).fold(function(){return Qa},function(t){return Qa.concat(t)})},nc=function(t,n,e,r){var o=t.dom,i=r.getData();r.close();var u=1===n.length?qa.normal:qa.ifTruthy;t.undoManager.transact(function(){Ta.each(n,function(n){i.type!==n.parentNode.nodeName.toLowerCase()&&function(t,n,e){var r=t.getParent(n,"table"),o=n.parentNode,i=t.select(e,r)[0];i||(i=t.create(e),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(n),o.hasChildNodes()||t.remove(o)}(t.dom,n,i.type);var r=u(o,n);r.setAttrib("scope",i.scope),r.setAttrib("class",i.class),r.setStyle("height",oa(i.height)),pa(t)&&function(t,n){t.setStyle("background-color",n.backgroundcolor),t.setStyle("border-color",n.bordercolor),t.setStyle("border-style",n.borderstyle)}(r,i),i.align!==e.align&&(Aa(t,n),Ea(t,n,i.align))}),t.focus()})},ec=function(t){var n,e,r=t.dom,o=[];if((n=r.getParent(t.selection.getStart(),"table"))&&(e=r.getParent(t.selection.getStart(),"td,th"),Ta.each(n.rows,function(t){Ta.each(t.cells,function(n){if((r.getAttrib(n,"data-mce-selected")||n===e)&&o.indexOf(t)<0)return o.push(t),!1})}),o[0])){var i=Ta.map(o,function(n){return za(t,n,pa(t))}),a=La(i),c={type:"tabpanel",tabs:[{title:"General",items:tc(t)},Ha()]},s={type:"panel",items:[{type:"grid",columns:2,items:tc(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:pa(t)?c:s,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onSubmit:u(nc,t,o,a)})}},rc=tinymce.util.Tools.resolve("tinymce.Env"),oc={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},ic=function(t,n,e,r,o){void 0===o&&(o=oc);var i=At.fromTag("table");Ft(i,o.styles),bt(i,o.attributes);var u=At.fromTag("tbody");Nn(i,u);for(var a=[],c=0;c<t;c++){for(var s=At.fromTag("tr"),l=0;l<n;l++){var f=c<e||l<r?At.fromTag("th"):At.fromTag("td");l<r&&vt(f,"scope","row"),c<e&&vt(f,"scope","col"),Nn(f,At.fromTag("br")),o.percentages&&Mt(f,"width",100/n+"%"),Nn(s,f)}a.push(s)}return Mn(u,a),i},uc=function(t,n){t.selection.select(n.dom(),!0),t.selection.collapse(!0)},ac=function(t,n,e){var r,o=da(t),i={styles:o,attributes:fa(t),percentages:(r=o.width,x(r)&&-1!==r.indexOf("%")&&!ya(t))},a=ic(e,n,0,0,i);vt(a,"data-mce-id","__mce");var c=function(t){var n=At.fromTag("div"),e=At.fromDom(t.dom().cloneNode(!0));return Nn(n,e),function(t){return t.dom().innerHTML}(n)}(a);return t.insertContent(c),ne(ta(t),'table[data-mce-id="__mce"]').map(function(n){return ya(t)&&Mt(n,"width",Pt(n,"width")),xt(n,"data-mce-id"),function(t,n){R(Yn(n,"tr"),function(n){wa(t,n.dom()),R(Yn(n,"th,td"),function(n){xa(t,n.dom())})})}(t,n),function(t,n){ne(n,"td,th").each(u(uc,t))}(t,n),n.dom()}).getOr(null)},cc=function(t,n,e,r){if("TD"===n.tagName||"TH"===n.tagName)x(e)?t.setStyle(n,e,r):t.setStyle(n,e);else if(n.children)for(var o=0;o<n.children.length;o++)cc(t,n.children[o],e,r)},sc=function(t,n,e){var r,o=t.dom,i=e.getData();e.close(),""===i.class&&delete i.class,t.undoManager.transact(function(){if(!n){var e=parseInt(i.cols,10)||1,u=parseInt(i.rows,10)||1;n=ac(t,e,u)}!function(t,n,e){var r,o=t.dom,i={},u={};if(i.class=e.class,u.height=oa(e.height),o.getAttrib(n,"width")&&!va(t)?i.width=(r=e.width)?r.replace(/px$/,""):"":u.width=oa(e.width),va(t)?(u["border-width"]=oa(e.border),u["border-spacing"]=oa(e.cellspacing)):(i.border=e.border,i.cellpadding=e.cellpadding,i.cellspacing=e.cellspacing),va(t)&&n.children)for(var a=0;a<n.children.length;a++)cc(o,n.children[a],{"border-width":oa(e.border),padding:oa(e.cellpadding)}),ha(t)&&cc(o,n.children[a],{"border-color":e.bordercolor});ha(t)&&(u["background-color"]=e.backgroundcolor,u["border-color"]=e.bordercolor,u["border-style"]=e.borderstyle),i.style=o.serializeStyle(Ao(da(t),u)),o.setAttribs(n,Ao(fa(t),i))}(t,n,i),(r=o.select("caption",n)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=rc.ie?" ":'<br data-mce-bogus="1"/>',n.insertBefore(r,n.firstChild)),""===i.align?Aa(t,n):Ea(t,n,i.align),t.focus(),t.addVisual()})},lc=function(t,n){var e,r=t.dom,o=Ua(t,ha(t));!1===n?(e=r.getParent(t.selection.getStart(),"table"))?o=Va(t,e,ha(t)):ha(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",ha(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=ba(t).length>0;i&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var a=n?[{type:"input",name:"cols",label:"Cols"},{type:"input",name:"rows",label:"Rows"}]:[],c=function(t){return t.getParam("table_appearance_options",!0,"boolean")}(t)?[{type:"input",name:"cellspacing",label:"Cell spacing"},{type:"input",name:"cellpadding",label:"Cell padding"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],s=i?[{type:"selectbox",name:"class",label:"Class",items:Pa(ba(t),function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[n.value]})})})}]:[],l={type:"grid",columns:2,items:a.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(c).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(s)},f={type:"panel",items:[l]},d={type:"tabpanel",tabs:[{title:"General",items:[l]},Ha()]},m=ha(t)?d:f;t.windowManager.open({title:"Table Properties",size:"normal",body:m,onSubmit:u(sc,t,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},fc=function(t){return function(n){return b.from(n.dom.getParent(n.selection.getStart(),t)).map(At.fromDom)}},dc=fc("th,td"),mc=fc("th,td,caption"),gc=Ta.each,pc={registerCommands:function(t,n,r,o,i){var a=ra(t),s=function(t){return le.table(t,a)},l=function(t){return{width:na(t.dom()),height:na(t.dom())}},f=function(n){dc(t).each(function(e){s(e).each(function(i){var u=Lr.forMenu(o,i,e),a=l(i);n(i,u).each(function(n){!function(t,n,e){var r=l(e);n.width===r.width&&n.height===r.height||(Sa(t,e.dom(),n.width,n.height),Ca(t,e.dom(),r.width,r.height))}(t,a,i),t.selection.setRng(n),t.focus(),r.clear(i),ia(i)})})})},d=function(n){return dc(t).map(function(n){return s(n).bind(function(r){var i=At.fromDom(t.getDoc()),u=Lr.forMenu(o,r,n),a=Pe(e,i,b.none());return ka(r,u,a)})})},m=function(n){i.get().each(function(e){var i=A(e,function(t){return Be(t)});dc(t).each(function(e){s(e).each(function(u){var a=At.fromDom(t.getDoc()),c=Le(a),s=Lr.pasteRows(o,u,e,i,c);n(u,s).each(function(n){t.selection.setRng(n),t.focus(),r.clear(u)})})})})};gc({mceTableSplitCells:function(){f(n.unmergeCells)},mceTableMergeCells:function(){f(n.mergeCells)},mceTableInsertRowBefore:function(){f(n.insertRowsBefore)},mceTableInsertRowAfter:function(){f(n.insertRowsAfter)},mceTableInsertColBefore:function(){f(n.insertColumnsBefore)},mceTableInsertColAfter:function(){f(n.insertColumnsAfter)},mceTableDeleteCol:function(){f(n.deleteColumn)},mceTableDeleteRow:function(){f(n.deleteRow)},mceTableCutRow:function(t){d().each(function(t){i.set(t),f(n.deleteRow)})},mceTableCopyRow:function(t){d().each(function(t){i.set(t)})},mceTablePasteRowBefore:function(t){m(n.pasteRowsBefore)},mceTablePasteRowAfter:function(t){m(n.pasteRowsAfter)},mceTableDelete:function(){mc(t).each(function(n){le.table(n,a).filter(c(a)).each(function(n){var e=At.fromText("");if(Rn(n,e),Pn(n),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(e.dom(),0),r.setEnd(e.dom(),0),t.selection.setRng(r),t.nodeChanged()}})})}},function(n,e){t.addCommand(e,n)}),gc({mceInsertTable:u(lc,t,!0),mceTableProps:u(lc,t,!1),mceTableRowProps:u(ec,t),mceTableCellProps:u(Za,t)},function(n,e){t.addCommand(e,function(){n()})})}},hc=function(t){var n=b.from(t.dom().documentElement).map(At.fromDom).getOr(t);return{parent:o(n),view:o(t),origin:o(co(0,0))}},vc=function(t,n){return{parent:o(n),view:o(t),origin:o(co(0,0))}};function bc(t){var n=Z.apply(null,t),e=[];return{bind:function(t){if(void 0===t)throw"Event bind error: undefined handler";e.push(t)},unbind:function(t){e=N(e,function(n){return n!==t})},trigger:function(){var t=n.apply(null,arguments);R(e,function(n){n(t)})}}}var yc={create:function(t){return{registry:X(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:X(t,function(t){return t.trigger})}}},wc={mode:Eu(["compare","extract","mutate","sink"]),sink:Eu(["element","start","stop","destroy"]),api:Eu(["forceDrop","drop","move","delayDrop"])},xc={resolve:Yo("ephox-dragster").resolve},Sc=function(t,n){return function(e){if(t(e)){var i=At.fromDom(e.target),u=function(){e.stopPropagation()},a=function(){e.preventDefault()},c=r(a,u),s=function(t,n,e,r,i,u,a){return{target:o(t),x:o(n),y:o(e),stop:r,prevent:i,kill:u,raw:o(a)}}(i,e.clientX,e.clientY,u,a,c,e);n(s)}}},Cc=function(t,n,e,r){return function(t,n,e,r,o){var i=Sc(e,r);return t.dom().addEventListener(n,i,o),{unbind:u(Oc,t,n,i,o)}}(t,n,e,r,!1)},Oc=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},kc=o(!0),Tc=function(t,n,e){return Cc(t,n,kc,e)},Ec=wc.mode({compare:function(t,n){return co(n.left()-t.left(),n.top()-t.top())},extract:function(t){return b.some(co(t.x(),t.y()))},sink:function(t,n){var e=function(t){var n=Ao({layerClass:xc.resolve("blocker")},t),e=At.fromTag("div");return vt(e,"role","presentation"),Ft(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),Vo(e,xc.resolve("blocker")),Vo(e,n.layerClass),{element:function(){return e},destroy:function(){Pn(e)}}}(n),r=Tc(e.element(),"mousedown",t.forceDrop),o=Tc(e.element(),"mouseup",t.drop),i=Tc(e.element(),"mousemove",t.move),u=Tc(e.element(),"mouseout",t.delayDrop);return wc.sink({element:e.element,start:function(t){Nn(t,e.element())},stop:function(){Pn(e.element())},destroy:function(){e.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,n){t.mutate(n.left(),n.top())}});function Dc(){var t=b.none(),n=yc.create({move:bc(["info"])});return{onEvent:function(e,r){r.extract(e).each(function(e){(function(n,e){var r=t.map(function(t){return n.compare(t,e)});return t=b.some(e),r})(r,e).each(function(t){n.trigger.move(t)})})},reset:function(){t=b.none()},events:n.registry}}function Ac(){var t={onEvent:function(t,n){},reset:e},n=Dc(),r=t;return{on:function(){r.reset(),r=n},off:function(){r.reset(),r=t},isOn:function(){return r===n},onEvent:function(t,n){r.onEvent(t,n)},events:n.events}}var Rc=function(n,e,r){var o,i,u,a=!1,c=yc.create({start:bc([]),stop:bc([])}),s=Ac(),l=function(){m.stop(),s.isOn()&&(s.off(),c.trigger.stop())},f=(o=l,i=200,u=null,{cancel:function(){null!==u&&(t.clearTimeout(u),u=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==u&&t.clearTimeout(u),u=t.setTimeout(function(){o.apply(null,n),u=null},i)}});s.events.move.bind(function(t){e.mutate(n,t.info())});var d=function(t){return function(){var n=Array.prototype.slice.call(arguments,0);if(a)return t.apply(null,n)}},m=e.sink(wc.api({forceDrop:l,drop:d(l),move:d(function(t,n){f.cancel(),s.onEvent(t,e)}),delayDrop:d(f.throttle)}),r);return{element:m.element,go:function(t){m.start(t),s.on(),c.trigger.start()},on:function(){a=!0},off:function(){a=!1},destroy:function(){m.destroy()},events:c.registry}},Bc={transform:function(t,n){var e=void 0!==n?n:{},r=void 0!==e.mode?e.mode:Ec;return Rc(t,r,n)}},Nc=function(t,n,e){return ee(t,n,e).isSome()};function _c(){var t=yc.create({drag:bc(["xDelta","yDelta","target"])}),n=b.none(),e=function(){var t=yc.create({drag:bc(["xDelta","yDelta"])});return{mutate:function(n,e){t.trigger.drag(n,e)},events:t.registry}}();return e.events.drag.bind(function(e){n.each(function(n){t.trigger.drag(e.xDelta(),e.yDelta(),n)})}),{assign:function(t){n=b.some(t)},get:function(){return n},mutate:e.mutate,events:t.registry}}var Ic=Jo.resolve("resizer-bar-dragging");function Mc(t,n){var e=Co.height,r=function(t,n,e){var r=_c(),o=Bc.transform(r,{}),i=b.none(),a=function(t,n){return b.from(yt(t,n))};r.events.drag.bind(function(t){a(t.target(),"data-row").each(function(n){var e=uu.getInt(t.target(),"top");Mt(t.target(),"top",e+t.yDelta()+"px")}),a(t.target(),"data-column").each(function(n){var e=uu.getInt(t.target(),"left");Mt(t.target(),"left",e+t.xDelta()+"px")})});var c=function(t,n){return uu.getInt(t,n)-parseInt(yt(t,"data-initial-"+n),10)};o.events.stop.bind(function(){r.get().each(function(r){i.each(function(o){a(r,"data-row").each(function(t){var n=c(r,"top");xt(r,"data-initial-top"),m.trigger.adjustHeight(o,n,parseInt(t,10))}),a(r,"data-column").each(function(t){var n=c(r,"left");xt(r,"data-initial-left"),m.trigger.adjustWidth(o,n,parseInt(t,10))}),ai.refresh(t,o,e,n)})})});var s=function(n,e){m.trigger.startAdjust(),r.assign(n),vt(n,"data-initial-"+e,parseInt(Pt(n,e),10)),Vo(n,Ic),Mt(n,"opacity","0.2"),o.go(t.parent())},l=Tc(t.parent(),"mousedown",function(t){ai.isRowBar(t.target())&&s(t.target(),"top"),ai.isColBar(t.target())&&s(t.target(),"left")}),f=function(n){return yn(n,t.view())},d=Tc(t.view(),"mouseover",function(r){"table"===st(r.target())||Nc(r.target(),"table",f)?(i="table"===st(r.target())?b.some(r.target()):Qn(r.target(),"table",f)).each(function(r){ai.refresh(t,r,e,n)}):Rt(r.target())&&ai.destroy(t)}),m=yc.create({adjustHeight:bc(["table","delta","row"]),adjustWidth:bc(["table","delta","column"]),startAdjust:bc([])});return{destroy:function(){l.unbind(),d.unbind(),o.destroy(),ai.destroy(t)},refresh:function(r){ai.refresh(t,r,e,n)},on:o.on,off:o.off,hideBars:u(ai.hide,t),showBars:u(ai.show,t),events:m.registry}}(t,n,e),o=yc.create({beforeResize:bc(["table"]),afterResize:bc(["table"]),startDrag:bc([])});return r.events.adjustHeight.bind(function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta());Cu.adjustHeight(t.table(),n,t.row(),e),o.trigger.afterResize(t.table())}),r.events.startAdjust.bind(function(t){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());Cu.adjustWidth(t.table(),e,t.column(),n),o.trigger.afterResize(t.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}var Fc=function(t,n){return t.inline?vc(ta(t),function(){var t=At.fromTag("div");return Ft(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Nn(Bt(),t),t}()):hc(At.fromDom(t.getDoc()))},Pc=function(t,n){t.inline&&Pn(n.parent())},Lc=function(t){var n,e,r=b.none(),o=b.none(),i=b.none(),u=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName};return t.on("init",function(){var n=ko(ca.directionAt),e=Fc(t);if(i=b.some(e),function(t){var n=t.getParam("object_resizing",!0);return x(n)?"table"===n:n}(t)&&function(t){return t.getParam("table_resize_bars",!0,"boolean")}(t)){var u=Mc(e,n);u.on(),u.events.startDrag.bind(function(n){r=b.some(t.selection.getRng())}),u.events.beforeResize.bind(function(n){var e=n.table().dom();Sa(t,e,na(e),ea(e))}),u.events.afterResize.bind(function(n){var e=n.table(),o=e.dom();ia(e),r.each(function(n){t.selection.setRng(n),t.focus()}),Ca(t,o,na(o),ea(o)),t.undoManager.add()}),o=b.some(u)}}),t.on("ObjectResizeStart",function(r){var o,i=r.target;a(i)&&(n=r.width,o=i,e=t.dom.getStyle(o,"width")||t.dom.getAttrib(o,"width"))}),t.on("ObjectResized",function(r){var o=r.target;if(a(o)){var i=o;if(u.test(e)){var c=parseFloat(u.exec(e)[1]),s=r.width*c/n;t.dom.setStyle(i,"width",s+"%")}else{var l=[];Ta.each(i.rows,function(n){Ta.each(n.cells,function(n){var e=t.dom.getStyle(n,"width",!0);l.push({cell:n,width:e})})}),Ta.each(l,function(n){t.dom.setStyle(n.cell,"width",n.width),t.dom.setAttrib(n.cell,"width",null)})}}}),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(hc(At.fromDom(t.getBody())))},destroy:function(){o.each(function(t){t.destroy()}),i.each(function(n){Pc(t,n)})}}},Hc=function(t){return{fold:t}},Vc=function(t){return Hc(function(n,e,r,o){return n(t)})},zc=function(t){return Hc(function(n,e,r,o){return e(t)})},jc=function(t,n){return Hc(function(e,r,o,i){return o(t,n)})},Uc=function(t){return Hc(function(n,e,r,o){return o(t)})},Wc=function(t,n){return le.table(t,n).bind(function(n){var e=le.cells(n);return F(e,function(n){return yn(t,n)}).map(function(t){return{index:o(t),all:o(e)}})})},Gc=function(t,n){return Wc(t,n).fold(function(){return Vc(t)},function(n){return n.index()+1<n.all().length?jc(t,n.all()[n.index()+1]):Uc(t)})},qc=function(t,n){return Wc(t,n).fold(function(){return Vc()},function(n){return n.index()-1>=0?jc(t,n.all()[n.index()-1]):zc(t)})},$c=Ar([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Xc={before:$c.before,on:$c.on,after:$c.after,cata:function(t,n,e,r){return t.fold(n,e,r)},getStart:function(t){return t.fold(i,i,i)}},Yc=Ar([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Kc=Z("start","soffset","finish","foffset"),Jc=function(t){var n,e=function(t){return t.match({domRange:function(t){return At.fromDom(t.startContainer)},relative:function(t,n){return Xc.getStart(t)},exact:function(t,n,e,r){return t}})}(t);return n=e.dom().ownerDocument.defaultView,At.fromDom(n)},Zc=Yc.relative,Qc=Yc.exact,ts=function(t,n,e,r){var o=function(t,n,e,r){var o=Sn(t).dom().createRange();return o.setStart(t.dom(),n),o.setEnd(e.dom(),r),o}(t,n,e,r),i=yn(t,e)&&n===r;return o.collapsed&&!i},ns=function(t,n){t.selectNodeContents(n.dom())},es=function(t,n,e){var r,o=t.document.createRange();return r=o,n.fold(function(t){r.setStartBefore(t.dom())},function(t,n){r.setStart(t.dom(),n)},function(t){r.setStartAfter(t.dom())}),function(t,n){n.fold(function(n){t.setEndBefore(n.dom())},function(n,e){t.setEnd(n.dom(),e)},function(n){t.setEndAfter(n.dom())})}(o,e),o},rs=function(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},os=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},is=Ar([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),us=function(t,n,e){return n(At.fromDom(e.startContainer),e.startOffset,At.fromDom(e.endContainer),e.endOffset)},as=function(t,n){return function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return is.rtl(At.fromDom(t.endContainer),t.endOffset,At.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return us(0,is.ltr,e)}):us(0,is.ltr,e)}(0,function(t,n){return n.match({domRange:function(t){return{ltr:o(t),rtl:b.none}},relative:function(n,e){return{ltr:Et(function(){return es(t,n,e)}),rtl:Et(function(){return b.some(es(t,e,n))})}},exact:function(n,e,r,o){return{ltr:Et(function(){return rs(t,n,e,r,o)}),rtl:Et(function(){return b.some(rs(t,r,o,n,e))})}}})}(t,n))},cs=function(t,n){return as(t,n).match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}})},ss=function(t,n,e){return n>=t.left&&n<=t.right&&e>=t.top&&e<=t.bottom},ls=function(t,n,e,r,o){var i=function(e){var r=t.dom().createRange();return r.setStart(n.dom(),e),r.collapse(!0),r},u=we(n).length,a=function(t,n,e,r,o){if(0===o)return 0;if(n===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(n-a.left);if(e<=a.bottom){if(e<a.top||c>i)return u-1;i=c}}return 0}(function(t){return i(t).getBoundingClientRect()},e,r,o.right,u);return i(a)},fs=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getClientRects();return Bo(i,function(t){return ss(t,e,r)?b.some(t):b.none()}).map(function(o){return ls(t,n,e,r,o)})},ds=function(t,n,e,r){var o=t.dom().createRange(),i=En(n);return Bo(i,function(n){return o.selectNode(n.dom()),ss(o.getBoundingClientRect(),e,r)?ms(t,n,e,r):b.none()})},ms=function(t,n,e,r){return(gt(n)?fs:ds)(t,n,e,r)},gs=function(t,n){return n-t.left<t.right-n},ps=function(t,n,e){var r=t.dom().createRange();return r.selectNode(n.dom()),r.collapse(e),r},hs=function(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=r.getBoundingClientRect(),i=gs(o,e);return(!0===i?Te:Ee)(n).map(function(n){return ps(t,n,i)})},vs=function(t,n,e){var r=n.dom().getBoundingClientRect(),o=gs(r,e);return b.some(ps(t,n,o))},bs=function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect();return function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),a=Math.max(i.top,Math.min(i.bottom,r));return ms(t,n,u,a)}(t,n,Math.max(i.left,Math.min(i.right,e)),Math.max(i.top,Math.min(i.bottom,r)))},ys=document.caretPositionFromPoint?function(t,n,e){return b.from(t.dom().caretPositionFromPoint(n,e)).bind(function(n){if(null===n.offsetNode)return b.none();var e=t.dom().createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),b.some(e)})}:document.caretRangeFromPoint?function(t,n,e){return b.from(t.dom().caretRangeFromPoint(n,e))}:function(t,n,e){return At.fromPoint(t,n,e).bind(function(r){var o=function(){return function(t,n,e){return(0===En(n).length?vs:hs)(t,n,e)}(t,r,n)};return 0===En(r).length?o():bs(t,r,n,e).orThunk(o)})},ws=function(t,n){var e=st(t);return"input"===e?Xc.after(t):E(["br","img"],e)?0===n?Xc.before(t):Xc.after(t):Xc.on(t,n)},xs=function(t,n){var e=t.fold(Xc.before,ws,Xc.after),r=n.fold(Xc.before,ws,Xc.after);return Zc(e,r)},Ss=function(t,n,e,r){var o=ws(t,n),i=ws(e,r);return Zc(o,i)},Cs=function(t,n){b.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(n)})},Os=function(t,n,e,r,o){var i=rs(t,n,e,r,o);Cs(t,i)},ks=function(t,n){return as(t,n).match({ltr:function(n,e,r,o){Os(t,n,e,r,o)},rtl:function(n,e,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(n.dom(),e,r.dom(),o);else if(i.extend)try{!function(t,n,e,r,o,i){n.collapse(e.dom(),r),n.extend(o.dom(),i)}(0,i,n,e,r,o)}catch(i){Os(t,r,o,n,e)}else Os(t,r,o,n,e)}})},Ts=function(t,n,e,r,o){var i=Ss(n,e,r,o);ks(t,i)},Es=function(t,n,e){var r=xs(n,e);ks(t,r)},Ds=function(t){var n=Jc(t).dom(),e=function(t,e,r,o){return rs(n,t,e,r,o)},r=function(t){return t.match({domRange:function(t){var n=At.fromDom(t.startContainer),e=At.fromDom(t.endContainer);return Ss(n,t.startOffset,e,t.endOffset)},relative:xs,exact:Ss})}(t);return as(n,r).match({ltr:e,rtl:e})},As=function(t){var n=At.fromDom(t.anchorNode),e=At.fromDom(t.focusNode);return ts(n,t.anchorOffset,e,t.focusOffset)?b.some(Kc(n,t.anchorOffset,e,t.focusOffset)):function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return b.some(Kc(At.fromDom(n.startContainer),n.startOffset,At.fromDom(e.endContainer),e.endOffset))}return b.none()}(t)},Rs=function(t,n){var e=function(t,n){var e=t.document.createRange();return ns(e,n),e}(t,n);Cs(t,e)},Bs=function(t){return function(t){return b.from(t.getSelection()).filter(function(t){return t.rangeCount>0}).bind(As)}(t).map(function(t){return Qc(t.start(),t.soffset(),t.finish(),t.foffset())})},Ns=function(t,n){return function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?b.some(e).map(os):b.none()}(cs(t,n))},_s=function(t,n,e){return function(t,n,e){var r=At.fromDom(t.document);return ys(r,n,e).map(function(t){return Kc(At.fromDom(t.startContainer),t.startOffset,At.fromDom(t.endContainer),t.endOffset)})}(t,n,e)},Is=function(t){t.getSelection().removeAllRanges()},Ms=tinymce.util.Tools.resolve("tinymce.util.VK"),Fs=function(t,n,e,r){return Hs(t,n,Gc(e),r)},Ps=function(t,n,e,r){return Hs(t,n,qc(e),r)},Ls=function(t,n){var e=Qc(n,0,n,0);return Ds(e)},Hs=function(t,n,e,r,o){return e.fold(b.none,b.none,function(t,n){return Te(n).map(function(t){return Ls(0,t)})},function(e){return le.table(e,n).bind(function(n){var o=Lr.noMenu(e);return t.undoManager.transact(function(){r.insertRowsAfter(n,o)}),function(t,n){var e=Yn(n,"tr");return W(e).bind(function(t){return ne(t,"td,th").map(function(t){return Ls(0,t)})})}(0,n)})})},Vs=["table","li","dl"],zs={handle:function(t,n,e,r){if(t.keyCode===Ms.TAB){var o=ta(n),i=function(t){var n=st(t);return yn(t,o)||E(Vs,n)},u=n.selection.getRng();if(u.collapsed){var a=At.fromDom(u.startContainer);le.cell(a,i).each(function(o){t.preventDefault(),(t.shiftKey?Ps:Fs)(n,i,o,e,r).each(function(t){n.selection.setRng(t)})})}}}},js={response:Z("selection","kill")},Us=function(t){return function(n){return n===t}},Ws=Us(38),Gs=Us(40),qs={ltr:{isBackward:Us(37),isForward:Us(39)},rtl:{isBackward:Us(39),isForward:Us(37)},isUp:Ws,isDown:Gs,isNavigation:function(t){return t>=37&&t<=40}},$s={convertToRange:function(t,n){var e=cs(t,n);return{start:o(At.fromDom(e.startContainer)),soffset:o(e.startOffset),finish:o(At.fromDom(e.endContainer)),foffset:o(e.endOffset)}},makeSitus:function(t,n,e,r){return{start:o(Xc.on(t,n)),finish:o(Xc.on(e,r))}}},Xs=(mn.detect().browser.isSafari(),function(n){var e=void 0!==n?n.dom():t.document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return co(r,o)}),Ys=function(n,e,r){(void 0!==r?r.dom():t.document).defaultView.scrollBy(n,e)};function Ks(t){return{elementFromPoint:function(n,e){return At.fromPoint(At.fromDom(t.document),n,e)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(n,e,r,o){var i=Qc(n,e,r,o);return Ns(t,i).map(function(t){return X(t,l)})},getSelection:function(){return Bs(t).map(function(n){return $s.convertToRange(t,n)})},fromSitus:function(n){var e=Zc(n.start(),n.finish());return $s.convertToRange(t,e)},situsFromPoint:function(n,e){return _s(t,n,e).map(function(t){return{start:o(Xc.on(t.start(),t.soffset())),finish:o(Xc.on(t.finish(),t.foffset()))}})},clearSelection:function(){Is(t)},setSelection:function(n){Ts(t,n.start(),n.soffset(),n.finish(),n.foffset())},setRelativeSelection:function(n,e){Es(t,n,e)},selectContents:function(n){Rs(t,n)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){return Xs(At.fromDom(t.document)).top()},scrollBy:function(n,e){Ys(n,e,At.fromDom(t.document))}}}var Js=function(t,n,e,r,o){return yn(e,r)?b.none():Or.identify(e,r,n).bind(function(n){var r=n.boxes().getOr([]);return r.length>0?(o(t,r,n.start(),n.finish()),b.some(js.response(b.some($s.makeSitus(e,0,e,Ce(e))),!0))):b.none()})},Zs={sync:function(t,n,e,r,o,i,u){return yn(e,o)&&r===i?b.none():ee(e,"td,th",n).bind(function(e){return ee(o,"td,th",n).bind(function(r){return Js(t,n,e,r,u)})})},detect:Js,update:function(t,n,e,r,o){return Or.shiftSelection(r,t,n,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(t){return o.clear(e),o.selectRange(e,t.boxes(),t.start(),t.finish()),t.boxes()})}},Qs=ot(["left","top","right","bottom"],[]),tl={nu:Qs,moveUp:function(t,n){return Qs({left:t.left(),top:t.top()-n,right:t.right(),bottom:t.bottom()-n})},moveDown:function(t,n){return Qs({left:t.left(),top:t.top()+n,right:t.right(),bottom:t.bottom()+n})},moveBottomTo:function(t,n){var e=t.bottom()-t.top();return Qs({left:t.left(),top:n-e,right:t.right(),bottom:n})},moveTopTo:function(t,n){var e=t.bottom()-t.top();return Qs({left:t.left(),top:n,right:t.right(),bottom:n+e})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,n,e){return Qs({left:t.left()+n,top:t.top()+e,right:t.right()+n,bottom:t.bottom()+e})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},nl=function(t){return tl.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},el=function(t,n){return b.some(t.getRect(n))},rl=function(t,n,e){return mt(n)?el(t,n).map(nl):gt(n)?function(t,n,e){return e>=0&&e<Ce(n)?t.getRangedRect(n,e,n,e+1):e>0?t.getRangedRect(n,e-1,n,e):b.none()}(t,n,e).map(nl):b.none()},ol=function(t,n){return mt(n)?el(t,n).map(nl):gt(n)?t.getRangedRect(n,0,n,Ce(n)).map(nl):b.none()},il=Z("item","mode"),ul=function(t,n,e,r){return void 0===r&&(r=al),t.property().parent(n).map(function(t){return il(t,r)})},al=function(t,n,e,r){return void 0===r&&(r=cl),e.sibling(t,n).map(function(t){return il(t,r)})},cl=function(t,n,e,r){void 0===r&&(r=cl);var o=t.property().children(n);return e.first(o).map(function(t){return il(t,r)})},sl=[{current:ul,next:al,fallback:b.none()},{current:al,next:cl,fallback:b.some(ul)},{current:cl,next:cl,fallback:b.some(al)}],ll=function(t,n,e,r,o){return void 0===o&&(o=sl),M(o,function(t){return t.current===e}).bind(function(e){return e.current(t,n,r,e.next).orThunk(function(){return e.fallback.bind(function(e){return ll(t,n,e,r)})})})},fl=function(){return{sibling:function(t,n){return t.query().prevSibling(n)},first:function(t){return t.length>0?b.some(t[t.length-1]):b.none()}}},dl=function(){return{sibling:function(t,n){return t.query().nextSibling(n)},first:function(t){return t.length>0?b.some(t[0]):b.none()}}},ml=function(t,n,e,r,o,i){return ll(t,n,r,o).bind(function(n){return i(n.item())?b.none():e(n.item())?b.some(n.item()):ml(t,n.item(),e,n.mode(),o,i)})},gl=function(t,n,e,r){return ml(t,n,e,al,fl(),r)},pl=function(t,n,e,r){return ml(t,n,e,al,dl(),r)},hl=function(t){return function(n){return 0===t.property().children(n).length}},vl=gl,bl=pl,yl=Ve(),wl=function(t,n){return function(t,n,e){return vl(t,n,hl(t),e)}(yl,t,n)},xl=function(t,n){return function(t,n,e){return bl(t,n,hl(t),e)}(yl,t,n)},Sl=Ar([{none:[]},{retry:["caret"]}]),Cl=function(t,n,e){return(r=n,i=Vu,Kn(function(t){return i(t)},Jn,r,i,u)).fold(o(!1),function(n){return ol(t,n).exists(function(t){return function(t,n){return t.left()<n.left()||Math.abs(n.right()-t.left())<1||t.left()>n.right()}(e,t)})});var r,i,u},Ol={point:tl.getTop,adjuster:function(t,n,e,r,o){var i=tl.moveUp(o,5);return Math.abs(e.top()-r.top())<1?Sl.retry(i):e.bottom()<o.top()?Sl.retry(i):e.bottom()===o.top()?Sl.retry(tl.moveUp(o,1)):Cl(t,n,o)?Sl.retry(tl.translate(i,5,0)):Sl.none()},move:tl.moveUp,gather:wl},kl={point:tl.getBottom,adjuster:function(t,n,e,r,o){var i=tl.moveDown(o,5);return Math.abs(e.bottom()-r.bottom())<1?Sl.retry(i):e.top()>o.bottom()?Sl.retry(i):e.top()===o.bottom()?Sl.retry(tl.moveDown(o,1)):Cl(t,n,o)?Sl.retry(tl.translate(i,5,0)):Sl.none()},move:tl.moveDown,gather:xl},Tl=function(t,n,e,r,o){return 0===o?b.some(r):function(t,n,e){return t.elementFromPoint(n,e).filter(function(t){return"table"===st(t)}).isSome()}(t,r.left(),n.point(r))?function(t,n,e,r,o){return Tl(t,n,e,n.move(r,5),o)}(t,n,e,r,o-1):t.situsFromPoint(r.left(),n.point(r)).bind(function(i){return i.start().fold(b.none,function(i,u){return ol(t,i,u).bind(function(u){return n.adjuster(t,i,u,e,r).fold(b.none,function(r){return Tl(t,n,e,r,o-1)})}).orThunk(function(){return b.some(r)})},b.none)})},El=function(t,n,e){var r=t.move(e,5),o=Tl(n,t,e,r,100).getOr(r);return function(t,n,e){return t.point(n)>e.getInnerHeight()?b.some(t.point(n)-e.getInnerHeight()):t.point(n)<0?b.some(-t.point(n)):b.none()}(t,o,n).fold(function(){return n.situsFromPoint(o.left(),t.point(o))},function(e){return n.scrollBy(0,e),n.situsFromPoint(o.left(),t.point(o)-e)})},Dl={tryUp:u(El,Ol),tryDown:u(El,kl),ieTryUp:function(t,n){return t.situsFromPoint(n.left(),n.top()-5)},ieTryDown:function(t,n){return t.situsFromPoint(n.left(),n.bottom()+5)},getJumpSize:o(5)},Al=Ar([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Rl=function(t){return ee(t,"tr")},Bl={verify:function(t,n,e,r,o,i,u){return ee(r,"td,th",u).bind(function(e){return ee(n,"td,th",u).map(function(n){return yn(e,n)?yn(r,e)&&Ce(e)===o?i(n):Al.none("in same cell"):ur.sharedOne(Rl,[e,n]).fold(function(){return function(t,n,e){var r=t.getRect(n),o=t.getRect(e);return o.right>r.left&&o.left<r.right}(t,n,e)?Al.success():i(n)},function(t){return i(n)})})}).getOr(Al.none("default"))},cata:function(t,n,e,r,o){return t.fold(n,e,r,o)},adt:Al},Nl=Z("element","offset"),_l=(Z("element","deltaOffset"),Z("element","start","finish"),Z("begin","end"),Z("element","text"),Z("ancestor","descendants","element","index"),Z("parent","children","element","index")),Il=function(t,n){return F(t,u(yn,n))},Ml=function(t){return"br"===st(t)},Fl=function(t,n,e){return n(t,e).bind(function(t){return gt(t)&&0===we(t).trim().length?Fl(t,n,e):b.some(t)})},Pl=function(t,n,e,r){return function(t,n){return Dn(t,n).filter(Ml).orThunk(function(){return Dn(t,n-1).filter(Ml)})}(n,e).bind(function(n){return r.traverse(n).fold(function(){return Fl(n,r.gather,t).map(r.relative)},function(t){return function(t){return Cn(t).bind(function(n){var e=En(n);return Il(e,t).map(function(r){return _l(n,e,t,r)})})}(t).map(function(t){return Xc.on(t.parent(),t.index())})})})},Ll=function(t,n,e,r){return(Ml(n)?function(t,n,e){return e.traverse(n).orThunk(function(){return Fl(n,e.gather,t)}).map(e.relative)}(t,n,r):Pl(t,n,e,r)).map(function(t){return{start:o(t),finish:o(t)}})},Hl=function(t){return Bl.cata(t,function(t){return b.none()},function(){return b.none()},function(t){return b.some(Nl(t,0))},function(t){return b.some(Nl(t,Ce(t)))})},Vl=mn.detect(),zl=function(t,n,e,r,o,i){return 0===i?b.none():Wl(t,n,e,r,o).bind(function(u){var a=t.fromSitus(u),c=Bl.verify(t,e,r,a.finish(),a.foffset(),o.failure,n);return Bl.cata(c,function(){return b.none()},function(){return b.some(u)},function(u){return yn(e,u)&&0===r?jl(t,e,r,tl.moveUp,o):zl(t,n,u,0,o,i-1)},function(u){return yn(e,u)&&r===Ce(u)?jl(t,e,r,tl.moveDown,o):zl(t,n,u,Ce(u),o,i-1)})})},jl=function(t,n,e,r,o){return rl(t,n,e).bind(function(n){return Ul(t,o,r(n,Dl.getJumpSize()))})},Ul=function(t,n,e){return Vl.browser.isChrome()||Vl.browser.isSafari()||Vl.browser.isFirefox()||Vl.browser.isEdge()?n.otherRetry(t,e):Vl.browser.isIE()?n.ieRetry(t,e):b.none()},Wl=function(t,n,e,r,o){return rl(t,e,r).bind(function(n){return Ul(t,o,n)})},Gl=function(t,n,e){return function(t,n,e){return t.getSelection().bind(function(r){return Ll(n,r.finish(),r.foffset(),e).fold(function(){return b.some(Nl(r.finish(),r.foffset()))},function(o){var i=t.fromSitus(o),u=Bl.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),e.failure,n);return Hl(u)})})}(t,n,e).bind(function(r){return zl(t,n,r.element(),r.offset(),e,20).map(t.fromSitus)})},ql=mn.detect(),$l=function(t,n){return Jn(t,function(t){return Cn(t).exists(function(t){return yn(t,n)})},e).isSome();var e},Xl=function(t,n,e,r,i){return ee(r,"td,th",n).bind(function(r){return ee(r,"table",n).bind(function(u){return $l(i,u)?Gl(t,n,e).bind(function(t){return ee(t.finish(),"td,th",n).map(function(n){return{start:o(r),finish:o(n),range:o(t)}})}):b.none()})})},Yl=function(t,n,e,r,o,i){return ql.browser.isIE()?b.none():i(r,n).orThunk(function(){return Xl(t,n,e,r,o).map(function(t){var n=t.range();return js.response(b.some($s.makeSitus(n.start(),n.soffset(),n.finish(),n.foffset())),!0)})})},Kl=function(t,n,e,r,o,i,u){return Xl(t,e,r,o,i).bind(function(t){return Zs.detect(n,e,t.start(),t.finish(),u)})},Jl=function(t,n){return ee(t,"tr",n).bind(function(t){return ee(t,"table",n).bind(function(e){var r=Yn(e,"tr");return yn(t,r[0])?function(t,n,e){return vl(yl,t,n,e)}(e,function(t){return Ee(t).isSome()},n).map(function(t){var n=Ce(t);return js.response(b.some($s.makeSitus(t,n,t,n)),!0)}):b.none()})})},Zl=function(t,n){return ee(t,"tr",n).bind(function(t){return ee(t,"table",n).bind(function(e){var r=Yn(e,"tr");return yn(t,r[r.length-1])?function(t,n,e){return bl(yl,t,n,e)}(e,function(t){return Te(t).isSome()},n).map(function(t){return js.response(b.some($s.makeSitus(t,0,t,0)),!0)}):b.none()})})},Ql=function(t,n){return ee(t,"td,th",n)},tf={down:{traverse:Tn,gather:xl,relative:Xc.before,otherRetry:Dl.tryDown,ieRetry:Dl.ieTryDown,failure:Bl.adt.failedDown},up:{traverse:kn,gather:wl,relative:Xc.before,otherRetry:Dl.tryUp,ieRetry:Dl.ieTryUp,failure:Bl.adt.failedUp}},nf=Z("rows","cols"),ef={mouse:function(t,n,e,r){var o=function(t,n,e,r){var o=b.none(),i=function(){o=b.none()};return{mousedown:function(t){r.clear(n),o=Ql(t.target(),e)},mouseover:function(i){o.each(function(o){r.clear(n),Ql(i.target(),e).each(function(i){Or.identify(o,i,e).each(function(e){var u=e.boxes().getOr([]);(u.length>1||1===u.length&&!yn(o,i))&&(r.selectRange(n,u,e.start(),e.finish()),t.selectContents(i))})})})},mouseup:function(){o.each(i)}}}(Ks(t),n,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}},keyboard:function(t,n,e,r){var o=Ks(t),i=function(){return r.clear(n),b.none()};return{keydown:function(t,a,c,s,l,f){var d=t.raw().which,m=!0===t.raw().shiftKey;return Or.retrieve(n,r.selectedSelector()).fold(function(){return qs.isDown(d)&&m?u(Kl,o,n,e,tf.down,s,a,r.selectRange):qs.isUp(d)&&m?u(Kl,o,n,e,tf.up,s,a,r.selectRange):qs.isDown(d)?u(Yl,o,e,tf.down,s,a,Zl):qs.isUp(d)?u(Yl,o,e,tf.up,s,a,Jl):b.none},function(t){var e=function(e){return function(){return Bo(e,function(e){return Zs.update(e.rows(),e.cols(),n,t,r)}).fold(function(){return Or.getEdges(n,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(t){var e=qs.isDown(d)||f.isForward(d)?Xc.after:Xc.before;return o.setRelativeSelection(Xc.on(t.first(),0),e(t.table())),r.clear(n),js.response(b.none(),!0)})},function(t){return b.some(js.response(b.none(),!0))})}};return qs.isDown(d)&&m?e([nf(1,0)]):qs.isUp(d)&&m?e([nf(-1,0)]):f.isBackward(d)&&m?e([nf(0,-1),nf(-1,0)]):f.isForward(d)&&m?e([nf(0,1),nf(1,0)]):qs.isNavigation(d)&&!1===m?i:b.none})()},keyup:function(t,o,i,u,a){return Or.retrieve(n,r.selectedSelector()).fold(function(){var c=t.raw().which;return 0==(!0===t.raw().shiftKey)?b.none():qs.isNavigation(c)?Zs.sync(n,e,o,i,u,a,r.selectRange):b.none()},b.none)}}}},rf=function(t){return function(n){!function(t,n){R(n,function(n){zo(t,n)})}(n,t)}},of={byClass:function(t){var n,e=(n=t.selected(),function(t){Vo(t,n)}),r=rf([t.selected(),t.lastSelected(),t.firstSelected()]),o=function(n){var e=Yn(n,t.selectedSelector());R(e,r)};return{clear:o,selectRange:function(n,r,i,u){o(n),R(r,e),Vo(i,t.firstSelected()),Vo(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t){var n=function(n){xt(n,t.selected()),xt(n,t.firstSelected()),xt(n,t.lastSelected())},e=function(n){vt(n,t.selected(),"1")},r=function(e){var r=Yn(e,t.selectedSelector());R(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),R(o,e),vt(i,t.firstSelected(),"1"),vt(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}},uf=function(t){return!1===jo(At.fromDom(t.target),"ephox-snooker-resizer-bar")},af=function(t){return{get:function(){var n=ta(t);return kr(n,Dr.selectedSelector()).fold(function(){return void 0===t.selection.getStart()?Br.none():Br.single(t.selection)},function(t){return Br.multiple(t)})}}},cf=function(t,e){var r=n(b.none()),o=n([]),i=function(){return mc(t).bind(function(t){return le.table(t).map(function(n){return"caption"===st(t)?Lr.notCell(t):Lr.forMenu(e,n,t)})})},u=function(){r.set(Et(i)()),R(o.get(),function(t){return t()})},a=function(t,n){var e=function(){return r.get().fold(function(){t.setDisabled(!0)},function(e){t.setDisabled(n(e))})};return e(),o.set(o.get().concat([e])),function(){o.set(N(o.get(),function(t){return t!==e}))}};return t.on("NodeChange",u),{onSetupTable:function(t){return a(t,function(t){return!1})},onSetupCellOrRow:function(t){return a(t,function(t){return"caption"===st(t.element())})},onSetupMergeable:function(t){return a(t,function(t){return t.mergable().isNone()})},onSetupUnmergeable:function(t){return a(t,function(t){return t.unmergable().isNone()})},resetTargets:u,targets:function(){return r.get()}}},sf={addButtons:function(t,n){t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable tableprops deletetable | cell row column")}});var e=function(n){return function(){return t.execCommand(n)}};t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:e("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:e("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:e("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:e("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:e("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:e("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:e("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:e("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:e("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:e("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:e("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:e("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:e("mceTableCutRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:e("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:e("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:e("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow})},addToolbars:function(t){var n=function(t){return t.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(t);n.length>0&&t.ui.registry.addContextToolbar("table",{predicate:function(n){return t.dom.is(n,"table")&&t.getBody().contains(n)},items:n,scope:"node",position:"node"})}},lf={addMenuItems:function(t,n){var e=function(n){return function(){return t.execCommand(n)}},r=function(n){var e=n.numRows,r=n.numColumns;t.undoManager.transact(function(){ac(t,r,e)}),t.addVisual()},o={text:"Table properties",onSetup:n.onSetupTable,onAction:e("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:e("mceTableDelete")},u={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:e("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:e("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:e("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:e("mceTableRowProps"),onSetup:n.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:e("mceTableCutRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:e("mceTableCopyRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:e("mceTablePasteRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:e("mceTablePasteRowAfter"),onSetup:n.onSetupCellOrRow}]}},a={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:e("mceTableInsertColBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:e("mceTableInsertColAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:e("mceTableDeleteCol"),onSetup:n.onSetupCellOrRow}]}},c={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:e("mceTableCellProps"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:e("mceTableMergeCells"),onSetup:n.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:e("mceTableSplitCells"),onSetup:n.onSetupUnmergeable}]}};!1===function(t){return t.getParam("table_grid",!0,"boolean")}(t)?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:e("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",u),t.ui.registry.addNestedMenuItem("column",a),t.ui.registry.addNestedMenuItem("cell",c),t.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(function(){return""},function(t){return"caption"===st(t.element())?"tableprops deletetable":"cell row column | tableprops deletetable"})}})}},ff=function(t,n){return{insertTable:function(n,e){return ac(t,n,e)},setClipboardRows:function(t){return function(t,n){var e=A(t,At.fromDom);n.set(b.from(e))}(t,n)},getClipboardRows:function(){return function(t){return t.get().fold(function(){},function(t){return A(t,function(t){return t.dom()})})}(n)}}};y.add("table",function(t){var i=Lc(t),u=function(t,n){var i=ot(["mousedown","mouseover","mouseup","keyup","keydown"],[]),u=b.none(),a=of.byAttr(Dr);return t.on("init",function(c){var s=t.getWin(),l=ta(t),f=ra(t),d=ef.mouse(s,l,f,a),m=ef.keyboard(s,l,f,a),g=function(n,e){(function(t){return!0===t.raw().shiftKey})(n)&&(e.kill()&&n.kill(),e.selection().each(function(n){var e=Zc(n.start(),n.finish()),r=cs(s,e);t.selection.setRng(r)}))},p=function(n){var e=y(n);if(e.raw().shiftKey&&qs.isNavigation(e.raw().which)){var r=t.selection.getRng(),o=At.fromDom(r.startContainer),i=At.fromDom(r.endContainer);m.keyup(e,o,r.startOffset,i,r.endOffset).each(function(t){g(e,t)})}},h=function(e){var r=y(e);n().each(function(t){t.hideBars()});var o=t.selection.getRng(),i=At.fromDom(t.selection.getStart()),u=At.fromDom(o.startContainer),a=At.fromDom(o.endContainer),c=ca.directionAt(i).isRtl()?qs.rtl:qs.ltr;m.keydown(r,u,o.startOffset,a,o.endOffset,c).each(function(t){g(r,t)}),n().each(function(t){t.showBars()})},v=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},y=function(t){var n=At.fromDom(t.target),e=function(){t.stopPropagation()},i=function(){t.preventDefault()},u=r(i,e);return{target:o(n),x:o(v(t)?t.x:null),y:o(v(t)?t.y:null),stop:e,prevent:i,kill:u,raw:o(t)}},w=function(t){return 0===t.button},x=function(t){w(t)&&uf(t)&&d.mousedown(y(t))},S=function(t){var n;void 0!==(n=t).buttons&&0==(1&n.buttons)||!uf(t)||d.mouseover(y(t))},C=function(t){w(t)&&uf(t)&&d.mouseup(y(t))};t.on("mousedown",x),t.on("mouseover",S),t.on("mouseup",C),t.on("keyup",p),t.on("keydown",h),t.on("NodeChange",function(){var n=t.selection,r=At.fromDom(n.getStart()),o=At.fromDom(n.getEnd());ur.sharedOne(le.table,[r,o]).fold(function(){a.clear(l)},e)}),u=b.some(i({mousedown:x,mouseover:S,mouseup:C,keyup:p,keydown:h}))}),{clear:a.clear,destroy:function(){u.each(function(t){})}}}(t,i.lazyResize),a=Oa(t,i.lazyWire),c=af(t),s=cf(t,c),l=n(b.none());return pc.registerCommands(t,a,u,c,l),Hr.registerEvents(t,c,a,u),lf.addMenuItems(t,s),sf.addButtons(t,s),sf.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(Dr.firstSelected()),t.serializer.addTempAttr(Dr.lastSelected())}),ma(t)&&t.on("keydown",function(n){zs.handle(n,t,a,i.lazyWire)}),t.on("remove",function(){i.destroy(),u.destroy()}),ff(t,l)})}(window)},ba2e:function(t,n,e){"use strict";var r=e("03e2");e.n(r).a},be7f:function(t,n){!function(t){"use strict";var n,e,r,o,i,u=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=tinymce.util.Tools.resolve("tinymce.util.VK"),c=function(t){return t.target_list},s=function(t){return t.rel_list},l=function(t){return t.link_class_list},f=function(t){return"boolean"==typeof t.link_assume_external_targets&&t.link_assume_external_targets},d=function(t){return"boolean"==typeof t.link_context_toolbar&&t.link_context_toolbar},m=function(t){return t.link_list},g=function(t){return"string"==typeof t.default_link_target},p=function(t){return t.default_link_target},h=c,v=function(t){return!1!==c(t)},b=s,y=function(t){return void 0!==s(t)},w=l,x=function(t){return void 0!==l(t)},S=function(t){return!1!==t.link_title},C=function(t){return"boolean"==typeof t.allow_unsafe_link_target&&t.allow_unsafe_link_target},O=function(t){return!0===t.link_quicklink},k=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),T=tinymce.util.Tools.resolve("tinymce.Env"),E=function(n){if(!T.ie||T.ie>10){var e=t.document.createElement("a");e.target="_blank",e.href=n,e.rel="noreferrer noopener";var r=t.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,t.window,0,0,0,0,0,!1,!1,!1,!1,0,null),function(n,e){t.document.body.appendChild(n),n.dispatchEvent(e),t.document.body.removeChild(n)}(e,r)}else{var o=t.window.open("","_blank");if(o){o.opener=null;var i=o.document;i.open(),i.write('<meta http-equiv="refresh" content="0; url='+k.DOM.encode(n)+'">'),i.close()}}},D=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},A=function(t){return function(){return t}},R=A(!1),B=A(!0),N=R,_=B,I=function(){return M},M=(o={fold:function(t,n){return t()},is:N,isSome:N,isNone:_,getOr:r=function(t){return t},getOrThunk:e=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:r,orThunk:e,map:I,ap:I,each:function(){},bind:I,flatten:I,exists:N,forall:_,filter:I,equals:n=function(t){return t.isNone()},equals_:n,toArray:function(){return[]},toString:A("none()")},Object.freeze&&Object.freeze(o),o),F=function(t){var n=function(){return t},e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:_,isNone:N,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return F(n(t))},ap:function(n){return n.fold(I,function(n){return F(n(t))})},each:function(n){n(t)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(t)?o:M},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(N,function(n){return e(t,n)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},P={some:F,none:I,from:function(t){return null==t?M:F(t)}},L=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(n)===t}},H=L("string"),V=L("function"),z=void 0===(i=Array.prototype.indexOf)?function(t,n){return U(t,n)}:function(t,n){return i.call(t,n)},j=function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e,t)},U=function(t,n){for(var e=0,r=t.length;e<r;++e)if(t[e]===n)return e;return-1},W=Array.prototype.push,G=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!Array.prototype.isPrototypeOf(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);W.apply(n,t[e])}return n},q=function(t,n){var e=function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o,t)}return r}(t,n);return G(e)},$=(Array.prototype.slice,V(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Tools")),X=function(t,n){var e=["noopener"],r=t?t.split(/\s+/):[],o=function(t){return t.filter(function(t){return-1===$.inArray(e,t)})},i=n?function(t){return(t=o(t)).length>0?t.concat(e):e}(r):o(r);return i.length>0?function(t){return $.trim(t.sort().join(" "))}(i):""},Y=function(t,n){return n=n||t.selection.getNode(),J(n)?t.dom.select("a[href]",n)[0]:t.dom.getParent(n,"a[href]")},K=function(t){return t&&"A"===t.nodeName&&!!t.href},J=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},Z=function(t){return n=["title","rel","class","target"],e=function(n,e){return t[e].each(function(t){n[e]=t.length>0?t:null}),n},r={href:t.href},j(n,function(t){r=e(r,t)}),r;var n,e,r},Q=function(t,n){var e=t.dom.select("img",n)[0];if(e){var r=t.dom.getParents(e,"a[href]",n)[0];r&&(r.parentNode.insertBefore(e,r),t.dom.remove(r))}},tt=function(t,n,e){var r=t.dom.select("img",n)[0];if(r){var o=t.dom.create("a",e);r.parentNode.insertBefore(o,r),o.appendChild(r)}},nt=function(t,n,e){t.undoManager.transact(function(){var r=t.selection.getNode(),o=Y(t,r),i=Z(e);if(!y(t.settings)&&!1===C(t.settings)){var u=X(i.rel,"_blank"===i.target);i.rel=u||null}e.href===n.href&&n.attach(),o?(t.focus(),function(t,n,e,r){e.each(function(t){n.hasOwnProperty("innerText")?n.innerText=t:n.textContent=t}),t.dom.setAttribs(n,r),t.selection.select(n)}(t,o,e.text,i)):function(t,n,e,r){J(n)?tt(t,n,r):e.fold(function(){t.execCommand("mceInsertLink",!1,r)},function(n){t.insertContent(t.dom.createHTML("a",r,t.dom.encode(n)))})}(t,r,e.text,i)})},et=function(t){t.undoManager.transact(function(){var n=t.selection.getNode();if(J(n))Q(t,n);else{var e=t.dom.getParent(n,"a[href]",t.getBody());e&&t.dom.remove(e,!0)}t.focus()})},rt=function(t){return $.grep(t,K).length>0},ot=function(t){var n=t.getAttribute("data-mce-href");return n||t.getAttribute("href")},it=function(t){return!(/</.test(t)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(t)||-1===t.indexOf("href=")))},ut=Y,at=function(t,n){return function(t){return t.replace(/\uFEFF/g,"")}(n?n.innerText||n.textContent:t.getContent({format:"text"}))},ct=X,st=function(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n},lt=function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return P.none()},ft=function(t){return H(t.value)?t.value:""},dt=function(t){return void 0===t&&(t=ft),function(n){return P.from(n).map(function(n){return function(t,n){var e=[];return $.each(t,function(t){var r=H(t.text)?t.text:H(t.title)?t.title:"";if(void 0!==t.menu);else{var o=n(t);e.push({text:r,value:o})}}),e}(n,t)})}},mt={sanitize:function(t){return dt(ft)(t)},sanitizeWith:dt,createUi:function(t,n){return function(e){return{name:t,type:"selectbox",label:n,items:e}}},getValue:ft},gt=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return gt(e())}}},pt=function(t,n,e,r){var o=r[n],i=t.length>0;return void 0!==o?function(t,n){return lt(n,function(n){return P.some(n).filter(function(n){return n.value===t})})}(o,e).map(function(n){return{url:{value:n.value,meta:{text:i?t:n.text,attach:D}},text:i?t:n.text}}):P.none()},ht=function(t,n){var e=gt(t.text),r=function(t,r){var o,i,u=(o=n,i=r.name,"link"===i?o.catalogs.link:"anchor"===i?o.catalogs.anchor:P.none()).getOr([]);return pt(e.get(),r.name,u,t)};return{onChange:function(t,n){return"url"===n.name?function(t){if(e.get().length<=0){var n=void 0!==t.url.meta.text?t.url.meta.text:t.url.value;return P.some({text:n})}return P.none()}(t()):(o=["anchor","link"],i=n.name,z(o,i)>-1?r(t(),n):"text"===n.name?(e.set(t().text),P.none()):P.none());var o,i}}},vt=function(){return(vt=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},bt=function(n){var e=P.none(),r=[],o=function(t){i()?a(t):r.push(t)},i=function(){return e.isSome()},u=function(t){j(t,a)},a=function(n){e.each(function(e){t.setTimeout(function(){n(e)},0)})};return n(function(t){e=P.some(t),u(r),r=[]}),{get:o,map:function(t){return bt(function(n){o(function(e){n(t(e))})})},isReady:i}},yt={nu:bt,pure:function(t){return bt(function(n){n(t)})}},wt=function(n){var e=function(e){var r;n((r=e,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var o=this;t.setTimeout(function(){r.apply(o,n)},0)}))},r=function(){return yt.nu(e)};return{map:function(t){return wt(function(n){e(function(e){var r=t(e);n(r)})})},bind:function(t){return wt(function(n){e(function(e){t(e).get(n)})})},anonBind:function(t){return wt(function(n){e(function(e){t.get(n)})})},toLazy:r,toCached:function(){var t=null;return wt(function(n){null===t&&(t=r()),t.get(n)})},get:e}},xt={nu:wt,pure:function(t){return wt(function(n){n(t)})}},St=tinymce.util.Tools.resolve("tinymce.util.Delay"),Ct=function(t){var n=t.href;return n.indexOf("@")>0&&-1===n.indexOf("//")&&-1===n.indexOf("mailto:")?P.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return vt({},t,{href:"mailto:"+n})}}):P.none()},Ot=function(t){return function(n){var e=n.href;return!0===t&&!/^\w+:/i.test(e)||!1===t&&/^\s*www[\.|\d\.]/i.test(e)?P.some({message:"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",preprocess:function(t){return vt({},t,{href:"http://"+e})}}):P.none()}},kt=function(n,e,r){return lt([Ct,Ot(e)],function(t){return t(r)}).fold(function(){return xt.pure(r)},function(e){return xt.nu(function(o){!function(t,n,e){var r=t.selection.getRng();St.setEditorTimeout(t,function(){t.windowManager.confirm(n,function(n){t.selection.setRng(r),e(n)})})}(n,e.message,function(n){t.console.log("state",n),o(n?e.preprocess(r):r)})})})},Tt=function(t){var n=t.dom.select("a:not([href])"),e=q(n,function(t){var n=t.name||t.id;return n?[{text:n,value:"#"+n}]:[]});return e.length>0?P.some([{text:"None",value:""}].concat(e)):P.none()},Et=function(t){if(x(t.settings)){var n=w(t.settings);return mt.sanitize(n)}return P.none()},Dt=tinymce.util.Tools.resolve("tinymce.util.XHR"),At=function(t){var n=function(n){return t.convertURL(n.value||n.url,"href")},e=m(t.settings);return xt.nu(function(t){"string"==typeof e?Dt.send({url:e,success:function(n){return t(function(t){try{return P.some(JSON.parse(t))}catch(t){return P.none()}}(n))},error:function(n){return t(P.none())}}):"function"==typeof e?e(function(n){return t(P.some(n))}):t(P.from(e))}).map(function(t){return t.bind(mt.sanitizeWith(n))})},Rt=function(t,n){if(y(t.settings)){var e=b(t.settings),r=n.is("_blank");return(!1===C(t.settings)?mt.sanitizeWith(function(t){return ct(mt.getValue(t),r)}):mt.sanitize)(e)}return P.none()},Bt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],Nt=function(t){if(v(t.settings)){var n=h(t.settings);return mt.sanitize(n).orThunk(function(){return P.some(Bt)})}return P.none()},_t=function(t,n,e){var r=t.getAttrib(n,e);return null!==r&&r.length>0?P.some(r):P.none()},It=function(t,n,e){return At(t).map(function(r){var o=function(t,n,e,r){var o=t.dom,i=it(r.getContent())?P.some(at(r,e)):P.none(),u=e?P.some(o.getAttrib(e,"href")):P.none(),a=e?P.from(o.getAttrib(e,"target")):P.none(),c=_t(o,e,"rel"),s=_t(o,e,"class");return{url:u,text:i,title:_t(o,e,"title"),target:a,rel:c,linkClass:s}}(t,0,e,t.selection);return{anchor:o,catalogs:{targets:Nt(t),rels:Rt(t,o.target),classes:Et(t),anchor:Tt(t),link:r},optNode:P.from(e),flags:{titleEnabled:S(n)}}})},Mt=function(t){(function(t){var n=t.settings,e=ut(t);return It(t,n,e)})(t).map(function(n){var e=function(t,n,e){return function(r){var o=r.getData();if(!o.url.value)return et(t),void r.close();var i=function(t){return P.from(o[t]).filter(function(e){return!n.anchor[t].is(e)})},u={href:o.url.value,text:i("text"),target:i("target"),rel:i("rel"),class:i("linkClass"),title:i("title")},a={href:o.url.value,attach:void 0!==o.url.meta&&o.url.meta.attach?o.url.meta.attach:function(){}};kt(t,e,u).get(function(n){nt(t,a,n)}),r.close()}}(t,n,f(t.settings));return function(t,n,e){var r=t.anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),o=t.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],i=function(t,n){return{url:{value:t.anchor.url.getOr(""),meta:{attach:function(){},text:t.anchor.url.fold(function(){return""},function(){return t.anchor.text.getOr("")}),original:{value:t.anchor.url.getOr("")}}},text:t.anchor.text.getOr(""),title:t.anchor.title.getOr(""),anchor:t.anchor.url.getOr(""),link:t.anchor.url.getOr(""),rel:t.anchor.rel.getOr(""),target:t.anchor.target.or(n).getOr(""),linkClass:t.anchor.linkClass.getOr("")}}(t,g(e)?P.some(p(e)):P.none()),u=ht(i,t),a=t.catalogs;return{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:G([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],r,o,st([a.anchor.map(mt.createUi("anchor","Anchors")),a.rels.map(mt.createUi("rel","Rel")),a.targets.map(mt.createUi("target","Open link in...")),a.link.map(mt.createUi("link","Link list")),a.classes.map(mt.createUi("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onChange:function(t,n){var e=n.name;u.onChange(t.getData,{name:e}).each(function(n){t.setData(n)})},onSubmit:n}}(n,e,t.settings)}).get(function(n){t.windowManager.open(n)})},Ft=function(t,n){return t.dom.getParent(n,"a[href]")},Pt=function(t){return Ft(t,t.selection.getStart())},Lt=function(t,n){if(n){var e=ot(n);if(/^#/.test(e)){var r=t.$(e);r.length&&t.selection.scrollIntoView(r[0],!0)}else E(n.href)}},Ht=function(t){return function(){Mt(t)}},Vt=function(t){return function(){Lt(t,Pt(t))}},zt=function(t){t.on("click",function(n){var e=Ft(t,n.target);e&&a.metaKeyPressed(n)&&(n.preventDefault(),Lt(t,e))}),t.on("keydown",function(n){var e=Pt(t);e&&13===n.keyCode&&function(t){return!0===t.altKey&&!1===t.shiftKey&&!1===t.ctrlKey&&!1===t.metaKey}(n)&&(n.preventDefault(),Lt(t,e))})},jt=function(t){return function(n){var e=function(e){return n.setActive(!t.readonly&&!!ut(t,e.element))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}},Ut=function(t){return function(n){n.setDisabled(!rt(t.dom.getParents(t.selection.getStart())));var e=function(t){return n.setDisabled(!rt(t.parents))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}},Wt=function(t){t.addCommand("mceLink",function(){O(t.settings)?t.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):Ht(t)()})},Gt=function(t){t.addShortcut("Meta+K","",function(){t.execCommand("mceLink")})},qt=function(t){t.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:Ht(t),onSetup:jt(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return et(t)},onSetup:Ut(t)})},$t=function(t){t.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:Vt(t),onSetup:Ut(t)}),t.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:Ht(t)}),t.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return et(t)},onSetup:Ut(t)})},Xt=function(t){t.ui.registry.addContextMenu("link",{update:function(n){return rt(t.dom.getParents(n,"a"))?"link unlink openlink":"link"}})},Yt=function(t){var n=function(n){var e=t.selection.getNode();return n.setDisabled(!ut(t,e)),function(){}};t.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:jt(t)},label:"Link",predicate:function(n){return!!ut(t,n)&&d(t.settings)},initValue:function(){var n=ut(t);return n?ot(n):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(n){var e=t.selection.getNode();return n.setActive(!!ut(t,e)),jt(t)(n)},onAction:function(n){var e=ut(t),r=n.getValue();if(e)t.dom.setAttrib(e,"href",r),function(t){t.selection.collapse(!1)}(t),n.hide();else{var o={href:r,attach:function(){}},i=it(t.selection.getContent())?P.some(at(t.selection,e)).filter(function(t){return t.length>0}).or(P.from(r)):P.none();nt(t,o,{href:r,text:i,title:P.none(),rel:P.none(),target:P.none(),class:P.none()}),n.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:n,onAction:function(n){et(t),n.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:n,onAction:function(n){Vt(t)(),n.hide()}}]})};u.add("link",function(t){qt(t),$t(t),Xt(t),Yt(t),zt(t),Wt(t),Gt(t)})}(window)},cdd9:function(t,n){!function(t){"use strict";var n,e,r,o,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},a=function(t){return function(){return t}},c=function(t){return t},s=a(!1),l=a(!0),f=s,d=l,m=function(){return g},g=(o={fold:function(t,n){return t()},is:f,isSome:f,isNone:d,getOr:r=function(t){return t},getOrThunk:e=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:r,orThunk:e,map:m,ap:m,each:function(){},bind:m,flatten:m,exists:f,forall:d,filter:m,equals:n=function(t){return t.isNone()},equals_:n,toArray:function(){return[]},toString:a("none()")},Object.freeze&&Object.freeze(o),o),p=function(t){var n=function(){return t},e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:d,isNone:f,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return p(n(t))},ap:function(n){return n.fold(m,function(n){return p(n(t))})},each:function(n){n(t)},bind:r,flatten:n,exists:r,forall:r,filter:function(n){return n(t)?o:g},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(f,function(n){return e(t,n)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},h={some:p,none:m,from:function(t){return null==t?g:p(t)}},v=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(n)===t}},b=v("string"),y=v("object"),w=v("function"),x=v("number"),S=function(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e,t)},C=Array.prototype.push,O=function(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!Array.prototype.isPrototypeOf(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);C.apply(n,t[e])}return n},k=(Array.prototype.slice,w(Array.from)&&Array.from,function(){return(k=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)}),T=function(n){var e=h.none(),r=[],o=function(t){i()?a(t):r.push(t)},i=function(){return e.isSome()},u=function(t){S(t,a)},a=function(n){e.each(function(e){t.setTimeout(function(){n(e)},0)})};return n(function(t){e=h.some(t),u(r),r=[]}),{get:o,map:function(t){return T(function(n){o(function(e){n(t(e))})})},isReady:i}},E={nu:T,pure:function(t){return T(function(n){n(t)})}},D=function(n){var e=function(e){var r;n((r=e,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var o=this;t.setTimeout(function(){r.apply(o,n)},0)}))},r=function(){return E.nu(e)};return{map:function(t){return D(function(n){e(function(e){var r=t(e);n(r)})})},bind:function(t){return D(function(n){e(function(e){t(e).get(n)})})},anonBind:function(t){return D(function(n){e(function(e){t.get(n)})})},toLazy:r,toCached:function(){var t=null;return D(function(n){null===t&&(t=r()),t.get(n)})},get:e}},A={nu:D,pure:function(t){return D(function(n){n(t)})}},R=function(t){return{is:function(n){return t===n},isValue:l,isError:s,getOr:a(t),getOrThunk:a(t),getOrDie:a(t),or:function(n){return R(t)},orThunk:function(n){return R(t)},fold:function(n,e){return e(t)},map:function(n){return R(n(t))},mapError:function(n){return R(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return h.some(t)}}},B=function(t){return{is:s,isValue:s,isError:l,getOr:c,getOrThunk:function(t){return t()},getOrDie:function(){return(n=String(t),function(){throw new Error(n)})();var n},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return B(t)},mapError:function(n){return B(n(t))},each:u,bind:function(n){return B(t)},exists:s,forall:l,toOption:h.none}},N={value:R,error:B},_=function(n){return k({},n,{toCached:function(){return _(n.toCached())},bindFuture:function(t){return _(n.bind(function(n){return n.fold(function(t){return A.pure(N.error(t))},function(n){return t(n)})}))},bindResult:function(t){return _(n.map(function(n){return n.bind(t)}))},mapResult:function(t){return _(n.map(function(n){return n.map(t)}))},mapError:function(t){return _(n.map(function(n){return n.mapError(t)}))},foldResult:function(t,e){return n.map(function(n){return n.fold(t,e)})},withTimeout:function(e,r){return _(A.nu(function(o){var i=!1,u=t.setTimeout(function(){i=!0,o(N.error(r()))},e);n.get(function(n){i||(t.clearTimeout(u),o(n))})}))}})},I=function(t){return _(A.nu(t))},M=I,F=Object.prototype.hasOwnProperty,P=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<n.length;o++){var i=n[o];for(var u in i)F.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},L=P(function(t,n){return y(t)&&y(n)?L(t,n):n}),H=P(function(t,n){return n}),V=void 0!==t.window?t.window:Function("return this;")(),z=function(t,n){return function(t,n){for(var e=null!=n?n:V,r=0;r<t.length&&null!=e;++r)e=e[t[r]];return e}(t.split("."),n)},j={getOrDie:function(t,n){var e=function(t,n){return z(t,n)}(t,n);if(null==e)throw t+" not available on this browser";return e}},U=function(){return j.getOrDie("URL")},W=function(t){return U().createObjectURL(t)},G=function(t){U().revokeObjectURL(t)},q=function(t){var n=t.imageList.map(function(t){return{name:"images",type:"selectbox",label:"Image list",items:t}}),e=t.classList.map(function(t){return{name:"classes",type:"selectbox",label:"Class",items:t}});return O([[{name:"src",type:"urlinput",filetype:"image",label:"Source"}],n.toArray(),t.hasDescription?[{name:"alt",type:"input",label:"Image description"}]:[],t.hasImageTitle?[{name:"title",type:"input",label:"Image title"}]:[],t.hasDimensions?[{name:"dimensions",type:"sizeinput"}]:[],[{type:"grid",columns:2,items:O([e.toArray(),t.hasImageCaption?[{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[]])}]])},$=function(t){return{title:"General",items:q(t)}},X=q,Y=tinymce.util.Tools.resolve("tinymce.util.Promise"),K=tinymce.util.Tools.resolve("tinymce.util.Tools"),J=tinymce.util.Tools.resolve("tinymce.util.XHR"),Z=function(t){return!1!==t.settings.image_dimensions},Q=function(t){return!0===t.settings.image_advtab},tt=function(t){return t.getParam("image_prepend_url","")},nt=function(t){return t.getParam("image_class_list")},et=function(t){return!1!==t.settings.image_description},rt=function(t){return!0===t.settings.image_title},ot=function(t){return!0===t.settings.image_caption},it=function(t){return t.getParam("image_list",!1)},ut=function(t){return!!t.getParam("images_upload_url",!1)},at=function(t){return!!t.getParam("images_upload_handler",!1)},ct=function(t){return t.getParam("images_upload_url")},st=function(t){return t.getParam("images_upload_handler")},lt=function(t){return t.getParam("images_upload_base_path")},ft=function(t){return t.getParam("images_upload_credentials")},dt=function(t,n){return Math.max(parseInt(t,10),parseInt(n,10))},mt=function(n,e){var r=t.document.createElement("img");function o(t){r.parentNode&&r.parentNode.removeChild(r),e(t)}r.onload=function(){var t={width:dt(r.width,r.clientWidth),height:dt(r.height,r.clientHeight)};o(N.value(t))},r.onerror=function(){o(N.error(void 0))};var i=r.style;i.visibility="hidden",i.position="fixed",i.bottom=i.left="0px",i.width=i.height="auto",t.document.body.appendChild(r),r.src=n},gt=function(t){return t&&(t=t.replace(/px$/,"")),t},pt=function(t){return t.length>0&&/^[0-9]+$/.test(t)&&(t+="px"),t},ht=function(t){if(t.margin){var n=String(t.margin).split(" ");switch(n.length){case 1:t["margin-top"]=t["margin-top"]||n[0],t["margin-right"]=t["margin-right"]||n[0],t["margin-bottom"]=t["margin-bottom"]||n[0],t["margin-left"]=t["margin-left"]||n[0];break;case 2:t["margin-top"]=t["margin-top"]||n[0],t["margin-right"]=t["margin-right"]||n[1],t["margin-bottom"]=t["margin-bottom"]||n[0],t["margin-left"]=t["margin-left"]||n[1];break;case 3:t["margin-top"]=t["margin-top"]||n[0],t["margin-right"]=t["margin-right"]||n[1],t["margin-bottom"]=t["margin-bottom"]||n[2],t["margin-left"]=t["margin-left"]||n[1];break;case 4:t["margin-top"]=t["margin-top"]||n[0],t["margin-right"]=t["margin-right"]||n[1],t["margin-bottom"]=t["margin-bottom"]||n[2],t["margin-left"]=t["margin-left"]||n[3]}delete t.margin}return t},vt=function(t,n){var e=it(t);"string"==typeof e?J.send({url:e,success:function(t){n(JSON.parse(t))}}):"function"==typeof e?e(n):n(e)},bt=function(t,n,e){function r(){e.onload=e.onerror=null,t.selection&&(t.selection.select(e),t.nodeChanged())}e.onload=function(){n.width||n.height||!Z(t)||t.dom.setAttribs(e,{width:e.clientWidth,height:e.clientHeight}),r()},e.onerror=r},yt=function(t){return new Y(function(n,e){var r=new(j.getOrDie("FileReader"));r.onload=function(){n(r.result)},r.onerror=function(){e(r.error.message)},r.readAsDataURL(t)})},wt=function(t){return"IMG"===t.nodeName&&(t.hasAttribute("data-mce-object")||t.hasAttribute("data-mce-placeholder"))},xt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils").DOM,St=function(t){return t.style.marginLeft&&t.style.marginRight&&t.style.marginLeft===t.style.marginRight?gt(t.style.marginLeft):""},Ct=function(t){return t.style.marginTop&&t.style.marginBottom&&t.style.marginTop===t.style.marginBottom?gt(t.style.marginTop):""},Ot=function(t){return t.style.borderWidth?gt(t.style.borderWidth):""},kt=function(t,n){return t.hasAttribute(n)?t.getAttribute(n):""},Tt=function(t,n){return t.style[n]?t.style[n]:""},Et=function(t){return null!==t.parentNode&&"FIGURE"===t.parentNode.nodeName},Dt=function(t,n,e){t.setAttribute(n,e)},At=function(t){Et(t)?function(t){var n=t.parentNode;xt.insertAfter(t,n),xt.remove(n)}(t):function(t){var n=xt.create("figure",{class:"image"});xt.insertAfter(n,t),n.appendChild(t),n.appendChild(xt.create("figcaption",{contentEditable:"true"},"Caption")),n.contentEditable="false"}(t)},Rt=function(t,n){var e=t.getAttribute("style"),r=n(null!==e?e:"");r.length>0?(t.setAttribute("style",r),t.setAttribute("data-mce-style",r)):t.removeAttribute("style")},Bt=function(t,n){return function(t,e,r){t.style[e]?(t.style[e]=pt(r),Rt(t,n)):Dt(t,e,r)}},Nt=function(t,n){return t.style[n]?gt(t.style[n]):kt(t,n)},_t=function(t,n){var e=pt(n);t.style.marginLeft=e,t.style.marginRight=e},It=function(t,n){var e=pt(n);t.style.marginTop=e,t.style.marginBottom=e},Mt=function(t,n){var e=pt(n);t.style.borderWidth=e},Ft=function(t,n){t.style.borderStyle=n},Pt=function(t){return"FIGURE"===t.nodeName},Lt=function(n,e){var r=t.document.createElement("img");return Dt(r,"style",e.style),(St(r)||""!==e.hspace)&&_t(r,e.hspace),(Ct(r)||""!==e.vspace)&&It(r,e.vspace),(Ot(r)||""!==e.border)&&Mt(r,e.border),(function(t){return Tt(t,"borderStyle")}(r)||""!==e.borderStyle)&&Ft(r,e.borderStyle),n(r.getAttribute("style"))},Ht=function(t,n){return{src:kt(n,"src"),alt:kt(n,"alt"),title:kt(n,"title"),width:Nt(n,"width"),height:Nt(n,"height"),class:kt(n,"class"),style:t(kt(n,"style")),caption:Et(n),hspace:St(n),vspace:Ct(n),border:Ot(n),borderStyle:Tt(n,"borderStyle")}},Vt=function(t,n,e,r,o){e[r]!==n[r]&&o(t,r,e[r])},zt=function(t,n){return function(e,r,o){t(e,o),Rt(e,n)}},jt=function(t,n,e){var r=Ht(t,e);Vt(e,r,n,"caption",function(t,n,e){return At(t)}),Vt(e,r,n,"src",Dt),Vt(e,r,n,"alt",Dt),Vt(e,r,n,"title",Dt),Vt(e,r,n,"width",Bt(0,t)),Vt(e,r,n,"height",Bt(0,t)),Vt(e,r,n,"class",Dt),Vt(e,r,n,"style",zt(function(t,n){return Dt(t,"style",n)},t)),Vt(e,r,n,"hspace",zt(_t,t)),Vt(e,r,n,"vspace",zt(It,t)),Vt(e,r,n,"border",zt(Mt,t)),Vt(e,r,n,"borderStyle",zt(Ft,t))},Ut=function(t,n){var e=t.dom.styles.parse(n),r=ht(e),o=t.dom.styles.parse(t.dom.styles.serialize(r));return t.dom.styles.serialize(o)},Wt=function(t){var n=t.selection.getNode(),e=t.dom.getParent(n,"figure.image");return e?t.dom.select("img",e)[0]:n&&("IMG"!==n.nodeName||wt(n))?null:n},Gt=function(t,n){var e=t.dom,r=e.getParent(n.parentNode,function(n){return t.schema.getTextBlockElements()[n.nodeName]},t.getBody());return r?e.split(r,n):n},qt=function(n,e){var r=function(n,e){var r=t.document.createElement("img");if(jt(n,H(e,{caption:!1}),r),Dt(r,"alt",e.alt),e.caption){var o=xt.create("figure",{class:"image"});return o.appendChild(r),o.appendChild(xt.create("figcaption",{contentEditable:"true"},"Caption")),o.contentEditable="false",o}return r}(function(t){return Ut(n,t)},e);n.dom.setAttrib(r,"data-mce-id","__mcenew"),n.focus(),n.selection.setContent(r.outerHTML);var o=n.dom.select('*[data-mce-id="__mcenew"]')[0];if(n.dom.setAttrib(o,"data-mce-id",null),Pt(o)){var i=Gt(n,o);n.selection.select(i)}else n.selection.select(o)},$t=function(t,n){var e=Wt(t);e?n.src?function(t,n){var e=Wt(t);if(jt(function(n){return Ut(t,n)},n,e),function(t,n){t.dom.setAttrib(n,"src",n.getAttribute("src"))}(t,e),Pt(e.parentNode)){var r=e.parentNode;Gt(t,r),t.selection.select(e.parentNode)}else t.selection.select(e),bt(t,n,e)}(t,n):function(t,n){if(n){var e=t.dom.is(n.parentNode,"figure.image")?n.parentNode:n;t.dom.remove(e),t.focus(),t.nodeChanged(),t.dom.isEmpty(t.getBody())&&(t.setContent(""),t.selection.setCursorLocation())}}(t,e):n.src&&qt(t,n)},Xt=function(t){return b(t.value)?t.value:""},Yt=function(t,n){var e=[];return K.each(t,function(t){var r=b(t.text)?t.text:b(t.title)?t.title:"";if(void 0!==t.menu){var o=Yt(t.menu,n);e.push({text:r,items:o})}else{var i=n(t);e.push({text:r,value:i})}}),e},Kt=function(t){return void 0===t&&(t=Xt),function(n){return n?h.from(n).map(function(n){return Yt(n,t)}):h.none()}},Jt=function(t,n){return function(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return h.none()}(t,function(t){return function(t){return Object.prototype.hasOwnProperty.call(t,"items")}(t)?Jt(t.items,n):t.value===n?h.some(t):h.none()})},Zt=Kt,Qt=function(t){return Kt(Xt)(t)},tn=function(t,n){return t.bind(function(t){return Jt(t,n)})},nn=function(){},en=function(t,n){return t?t.replace(/\/$/,"")+"/"+n.replace(/^\//,""):n};function rn(n){var e=function(e,r,o,i){var u,a;(u=new(j.getOrDie("XMLHttpRequest"))).open("POST",n.url),u.withCredentials=n.credentials,u.upload.onprogress=function(t){i(t.loaded/t.total*100)},u.onerror=function(){o("Image upload failed due to a XHR Transport error. Code: "+u.status)},u.onload=function(){var t;u.status<200||u.status>=300?o("HTTP Error: "+u.status):(t=JSON.parse(u.responseText))&&"string"==typeof t.location?r(en(n.basePath,t.location)):o("Invalid JSON: "+u.responseText)},(a=new t.FormData).append("file",e.blob(),e.filename()),u.send(a)};return n=K.extend({credentials:!1,handler:e},n),{upload:function(t){return n.url||n.handler!==e?function(t,n){return new Y(function(e,r){try{n(t,e,r,nn)}catch(t){r(t.message)}})}(t,n.handler):Y.reject("Upload url missing from the settings.")}}}var on,un,an,cn=function(t){return{title:"Advanced",items:[{type:"input",label:"Style",name:"style"},{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace"},{type:"input",label:"Horizontal space",name:"hspace"},{type:"input",label:"Border width",name:"border"},{type:"selectbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},sn=function(t){var n=Zt(function(n){return t.convertURL(n.value||n.url,"src")}),e=A.nu(function(e){vt(t,function(t){e(n(t).map(function(t){return O([[{text:"None",value:""}],t])}))})}),r=Qt(nt(t)),o=Q(t),i=ut(t),u=at(t),a=function(t){var n=Wt(t);return n?Ht(function(n){return Ut(t,n)},n):{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:""}}(t),c=et(t),s=rt(t),l=Z(t),f=ot(t),d=ct(t),m=lt(t),g=ft(t),p=st(t),v=h.some(tt(t)).filter(function(t){return b(t)&&t.length>0});return e.map(function(t){return{image:a,imageList:t,classList:r,hasAdvTab:o,hasUploadUrl:i,hasUploadHandler:u,hasDescription:c,hasImageTitle:s,hasDimensions:l,hasImageCaption:f,url:d,basePath:m,credentials:g,handler:p,prependURL:v}})},ln=function(t){return{title:"Upload",items:[{type:"dropzone",name:"fileinput"}]}},fn=function(t){return{src:{value:t.src,meta:{}},images:t.src,alt:t.alt,title:t.title,dimensions:{width:t.width,height:t.height},classes:t.class,caption:t.caption,style:t.style,vspace:t.vspace,border:t.border,hspace:t.hspace,borderstyle:t.borderStyle,fileinput:[]}},dn=function(t){return{src:t.src.value,alt:t.alt,title:t.title,width:t.dimensions.width,height:t.dimensions.height,class:t.classes,style:t.style,caption:t.caption,hspace:t.hspace,vspace:t.vspace,border:t.border,borderStyle:t.borderstyle}},mn=function(t,n){var e=n.getData();(function(t,n){return/^(?:[a-zA-Z]+:)?\/\//.test(n)?h.none():t.prependURL.bind(function(t){return n.substring(0,t.length)!==t?h.some(t+n):h.none()})})(t,e.src.value).each(function(t){n.setData({src:{value:t,meta:e.src.meta}})})},gn=function(t,n){(function(t,n){var e=n.src.meta;if(void 0!==e){var r=L({},n);return t.hasDescription&&b(e.alt)&&(r.alt=e.alt),t.hasImageTitle&&b(e.title)&&(r.title=e.title),t.hasDimensions&&(b(e.width)&&(r.dimensions.width=e.width),b(e.height)&&(r.dimensions.height=e.height)),b(e.class)&&tn(t.classList,e.class).each(function(t){r.classes=t.value}),t.hasAdvTab&&(b(e.vspace)&&(r.vspace=e.vspace),b(e.border)&&(r.border=e.border),b(e.hspace)&&(r.hspace=e.hspace),b(e.borderstyle)&&(r.borderstyle=e.borderstyle)),h.some(r)}return h.none()})(t,n.getData()).each(function(t){return n.setData(t)})},pn=function(t,n,e,r){mn(n,r),gn(n,r),function(t,n,e,r){var o=r.getData(),i=o.src.value,u=o.src.meta||{};u.width||u.height||!n.hasDimensions||t.imageSize(i).get(function(t){t.each(function(t){e.open&&r.setData({dimensions:t})})})}(t,n,e,r),function(t,n,e){var r=e.getData(),o=tn(t.imageList,r.src.value);n.prevImage=o,e.setData({images:o.map(function(t){return t.value}).getOr("")})}(n,e,r)},hn=function(t,n,e){var r=ht(t(e.style)),o=L({},e);return o.vspace=function(t){return t["margin-top"]&&t["margin-bottom"]&&t["margin-top"]===t["margin-bottom"]?gt(String(t["margin-top"])):""}(r),o.hspace=function(t){return t["margin-right"]&&t["margin-left"]&&t["margin-right"]===t["margin-left"]?gt(String(t["margin-right"])):""}(r),o.border=function(t){return t["border-width"]?gt(String(t["border-width"])):""}(r),o.borderstyle=function(t){return t["border-style"]?String(t["border-style"]):""}(r),o.style=function(t,n,e){return n(t(n(e)))}(t,n,r),o},vn=function(t,n,e,r){var o,i=r.getData();r.block("Uploading image"),(o=i.fileinput,0===o.length?h.none():h.some(o[0])).fold(function(){r.unblock()},function(o){var i=W(o),u=rn({url:n.url,basePath:n.basePath,credentials:n.credentials,handler:n.handler}),a=function(){r.unblock(),G(i)};yt(o).then(function(c){var s=t.createBlobCache(o,i,c);u.upload(s).then(function(o){r.setData({src:{value:o,meta:{}}}),r.showTab("General"),pn(t,n,e,r),a()}).catch(function(n){a(),t.alertErr(r,n)})})})},bn=function(t,n,e){return function(r,o){"src"===o.name?pn(t,n,e,r):"images"===o.name?function(t,n,e,r){var o=r.getData(),i=tn(n.imageList,o.images);i.each(function(t){""===o.alt||e.prevImage.map(function(t){return t.text===o.alt}).getOr(!1)?""===t.value?r.setData({src:t,alt:e.prevAlt}):r.setData({src:t,alt:t.text}):r.setData({src:t})}),e.prevImage=i,pn(t,n,e,r)}(t,n,e,r):"alt"===o.name?e.prevAlt=r.getData().alt:"style"===o.name?function(t,n){var e=n.getData(),r=hn(t.parseStyle,t.serializeStyle,e);n.setData(r)}(t,r):"vspace"===o.name||"hspace"===o.name||"border"===o.name||"borderstyle"===o.name?function(t,n,e){var r=L(fn(n.image),e.getData()),o=Lt(t.normalizeCss,dn(r));e.setData({style:o})}(t,n,r):"fileinput"===o.name&&vn(t,n,e,r)}},yn=function(t){return function(){t.open=!1}},wn=function(t){return t.hasAdvTab||t.hasUploadUrl||t.hasUploadHandler?{type:"tabpanel",tabs:O([[$(t)],t.hasAdvTab?[cn(t)]:[],t.hasUploadUrl||t.hasUploadHandler?[ln(t)]:[]])}:{type:"panel",items:X(t)}},xn=function(t){return function(n){var e=function(t){return{prevImage:tn(t.imageList,t.image.src),prevAlt:t.image.alt,open:!0}}(n);return{title:"Insert/Edit Image",size:"normal",body:wn(n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:fn(n.image),onSubmit:t.onSubmit(n),onChange:bn(t,n,e),onClose:yn(e)}}},Sn=function(t){return function(n){return function(e){var r=L(fn(n.image),e.getData());t.undoManager.transact(function(){$t(t,dn(r))}),t.editorUpload.uploadImagesAuto(),e.close()}}},Cn=function(t){return function(n){return M(function(e){mt(t.documentBaseURI.toAbsolute(n),function(t){var n=t.bind(function(t){return(b(t.width)||x(t.width))&&(b(t.height)||x(t.height))?N.value({width:String(t.width),height:String(t.height)}):N.error(void 0)});e(n)})})}},On=function(t){return function(n,e,r){return t.editorUpload.blobCache.create({blob:n,blobUri:e,name:n.name?n.name.replace(/\.[^\.]+$/,""):null,base64:r.split(",")[1]})}},kn=function(t){return function(n,e){t.windowManager.alert(e,n.close)}},Tn=function(t){return function(n){return Ut(t,n)}},En=function(t){return function(n){return t.dom.parseStyle(n)}},Dn=function(t){return function(n,e){return t.dom.serializeStyle(n,e)}},An=function(t){var n={onSubmit:Sn(t),imageSize:Cn(t),createBlobCache:On(t),alertErr:kn(t),normalizeCss:Tn(t),parseStyle:En(t),serializeStyle:Dn(t)};return{open:function(){return sn(t).map(xn(n)).get(function(n){t.windowManager.open(n)})}}},Rn=function(t){t.addCommand("mceImage",An(t).open)},Bn=function(t){var n=t.attr("class");return n&&/\bimage\b/.test(n)},Nn=function(t){return function(n){for(var e,r=n.length,o=function(n){n.attr("contenteditable",t?"true":null)};r--;)e=n[r],Bn(e)&&(e.attr("contenteditable",t?"false":null),K.each(e.getAll("figcaption"),o))}},_n=function(t){t.on("PreInit",function(){t.parser.addNodeFilter("figure",Nn(!0)),t.serializer.addNodeFilter("figure",Nn(!1))})},In=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:a(t)}},Mn={fromHtml:function(n,e){var r=(e||t.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return In(r.childNodes[0])},fromTag:function(n,e){var r=(e||t.document).createElement(n);return In(r)},fromText:function(n,e){var r=(e||t.document).createTextNode(n);return In(r)},fromDom:In,fromPoint:function(t,n,e){var r=t.dom();return h.from(r.elementFromPoint(n,e)).map(In)}},Fn=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE,t.Node.DOCUMENT_NODE,t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE,t.Node.TEXT_NODE,t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,function(){return Pn(0,0)}),Pn=function(t,n){return{major:t,minor:n}},Ln={nu:Pn,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?Fn():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}}(t,n);if(!e)return{major:0,minor:0};var r=function(t){return Number(n.replace(e,"$"+t))};return Pn(r(1),r(2))}(t,e)},unknown:Fn},Hn=function(t,n){return function(){return n===t}},Vn=function(t){var n=t.current;return{current:n,version:t.version,isEdge:Hn("Edge",n),isChrome:Hn("Chrome",n),isIE:Hn("IE",n),isOpera:Hn("Opera",n),isFirefox:Hn("Firefox",n),isSafari:Hn("Safari",n)}},zn={unknown:function(){return Vn({current:void 0,version:Ln.unknown()})},nu:Vn,edge:a("Edge"),chrome:a("Chrome"),ie:a("IE"),opera:a("Opera"),firefox:a("Firefox"),safari:a("Safari")},jn=function(t,n){return function(){return n===t}},Un=function(t){var n=t.current;return{current:n,version:t.version,isWindows:jn("Windows",n),isiOS:jn("iOS",n),isAndroid:jn("Android",n),isOSX:jn("OSX",n),isLinux:jn("Linux",n),isSolaris:jn("Solaris",n),isFreeBSD:jn("FreeBSD",n)}},Wn={unknown:function(){return Un({current:void 0,version:Ln.unknown()})},nu:Un,windows:a("Windows"),ios:a("iOS"),android:a("Android"),linux:a("Linux"),osx:a("OSX"),solaris:a("Solaris"),freebsd:a("FreeBSD")},Gn=function(t,n){var e=String(n).toLowerCase();return function(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e,t))return h.some(o)}return h.none()}(t,function(t){return t.search(e)})},qn=function(t,n){return Gn(t,n).map(function(t){var e=Ln.detect(t.versionRegexes,n);return{current:t.name,version:e}})},$n=function(t,n){return Gn(t,n).map(function(t){var e=Ln.detect(t.versionRegexes,n);return{current:t.name,version:e}})},Xn=function(t,n){return-1!==t.indexOf(n)},Yn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Kn=function(t){return function(n){return Xn(n,t)}},Jn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Xn(t,"edge/")&&Xn(t,"chrome")&&Xn(t,"safari")&&Xn(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Yn],search:function(t){return Xn(t,"chrome")&&!Xn(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Xn(t,"msie")||Xn(t,"trident")}},{name:"Opera",versionRegexes:[Yn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Kn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Kn("firefox")},{name:"Safari",versionRegexes:[Yn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Xn(t,"safari")||Xn(t,"mobile/"))&&Xn(t,"applewebkit")}}],Zn=[{name:"Windows",search:Kn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Xn(t,"iphone")||Xn(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Kn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Kn("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Kn("linux"),versionRegexes:[]},{name:"Solaris",search:Kn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Kn("freebsd"),versionRegexes:[]}],Qn={browsers:a(Jn),oses:a(Zn)},te=function(t){var n=Qn.browsers(),e=Qn.oses(),r=qn(n,t).fold(zn.unknown,zn.nu),o=$n(e,t).fold(Wn.unknown,Wn.nu),i=function(t,n,e){var r=t.isiOS()&&!0===/ipad/i.test(e),o=t.isiOS()&&!r,i=t.isAndroid()&&3===t.version.major,u=t.isAndroid()&&4===t.version.major,c=r||i||u&&!0===/mobile/i.test(e),s=t.isiOS()||t.isAndroid(),l=s&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e);return{isiPad:a(r),isiPhone:a(o),isTablet:a(c),isPhone:a(l),isTouch:a(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:a(f)}}(o,r,t);return{browser:r,os:o,deviceType:i}},ne=((on=function(){var n=t.navigator.userAgent;return te(n)},an=!1,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return an||(an=!0,un=on.apply(null,t)),un})().browser.isIE(),function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]}("element","offset"),function(n){var e=function(e){return{text:"Image",icon:"image",onAction:function(){var r=((on=function(){var n=t.navigator.userAgent;return te(n)},an=!1,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return an||(an=!0,un=on.apply(null,t)),un})().browser.isIE(),function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]}("element","offset"),function(t){return(n=t,e=n.dom(),h.from(e.parentNode).map(Mn.fromDom)).filter(function(t){return"figure"===function(t){return t.dom().nodeName.toLowerCase()}(t)}).getOr(t);var n,e})(Mn.fromDom(e));n.selection.select(r.dom()),An(n).open()}}};n.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:An(n).open,onSetup:function(t){return n.selection.selectorChangedWithUnbind("img:not([data-mce-object],[data-mce-placeholder]),figure.image",t.setActive).unbind}}),n.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:An(n).open}),n.ui.registry.addContextMenu("image",{update:function(t){return Pt(t)||"IMG"===t.nodeName&&!wt(t)?[e(t)]:[]}})});i.add("image",function(t){_n(t),ne(t),Rn(t)})}(window)},e8b0:function(t,n){!function(){"use strict";var t,n,e,r,o,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(){return(u=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},a="[-'\\.‘’․﹒＇．]",c="[:··״‧︓﹕：]",s="[±+*/,;;։،؍٬߸⁄︐︔﹐﹔，；]",l="[0-9٠-٩٫۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꩐-꩙꯰-꯹]",f="\\r",d="\\n",m="[\v\f\u2028\u2029]",g="[̀-ͯ҃-҉֑-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ऀ-ःऺ-़ा-ॏ॑-ॗॢॣঁ-ঃ়া-ৄেৈো-্ৗৢৣਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑੰੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣஂா-ூெ-ைொ-்ௗఁ-ఃా-ౄె-ైొ-్ౕౖౢౣಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣംഃാ-ൄെ-ൈൊ-്ൗൢൣංඃ්ා-ුූෘ-ෟෲෳัิ-ฺ็-๎ັິ-ູົຼ່-ໍ༹༘༙༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳា-៓៝᠋-᠍ᢩᤠ-ᤫᤰ-᤻ᦰ-ᧀᧈᧉᨗ-ᨛᩕ-ᩞ᩠-᩿᩼ᬀ-ᬄ᬴-᭄᭫-᭳ᮀ-ᮂᮡ-᯦᮪-᯳ᰤ-᰷᳐-᳔᳒-᳨᳭ᳲ᷀-ᷦ᷼-᷿‌‍⃐-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꙯-꙲꙼꙽꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-꣄꣠-꣱ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀ꨩ-ꨶꩃꩌꩍꩻꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꯣ-ꯪ꯬꯭ﬞ︀-️︠-︦ﾞﾟ]",p="[­؀-؃۝܏឴឵‎‏‪-‮⁠-⁤⁪-⁯\ufeff￹-￻]",h="[〱-〵゛゜゠-ヺー-ヿㇰ-ㇿ㋐-㋾㌀-㍗ｦ-ﾝ]",v="[=_‿⁀⁔︳︴﹍-﹏＿∀-⋿<>]",b="[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]",y=0,w=1,x=2,S=3,C=4,O=5,k=6,T=7,E=8,D=9,A=10,R=11,B=12,N=13,_=[new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-׳ؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆༀཀ-ཇཉ-ཬྈ-ྌႠ-Ⴥა-ჺჼᄀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᨀ-ᨖᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᯀ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⒶ-ⓩⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⴀ-ⴥⴰ-ⵥⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〻〼ㄅ-ㄭㄱ-ㆎㆠ-ㆺꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐꞑꞠ-ꞩꟺ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),new RegExp(a),new RegExp(c),new RegExp(s),new RegExp(l),new RegExp(f),new RegExp(d),new RegExp(m),new RegExp(g),new RegExp(p),new RegExp(h),new RegExp(v),new RegExp("@")],I=new RegExp("^"+b+"$"),M=function(t){return function(){return t}},F=function(t){return t},P=M(!1),L=M(!0),H=function(){return V},V=(r={fold:function(t,n){return t()},is:P,isSome:P,isNone:L,getOr:e=function(t){return t},getOrThunk:n=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:e,orThunk:n,map:H,ap:H,each:function(){},bind:H,flatten:H,exists:P,forall:L,filter:H,equals:t=function(t){return t.isNone()},equals_:t,toArray:function(){return[]},toString:M("none()")},Object.freeze&&Object.freeze(r),r),z=(o="function",function(t){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(t)===o}),j=(Array.prototype.slice,z(Array.from)&&Array.from,_),U=N,W=function(t){for(var n=U,e=j.length,r=0;r<e;++r){var o=j[r];if(o&&o.test(t)){n=r;break}}return n},G=function(t){var n,e;return function(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o,t)}return r}(t,(n=W,e={},function(t){if(e[t])return e[t];var r=n(t);return e[t]=r,r}))},q=function(t,n){var e,r,o=t[n],i=t[n+1];return!(n<0||n>t.length-1&&0!==n||o===y&&i===y||(r=t[n+2],o===y&&(i===x||i===w||i===B)&&r===y||(e=t[n-1],(o===x||o===w||i===B)&&i===y&&e===y||!(o!==C&&o!==y||i!==C&&i!==y)||(o===S||o===w)&&i===C&&e===C||o===C&&(i===S||i===w)&&r===C||o===E||o===D||e===E||e===D||i===E||i===D||o===O&&i===k||o!==T&&o!==O&&o!==k&&i!==T&&i!==O&&i!==k&&(o===A&&i===A||i===R&&(o===y||o===C||o===A||o===R)||o===R&&(i===y||i===C||i===A)||o===B))))},$=/^\s+$/,X=I,Y=function(t){return"http"===t||"https"===t},K=function(t,n){var e=function(t,n){var e;for(e=n;e<t.length&&!$.test(t[e]);e++);return e}(t,n+1);return"://"===t.slice(n+1,e).join("").substr(0,3)?e:n},J=function(t,n,e){e=u({},{includeWhitespace:!1,includePunctuation:!1},e);for(var r=[],o=[],i=0;i<t.length;i++){var a=n(t[i]);"\ufeff"!==a&&(r.push(t[i]),o.push(a))}return function(t,n,e,r){for(var o=[],i=[],u=0;u<e.length;++u)if(i.push(t[u]),q(e,u)){var a=n[u];if((r.includeWhitespace||!$.test(a))&&(r.includePunctuation||!X.test(a))){var c=u-i.length+1,s=u+1,l=n.slice(c,s).join("");if(Y(l)){var f=K(n,u),d=t.slice(s,f);Array.prototype.push.apply(i,d),u=f}o.push(i)}i=[]}return o}(r,o,G(o),e)},Z=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Q=function(t,n){for(var e=n.getBlockElements(),r=n.getShortEndedElements(),o=n.getWhiteSpaceElements(),i=function(t){return e[t.nodeName]||r[t.nodeName]||o[t.nodeName]},u="",a=new Z(t,t);t=a.next();)3===t.nodeType?u+=t.data:0!==u.length&&i(t)&&(u+=" ");return u},tt=function(t){return{words:J(t.split(""),F).length,characters:t.length,charactersNoSpace:t.replace(/\s/g,"").length}},nt=function(t){return tt(function(t){return t.removed?"":Q(t.getBody(),t.schema)}(t))},et=tinymce.util.Tools.resolve("tinymce.util.Delay"),rt=function(t){!function(t,n){t.fire("wordCountUpdate",{wordCount:n})}(t,nt(t))},ot=function(t){var n=nt(t),e=function(t){var n=Q(t.selection.getRng().cloneContents(),t.schema);return t.selection.isCollapsed()?tt(""):tt(n)}(t);t.windowManager.open({title:"Word Count",body:{type:"panel",items:[{type:"table",header:["Count","Document","Selection"],cells:[["Words",String(n.words),String(e.words)],["Characters (no spaces)",String(n.charactersNoSpace),String(e.charactersNoSpace)],["Characters",String(n.characters),String(e.characters)]]}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}]})};i.add("wordcount",function(t){return function(t){t.ui.registry.addButton("wordcount",{tooltip:"Word count",icon:"character-count",onAction:function(){return ot(t)}}),t.ui.registry.addMenuItem("wordcount",{text:"Word count",icon:"character-count",onAction:function(){return ot(t)}})}(t),function(t){var n=et.debounce(function(){return rt(t)},300);t.on("init",function(){rt(t),et.setEditorTimeout(t,function(){t.on("SetContent BeforeAddUndo Undo Redo keyup",n)},0)})}(t),function(t){return{getCount:function(){return nt(t).words}}}(t)})}()},ef1f:function(t,n){!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(t,n){t.focus(),t.undoManager.transact(function(){t.setContent(n)}),t.selection.setCursorLocation(),t.nodeChanged()},e=function(t){return t.getContent({source_view:!0})},r=function(t){var r=e(t);t.windowManager.open({title:"Source Code",size:"large",body:{type:"panel",items:[{type:"textarea",name:"code"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{code:r},onSubmit:function(e){n(t,e.getData().code),e.close()}})},o=function(t){t.addCommand("mceCodeEditor",function(){r(t)})},i=function(t){t.ui.registry.addButton("code",{icon:"sourcecode",tooltip:"Source code",onAction:function(){return r(t)}}),t.ui.registry.addMenuItem("code",{icon:"sourcecode",text:"Source code",onAction:function(){return r(t)}})};t.add("code",function(t){return o(t),i(t),{}})}()},f557:function(t,n,e){e("5e4c")}}]);